
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="spotPython - Sequential Parameter Optimization Toolbox in Python">
      
      
      
        <link rel="canonical" href="https://github.com/sequential-parameter-optimization/spotPython/reference/spotPython/build/kriging/">
      
      
        <link rel="prev" href="../../budget/ocba/">
      
      
        <link rel="next" href="../surrogates/">
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>kriging - spotPython</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotPython.build.kriging" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotPython" class="md-header__button md-logo" aria-label="spotPython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotPython
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              kriging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotPython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../budget/ocba/" class="md-tabs__link">
          
  
    
  
  Code Reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-tabs__link">
        
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../download/" class="md-tabs__link">
        
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../examples/" class="md-tabs__link">
        
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotPython" class="md-nav__button md-logo" aria-label="spotPython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotPython
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotPython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    spotPython
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            spotPython
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    budget
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            budget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../budget/ocba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ocba
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    build
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    kriging
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    kriging
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotPython.build.kriging" class="md-nav__link">
    <span class="md-ellipsis">
      kriging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging" class="md-nav__link">
    <span class="md-ellipsis">
      Kriging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kriging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.__is_any__" class="md-nav__link">
    <span class="md-ellipsis">
      __is_any__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_Psi" class="md-nav__link">
    <span class="md-ellipsis">
      build_Psi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_U" class="md-nav__link">
    <span class="md-ellipsis">
      build_U
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_psi_vec" class="md-nav__link">
    <span class="md-ellipsis">
      build_psi_vec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.exp_imp" class="md-nav__link">
    <span class="md-ellipsis">
      exp_imp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.extract_from_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      extract_from_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.fun_likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      fun_likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.initialize_matrices" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.initialize_variables" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.optimize_model" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.predict_coded" class="md-nav__link">
    <span class="md-ellipsis">
      predict_coded
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_de_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      set_de_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_theta_values" class="md-nav__link">
    <span class="md-ellipsis">
      set_theta_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_variable_types" class="md-nav__link">
    <span class="md-ellipsis">
      set_variable_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.update_log" class="md-nav__link">
    <span class="md-ellipsis">
      update_log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.weighted_exp_imp" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_exp_imp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surrogates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    surrogates
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    data
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/csvdataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    csvdataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/diabetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    diabetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightcrossvalidationdatamodule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lightcrossvalidationdatamodule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightdatamodule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lightdatamodule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/mnistdatamodule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mnistdatamodule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/pkldataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkldataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/pkldataset_intern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkldataset_intern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/torchdata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchdata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/vbdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vbdp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/designs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    designs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/factorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    factorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/spacefilling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spacefilling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    fun
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            fun
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperlight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperlight
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypersklearn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hypersklearn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypertorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hypertorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/objectivefunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    objectivefunctions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    hyperdict
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            hyperdict
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/light_hyper_dict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    light_hyper_dict
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/sklearn_hyper_dict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sklearn_hyper_dict
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/torch_hyper_dict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch_hyper_dict
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    hyperparameters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            hyperparameters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/categorical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    categorical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    values
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    light
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            light
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8_1" id="__nav_2_1_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cifar10
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8_1">
            <span class="md-nav__icon md-icon"></span>
            cifar10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cifar10/cifar10datamodule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cifar10datamodule
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8_2" id="__nav_2_1_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    classification
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8_2">
            <span class="md-nav__icon md-icon"></span>
            classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/classification/netlightbasemapk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netlightbasemapk
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8_3" id="__nav_2_1_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cnn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8_3">
            <span class="md-nav__icon md-icon"></span>
            cnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/googlenet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    googlenet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/inceptionblock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inceptionblock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/netcnnbase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netcnnbase
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cvmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cvmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/litmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    litmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/loadmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    loadmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/predictmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    predictmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8_8" id="__nav_2_1_8_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    regression
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            regression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/netlightregression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netlightregression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/rnnlightregression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rnnlightregression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/transformerlightregression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transformerlightregression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/testmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/trainmodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    trainmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8_11" id="__nav_2_1_8_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_8_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8_11">
            <span class="md-nav__icon md-icon"></span>
            transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoderblock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encoderblock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/multiheadattention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiheadattention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positionalEncoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncodingBasic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positionalEncodingBasic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/skiplinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skiplinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/transformerlightpredictor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transformerlightpredictor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9" id="__nav_2_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    plot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/contour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contour
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/xai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xai
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_10" id="__nav_2_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    sklearn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_10">
            <span class="md-nav__icon md-icon"></span>
            sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/traintest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traintest
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11" id="__nav_2_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    spot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11">
            <span class="md-nav__icon md-icon"></span>
            spot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spot/spot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_12" >
        
          
          <label class="md-nav__link" for="__nav_2_1_12" id="__nav_2_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    torch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_12">
            <span class="md-nav__icon md-icon"></span>
            torch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/activation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    activation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/cosinewarmupcheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cosinewarmupcheduler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/dataframedataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataframedataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/initialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    initialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/mapk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mapk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcifar10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netcifar10
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netcore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netfashionMNIST/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netfashionMNIST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netregression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netregression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netvbdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netvbdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/traintest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traintest
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" >
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/aggregate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aggregate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    classes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/compare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    compare
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/convert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    convert
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/device/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    device
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/eda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/init/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    init
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/progress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    progress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/repair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/tensorboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tensorboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transform
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotPython.build.kriging" class="md-nav__link">
    <span class="md-ellipsis">
      kriging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging" class="md-nav__link">
    <span class="md-ellipsis">
      Kriging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kriging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.__is_any__" class="md-nav__link">
    <span class="md-ellipsis">
      __is_any__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_Psi" class="md-nav__link">
    <span class="md-ellipsis">
      build_Psi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_U" class="md-nav__link">
    <span class="md-ellipsis">
      build_U
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.build_psi_vec" class="md-nav__link">
    <span class="md-ellipsis">
      build_psi_vec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.exp_imp" class="md-nav__link">
    <span class="md-ellipsis">
      exp_imp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.extract_from_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      extract_from_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.fun_likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      fun_likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.initialize_matrices" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.initialize_variables" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.optimize_model" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.predict_coded" class="md-nav__link">
    <span class="md-ellipsis">
      predict_coded
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_de_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      set_de_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_theta_values" class="md-nav__link">
    <span class="md-ellipsis">
      set_theta_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.set_variable_types" class="md-nav__link">
    <span class="md-ellipsis">
      set_variable_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.update_log" class="md-nav__link">
    <span class="md-ellipsis">
      update_log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotPython.build.kriging.Kriging.weighted_exp_imp" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_exp_imp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>kriging</h1>

<div class="doc doc-object doc-module">



<a id="spotPython.build.kriging"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="spotPython.build.kriging.Kriging" class="doc doc-heading">
          <code>Kriging</code>


<a href="#spotPython.build.kriging.Kriging" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="spotPython.build.surrogates.surrogates" href="../surrogates/#spotPython.build.surrogates.surrogates">surrogates</a></code></p>

  
      <p>Kriging surrogate.</p>

            <details class="quote">
              <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Kriging</span><span class="p">(</span><span class="n">surrogates</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Kriging surrogate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
            <span class="n">noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">var_type</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;kriging&quot;</span><span class="p">,</span>
            <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">124</span><span class="p">,</span>
            <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">model_fun_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">min_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span>
            <span class="n">max_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">n_theta</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">theta_init_zero</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">p_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">n_p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">optim_p</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">min_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span>
            <span class="n">max_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
            <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Kriging surrogate.</span>

<span class="sd">        Args:</span>
<span class="sd">            noise (bool): Use regression instead of interpolation kriging. Defaults to False.</span>
<span class="sd">            var_type (List[str]):</span>
<span class="sd">                Variable type. Can be either &quot;num&quot; (numerical) or &quot;factor&quot; (factor).</span>
<span class="sd">                Defaults to [&quot;num&quot;].</span>
<span class="sd">            name (str):</span>
<span class="sd">                Surrogate name. Defaults to &quot;kriging&quot;.</span>
<span class="sd">            seed (int):</span>
<span class="sd">                Random seed. Defaults to 124.</span>
<span class="sd">            model_optimizer (Optional[object]):</span>
<span class="sd">                Optimizer on the surrogate. If None, differential_evolution is selected.</span>
<span class="sd">            model_fun_evals (Optional[int]):</span>
<span class="sd">                Number of iterations used by the optimizer on the surrogate.</span>
<span class="sd">            min_theta (float):</span>
<span class="sd">                Min log10 theta value. Defaults to -3.</span>
<span class="sd">            max_theta (float):</span>
<span class="sd">                Max log10 theta value. Defaults to 2.</span>
<span class="sd">            n_theta (int):</span>
<span class="sd">                Number of theta values. Defaults to 1.</span>
<span class="sd">            theta_init_zero (bool):</span>
<span class="sd">                Initialize theta with zero. Defaults to True.</span>
<span class="sd">            p_val (float):</span>
<span class="sd">                p value. Used as an initial value if optim_p = True. Otherwise as a constant. Defaults to 2.</span>
<span class="sd">            n_p (int):</span>
<span class="sd">                Number of p values. Defaults to 1.</span>
<span class="sd">            optim_p (bool):</span>
<span class="sd">                Determines whether p should be optimized. Deafults to False.</span>
<span class="sd">            min_Lambda (float):</span>
<span class="sd">                Min Lambda value. Defaults to 1e-9.</span>
<span class="sd">            max_Lambda (float):</span>
<span class="sd">                Max Lambda value. Defaults to 1.</span>
<span class="sd">            log_level (int):</span>
<span class="sd">                Logging level, e.g., 20 is &quot;INFO&quot;. Defaults to 50 (&quot;CRITICAL&quot;).</span>
<span class="sd">            spot_writer (Optional[object]):</span>
<span class="sd">                Spot writer. Defaults to None.</span>
<span class="sd">            counter (Optional[int]):</span>
<span class="sd">                Counter. Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                import matplotlib.pyplot as plt</span>
<span class="sd">                from numpy import linspace, arange</span>
<span class="sd">                rng = np.random.RandomState(1)</span>
<span class="sd">                X = linspace(start=0, stop=10, num=1_000).reshape(-1, 1)</span>
<span class="sd">                y = np.squeeze(X * np.sin(X))</span>
<span class="sd">                training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="sd">                X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">                S.fit(X_train, y_train)</span>
<span class="sd">                mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="sd">                plt.plot(X, y, label=r&quot;$f(x)$&quot;, linestyle=&quot;dotted&quot;)</span>
<span class="sd">                plt.scatter(X_train, y_train, label=&quot;Observations&quot;)</span>
<span class="sd">                plt.plot(X, mean_prediction, label=&quot;Mean prediction&quot;)</span>
<span class="sd">                plt.fill_between(</span>
<span class="sd">                    X.ravel(),</span>
<span class="sd">                    mean_prediction - 1.96 * std_prediction,</span>
<span class="sd">                    mean_prediction + 1.96 * std_prediction,</span>
<span class="sd">                    alpha=0.5,</span>
<span class="sd">                    label=r&quot;95% confidence interval&quot;,</span>
<span class="sd">                    )</span>
<span class="sd">                plt.legend()</span>
<span class="sd">                plt.xlabel(&quot;$x$&quot;)</span>
<span class="sd">                plt.ylabel(&quot;$f(x)$&quot;)</span>
<span class="sd">                _ = plt.title(&quot;Gaussian process regression on noise-free dataset&quot;)</span>
<span class="sd">                plt.show()</span>

<span class="sd">        References:</span>

<span class="sd">            [[1](https://scikit-learn.org/stable/auto_examples/gaussian_process/plot_gpr_noisy_targets.html)]</span>
<span class="sd">            scikit-learn: Gaussian Processes regression: basic introductory example</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">log_level</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="n">var_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">log_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="n">spot_writer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">spacing</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span> <span class="o">=</span> <span class="n">min_theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span> <span class="o">=</span> <span class="n">max_theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span> <span class="o">=</span> <span class="n">min_Lambda</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span> <span class="o">=</span> <span class="n">max_Lambda</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="n">n_theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">=</span> <span class="n">n_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span> <span class="o">=</span> <span class="n">optim_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span> <span class="o">=</span> <span class="n">theta_init_zero</span>
        <span class="c1"># Psi matrix condition:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">model_optimizer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">differential_evolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="n">model_fun_evals</span>
        <span class="c1"># differential evolution uses maxiter = 1000</span>
        <span class="c1"># and sets the number of function evaluations to</span>
        <span class="c1"># (maxiter + 1) * popsize * N, which results in</span>
        <span class="c1"># 1000 * 15 * k, because the default popsize is 15 and</span>
        <span class="c1"># N is the number of parameters. This seems to be quite large:</span>
        <span class="c1"># for k=2 these are 30 000 iterations. Therefore we set this value to</span>
        <span class="c1"># 100</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="c1"># Logging information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Logger</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the logger at level </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="si">}</span><span class="s2"> for module </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">exp_imp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">s0</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the expected improvement for a given function value and error in coded units.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            y0 (float): The function value in coded units.</span>
<span class="sd">            s0 (float): The error value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The expected improvement value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">                S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="sd">                S.exp_imp(1.0, 0.0)</span>
<span class="sd">                0.0</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">                S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="sd">                # assert S.exp_imp(0.0, 1.0) == 1/np.sqrt(2*np.pi)</span>
<span class="sd">                # which is approx. 0.3989422804014327</span>
<span class="sd">                S.exp_imp(0.0, 1.0)</span>
<span class="sd">                0.3989422804014327</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We do not use the min y values, but the aggragated mean values</span>
        <span class="c1"># y_min = min(self.nat_y)</span>
        <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s0</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">EI</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">s0</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">EI_one</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">s0</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">EI_two</span> <span class="o">=</span> <span class="p">(</span><span class="n">s0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">s0</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">EI</span> <span class="o">=</span> <span class="n">EI_one</span> <span class="o">+</span> <span class="n">EI_two</span>
        <span class="k">return</span> <span class="n">EI</span>

    <span class="k">def</span> <span class="nf">set_de_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine search bounds for model_optimizer, e.g., differential evolution.</span>

<span class="sd">        This method sets the attribute `de_bounds` of the object to a list of lists,</span>
<span class="sd">        where each inner list represents the lower and upper bounds for a parameter</span>
<span class="sd">        being optimized. The number of inner lists is determined by the number of</span>
<span class="sd">        parameters being optimized (`n_theta` and `n_p`), as well as whether noise is</span>
<span class="sd">        being considered (`noise`).</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                print(S.de_bounds)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.optim_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.n_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.noise: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">)</span>

        <span class="n">de_bounds</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="n">de_bounds</span> <span class="o">+=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_bounds</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.de_bounds: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">extract_from_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract `theta`, `p`, and `Lambda` from bounds. The kriging object stores</span>
<span class="sd">        `theta` as an array,  `p` as an array, and `Lambda` as a float.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            new_theta_p_Lambda (np.ndarray):</span>
<span class="sd">                1d-array with theta, p, and Lambda values. Order is important.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotPython.build.kriging import Kriging</span>
<span class="sd">                n=2</span>
<span class="sd">                p=4</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S.extract_from_bounds(np.array([1, 2, 3]))</span>
<span class="sd">                print(S.theta)</span>
<span class="sd">                print(S.p)</span>
<span class="sd">                [1 2]</span>
<span class="sd">                [3]</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): new_theta_p_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">optimize_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Optimize the model using the specified model_optimizer.</span>

<span class="sd">        This method uses the specified model_optimizer to optimize the</span>
<span class="sd">        likelihood function (`fun_likelihood`) with respect to the model parameters.</span>
<span class="sd">        The optimization is performed within the bounds specified by the attribute</span>
<span class="sd">        `de_bounds`.</span>
<span class="sd">        The result of the optimization is returned as a list or tuple of optimized parameter values.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                n=2</span>
<span class="sd">                p=2</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">                print(new_theta_p_Lambda)</span>

<span class="sd">        Returns:</span>
<span class="sd">            result[&quot;x&quot;] (Union[List[float], Tuple[float]]):</span>
<span class="sd">                A list or tuple of optimized parameter values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In optimize_model(): self.de_bounds passed to optimizer: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;dual_annealing&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                          <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;differential_evolution&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                          <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
                                          <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span><span class="p">,</span>
                                          <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                          <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
                                          <span class="c1"># maxfun=self.model_fun_evals,</span>
                                          <span class="n">eps</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;shgo&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                          <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;basinhopping&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                          <span class="n">x0</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In optimize_model(): result: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;In optimize_model(): returned result[&quot;x&quot;]: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">update_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the log with the current values of negLnLike, theta, p, and Lambda.</span>

<span class="sd">        This method appends the current values of negLnLike, theta, p (if optim_p is True),</span>
<span class="sd">        and Lambda (if noise is True)</span>
<span class="sd">        to their respective lists in the log dictionary.</span>
<span class="sd">        It also updates the log_length attribute with the current length</span>
<span class="sd">        of the negLnLike list in the log.</span>

<span class="sd">        If spot_writer is not None, this method also writes the current values of</span>
<span class="sd">        negLnLike, theta, p (if optim_p is True),</span>
<span class="sd">        and Lambda (if noise is True) to the spot_writer object.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                n=2</span>
<span class="sd">                p=2</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">                S.update_log()</span>
<span class="sd">                print(S.log)</span>
<span class="sd">                {&#39;negLnLike&#39;: array([-1.38629436]),</span>
<span class="sd">                 &#39;theta&#39;: array([-1.14525993,  1.6123372 ]),</span>
<span class="sd">                  &#39;p&#39;: array([1.84444406, 1.74590865]),</span>
<span class="sd">                  &#39;Lambda&#39;: array([0.44268472])}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
        <span class="c1"># get the length of the log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span>
            <span class="n">negLnLike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_negLnLike&quot;</span><span class="p">,</span> <span class="n">negLnLike</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="c1"># add the self.n_theta theta values to the writer with one key &quot;theta&quot;,</span>
            <span class="c1"># i.e, the same key for all theta values</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_theta&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;theta_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)},</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_Lambda&quot;</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_p&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits the hyperparameters (`theta`, `p`, `Lambda`) of the Kriging model.</span>

<span class="sd">        The function computes the following internal values:</span>
<span class="sd">        1. `theta`, `p`, and `Lambda` values via optimization of the function `fun_likelihood()`.</span>
<span class="sd">        2. Correlation matrix `Psi` via `rebuildPsi()`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            nat_X (np.ndarray): Sample points.</span>
<span class="sd">            nat_y (np.ndarray): Function values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            object: Fitted estimator.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            theta (np.ndarray): Kriging theta values. Shape (k,).</span>
<span class="sd">            p (np.ndarray): Kriging p values. Shape (k,).</span>
<span class="sd">            LnDetPsi (np.float64): Determinant Psi matrix.</span>
<span class="sd">            Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">            psi (np.ndarray): psi vector. Shape (n,).</span>
<span class="sd">            one (np.ndarray): vector of ones. Shape (n,).</span>
<span class="sd">            mu (np.float64): Kriging expected mean value mu.</span>
<span class="sd">            U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>
<span class="sd">            SigmaSqr (np.float64): Sigma squared value.</span>
<span class="sd">            Lambda (float): lambda noise value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[1, 0], [1, 0]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                S = Kriging()</span>
<span class="sd">                S.fit(nat_X, nat_y)</span>
<span class="sd">                print(S.Psi)</span>
<span class="sd">                [[1.00000001 1.        ]</span>
<span class="sd">                [1.         1.00000001]]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit(): nat_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit(): nat_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_variables</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_variable_types</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_theta_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_matrices</span><span class="p">()</span>
        <span class="c1"># build_Psi() and build_U() are called in fun_likelihood</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_de_bounds</span><span class="p">()</span>
        <span class="c1"># Finally, set new theta and p values and update the surrogate again</span>
        <span class="c1"># for new_theta_p_Lambda in de_results[&quot;x&quot;]:</span>
        <span class="n">new_theta_p_Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_model</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extract_from_bounds</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_U</span><span class="p">()</span>
        <span class="c1"># TODO: check if the following line is necessary!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_log</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initialize_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize variables for the class instance.</span>

<span class="sd">        This method takes in the independent and dependent variable data as input</span>
<span class="sd">        and initializes the class instance variables.</span>
<span class="sd">        It creates deep copies of the input data and stores them in the</span>
<span class="sd">        instance variables `nat_X` and `nat_y`.</span>
<span class="sd">        It also calculates the number of observations `n` and</span>
<span class="sd">        the number of independent variables `k` from the shape of `nat_X`.</span>
<span class="sd">        Finally, it creates empty arrays with the same shape as `nat_X`</span>
<span class="sd">        and `nat_y` and stores them in the instance variables `cod_X` and `cod_y`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            nat_X (np.ndarray): The independent variable data.</span>
<span class="sd">            nat_y (np.ndarray): The dependent variable data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                S = Kriging()</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                print(f&quot;S.nat_X: {S.nat_X}&quot;)</span>
<span class="sd">                print(f&quot;S.nat_y: {S.nat_y}&quot;)</span>
<span class="sd">                S.nat_X: [[1 2]</span>
<span class="sd">                          [3 4]]</span>
<span class="sd">                S.nat_y: [1 2]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nat_X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nat_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">Z</span> <span class="o">=</span> <span class="n">aggregate_mean_var</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
        <span class="c1"># aggregated y values:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.nat_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.nat_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.aggregated_mean_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.min_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.max_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_variable_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the variable types for the class instance.</span>

<span class="sd">        This method sets the variable types for the class instance based</span>
<span class="sd">        on the `var_type` attribute. If the length of `var_type` is less</span>
<span class="sd">        than `k`, all variable types are forced to &#39;num&#39; and a warning is logged.</span>
<span class="sd">        The method then creates Boolean masks for each variable</span>
<span class="sd">        type (&#39;num&#39;, &#39;factor&#39;, &#39;int&#39;, &#39;ordered&#39;) using numpy arrays, e.g.,</span>
<span class="sd">        `num_mask = array([ True,  True])` if two numerical variables are present.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                n=2</span>
<span class="sd">                p=2</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="sd">                assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="sd">                assert S.num_mask.all() == True</span>
<span class="sd">                assert S.factor_mask.all() == False</span>
<span class="sd">                assert S.int_mask.all() == False</span>
<span class="sd">                assert S.ordered_mask.all() == True</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.var_type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="c1"># assume all variable types are &quot;num&quot; if &quot;num&quot; is</span>
        <span class="c1"># specified once:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): All variable types forced to &#39;num&#39;.&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.var_type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">int_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;num&quot;</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.num_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_mask</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.factor_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.int_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_mask</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.ordered_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_theta_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the theta values for the class instance.</span>

<span class="sd">        This method sets the theta values for the class instance based</span>
<span class="sd">        on the `n_theta` and `k` attributes. If `n_theta` is greater than</span>
<span class="sd">        `k`, `n_theta` is set to `k` and a warning is logged.</span>
<span class="sd">        The method then initializes the `theta` attribute as a list</span>
<span class="sd">        of zeros with length `n_theta`.</span>
<span class="sd">        The `x0_theta` attribute is also initialized as a list of ones</span>
<span class="sd">        with length `n_theta`, multiplied by `n / (100 * k)`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                from numpy import array</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">                nat_y = np.array([1, 2])</span>
<span class="sd">                n=2</span>
<span class="sd">                p=2</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                assert S.theta.all() == array([0., 0.]).all()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Too few theta values or more theta values than dimensions. `n_theta` set to `k`.&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">,))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the matrices for the class instance.</span>

<span class="sd">        This method initializes several matrices and attributes for the class instance.</span>
<span class="sd">        The `p` attribute is initialized as a list of ones with length `n_p`, multiplied by 2.0.</span>
<span class="sd">        The `pen_val` attribute is initialized as the natural logarithm of the</span>
<span class="sd">        variance of `nat_y`, multiplied by `n`, plus 1e4.</span>
<span class="sd">        The `negLnLike`, `LnDetPsi`, `mu`, `U`, `SigmaSqr`, and `Lambda` attributes are all set to None.</span>
<span class="sd">        The `gen` attribute is initialized using the `spacefilling` function with arguments `k` and `seed`.</span>
<span class="sd">        The `Psi` attribute is initialized as a zero matrix with shape `(n, n)` and dtype `float64`.</span>
<span class="sd">        The `psi` attribute is initialized as a zero matrix with shape `(n, 1)`.</span>
<span class="sd">        The `one` attribute is initialized as a list of ones with length `n`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                from numpy import log, var</span>
<span class="sd">                nat_X = np.array([[1, 2], [3, 4], [5, 6]])</span>
<span class="sd">                nat_y = np.array([1, 2, 3])</span>
<span class="sd">                n=3</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                # if var(self.nat_y) is &gt; 0, then self.pen_val = self.n * log(var(self.nat_y)) + 1e4</span>
<span class="sd">                # else self.pen_val = self.n * var(self.nat_y) + 1e4</span>
<span class="sd">                assert S.pen_val == nat_X.shape[0] * log(var(S.nat_y)) + 1e4</span>
<span class="sd">                assert S.Psi.shape == (n, n)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.n_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="c1"># if var(self.nat_y) is &gt; 0, then self.pen_val = self.n * log(var(self.nat_y)) + 1e4</span>
        <span class="c1"># else self.pen_val = self.n * var(self.nat_y) + 1e4</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): var(self.nat_y): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e4</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.pen_val: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.seed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="n">spacefilling</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.gen: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.Psi: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.psi: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">one</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.one: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">fun_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute log likelihood for a set of hyperparameters (theta, p, Lambda).</span>

<span class="sd">        This method computes the log likelihood for a set of hyperparameters</span>
<span class="sd">        (theta, p, Lambda) by performing the following steps:</span>
<span class="sd">        1. Extracts the hyperparameters from the input array using `extract_from_bounds()`.</span>
<span class="sd">        2. Checks if any element in `10^theta` is equal to 0. If so, logs a warning and</span>
<span class="sd">        returns the penalty value (`pen_val`).</span>
<span class="sd">        3. Builds the `Psi` matrix using `build_Psi()`.</span>
<span class="sd">        4. Checks if `Psi` is ill-conditioned or infinite. If so, logs a warning and returns</span>
<span class="sd">        the penalty value (`pen_val`).</span>
<span class="sd">        5. Builds the `U` matrix using `build_U()`. If an exception occurs, logs an error and</span>
<span class="sd">        returns the penalty value (`pen_val`).</span>
<span class="sd">        6. Computes the negative log likelihood using `likelihood()`.</span>
<span class="sd">        7. Returns the computed negative log likelihood (`negLnLike`).</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            new_theta_p_Lambda (np.ndarray):</span>
<span class="sd">                An array containing the `theta`, `p`, and `Lambda` values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float:</span>
<span class="sd">                The negative log likelihood of the surface at the specified hyperparameters.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            theta (np.ndarray): Kriging theta values. Shape (k,).</span>
<span class="sd">            p (np.ndarray): Kriging p values. Shape (k,).</span>
<span class="sd">            Lambda (float): lambda noise value.</span>
<span class="sd">            Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">            U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>
<span class="sd">            negLnLike (float): Negative log likelihood of the surface at the specified hyperparameters.</span>
<span class="sd">            pen_val (float): Penalty value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[0], [1]])</span>
<span class="sd">                nat_y = np.array([0, 1])</span>
<span class="sd">                n=1</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                print(S.cod_X)</span>
<span class="sd">                print(S.cod_y)</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">                S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.build_Psi()</span>
<span class="sd">                print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">                S.build_U()</span>
<span class="sd">                print(f&quot;S.U:{S.U}&quot;)</span>
<span class="sd">                S.likelihood()</span>
<span class="sd">                S.negLnLike</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extract_from_bounds</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_any__</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failure in fun_likelihood: 10^theta == 0. Setting negLnLike to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">&gt;</span> <span class="mf">1e9</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failure in fun_likelihood: Psi is ill conditioned: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Setting negLnLike to: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build_U</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">penalty_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in fun_likelihood(). Call to build_U() failed.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error=</span><span class="si">%s</span><span class="s2">, type(error)=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting negLnLike to </span><span class="si">%.2f</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">penalty_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span>

    <span class="k">def</span> <span class="nf">__is_any__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if any element in `x` is equal to `v`.</span>
<span class="sd">        This method checks if any element in the input array `x` is equal to the value `v`.</span>
<span class="sd">        If `x` is not an instance of `ndarray`, it is first converted to a numpy array using</span>
<span class="sd">        the `array()` function.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            x (np.ndarray or array-like):</span>
<span class="sd">                The input array to check for the presence of value `v`.</span>
<span class="sd">            v (scalar):</span>
<span class="sd">                The value to check for in the input array `x`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool:</span>
<span class="sd">                True if any element in `x` is equal to `v`, False otherwise.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                from numpy import power</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[0], [1]])</span>
<span class="sd">                nat_y = np.array([0, 1])</span>
<span class="sd">                n=1</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                print(S.__is_any__(power(10.0, S.theta), 0))</span>
<span class="sd">                print(S.__is_any__(S.theta, 0))</span>
<span class="sd">                S.theta: [0.]</span>
<span class="sd">                False</span>
<span class="sd">                True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_Psi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a new (n x n) correlation matrix Psi to reflect new data</span>
<span class="sd">        or a change in hyperparameters.</span>

<span class="sd">        This method uses `theta`, `p`, and coded `X` values to construct the</span>
<span class="sd">        correlation matrix as described in [Forr08a, p.57].</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            LinAlgError: If building Psi fails.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">            cnd_Psi (float): Condition number of Psi.</span>
<span class="sd">            inf_Psi (bool): True if Psi is infinite, False otherwise.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[0], [1]])</span>
<span class="sd">                nat_y = np.array([0, 1])</span>
<span class="sd">                n=1</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                print(S.nat_X)</span>
<span class="sd">                print(S.nat_y)</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">                S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.build_Psi()</span>
<span class="sd">                print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">                [[0]</span>
<span class="sd">                [1]]</span>
<span class="sd">                [0 1]</span>
<span class="sd">                S.theta: [0.]</span>
<span class="sd">                S.theta: [1.72284258]</span>
<span class="sd">                S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="sd">                [1.14348852e-23 1.00000001e+00]]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_ordered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span>
                    <span class="n">pdist</span><span class="p">(</span>
                        <span class="n">X_ordered</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;sqeuclidean&#39;</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">squareform</span><span class="p">(</span>
                    <span class="n">pdist</span><span class="p">(</span><span class="n">X_factor</span><span class="p">,</span>
                          <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span>
                          <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">])))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building Psi failed:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In build_Psi(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">[</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">[</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="n">cond</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_U</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scipy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs Cholesky factorization of Psi as U as described in [Forr08a, p.57].</span>
<span class="sd">        This method uses either `scipy_cholesky` or numpy&#39;s `cholesky` to perform the Cholesky factorization of Psi.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            scipy (bool):</span>
<span class="sd">                If True, use `scipy_cholesky`.</span>
<span class="sd">                If False, use numpy&#39;s `cholesky`.</span>
<span class="sd">                Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            LinAlgError:</span>
<span class="sd">                If Cholesky factorization fails for Psi.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[0], [1]])</span>
<span class="sd">                nat_y = np.array([0, 1])</span>
<span class="sd">                n=1</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                print(S.nat_X)</span>
<span class="sd">                print(S.nat_y)</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">                S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.build_Psi()</span>
<span class="sd">                print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">                S.build_U()</span>
<span class="sd">                print(f&quot;S.U:{S.U}&quot;)</span>
<span class="sd">                [[0]</span>
<span class="sd">                [1]]</span>
<span class="sd">                [0 1]</span>
<span class="sd">                S.theta: [0.]</span>
<span class="sd">                S.theta: [1.72284258]</span>
<span class="sd">                S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="sd">                [1.14348852e-23 1.00000001e+00]]</span>
<span class="sd">                S.U:[[1.00000001e+00 1.14348851e-23]</span>
<span class="sd">                [0.00000000e+00 1.00000001e+00]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">scipy_cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">scipy</span> <span class="k">else</span> <span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span>
        <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;build_U() Cholesky failed for Psi:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the negative of the concentrated log-likelihood.</span>

<span class="sd">        This method implements equation (2.32) in [Forr08a] to calculate</span>
<span class="sd">        the negative of the concentrated log-likelihood. It also modifies `mu`,</span>
<span class="sd">        `SigmaSqr`, `LnDetPsi`, and `negLnLike`.</span>

<span class="sd">        Note:</span>
<span class="sd">            `build_Psi` and `build_U` should be called first.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            mu (np.float64): Kriging expected mean value mu.</span>
<span class="sd">            SigmaSqr (np.float64): Sigma squared value.</span>
<span class="sd">            LnDetPsi (np.float64): Determinant Psi matrix.</span>
<span class="sd">            negLnLike (float): Negative log likelihood of the surface at the specified hyperparameters.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[1], [2]])</span>
<span class="sd">                nat_y = np.array([5, 10])</span>
<span class="sd">                n=2</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False, theta_init_zero=True)</span>
<span class="sd">                S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S.set_variable_types()</span>
<span class="sd">                S.set_theta_values()</span>
<span class="sd">                S.initialize_matrices()</span>
<span class="sd">                S.build_Psi()</span>
<span class="sd">                S.build_U()</span>
<span class="sd">                S.likelihood()</span>
<span class="sd">                # assert S.mu is close to 7.5 with a tolerance of 1e-6</span>
<span class="sd">                assert np.allclose(S.mu, 7.5, atol=1e-6)</span>
<span class="sd">                E = np.exp(1)</span>
<span class="sd">                sigma2 = E/(E**2 -1) * (25/4 + 25/4*E)</span>
<span class="sd">                # asssert S.SigmaSqr is close to sigma2 with a tolerance of 1e-6</span>
<span class="sd">                assert np.allclose(S.SigmaSqr, sigma2, atol=1e-6)</span>
<span class="sd">                print(f&quot;S.LnDetPsi:{S.LnDetPsi}&quot;)</span>
<span class="sd">                print(f&quot;S.self.negLnLike:{S.negLnLike}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># (2.20) in [Forr08a]:</span>
        <span class="n">U_T_inv_one</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="p">)</span>
        <span class="n">U_T_inv_cod_y</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv_cod_y</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv_one</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
        <span class="c1"># (2.31) in [Forr08a]</span>
        <span class="n">cod_y_minus_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">=</span> <span class="n">cod_y_minus_mu</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cod_y_minus_mu</span><span class="p">)))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="c1"># (2.32) in [Forr08a]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots 1D and 2D surrogates.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            show (bool):</span>
<span class="sd">                If `True`, the plots are displayed.</span>
<span class="sd">                If `False`, `plt.show()` should be called outside this function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Note:</span>
<span class="sd">            * This method provides only a basic plot. For more advanced plots,</span>
<span class="sd">                use the `plot_contour()` method of the `Spot` class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotPython.fun.objectivefunctions import analytical</span>
<span class="sd">                from spotPython.spot import spot</span>
<span class="sd">                # 1-dimensional example</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                lower = np.array([-1])</span>
<span class="sd">                upper = np.array([1])</span>
<span class="sd">                design_control={&quot;init_size&quot;: 10}</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            noise=False,</span>
<span class="sd">                            lower = lower,</span>
<span class="sd">                            upper= upper,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.initialize_design()</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.surrogate.plot()</span>
<span class="sd">                # 2-dimensional example</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                lower = np.array([-1, -1])</span>
<span class="sd">                upper = np.array([1, 1])</span>
<span class="sd">                design_control={&quot;init_size&quot;: 10}</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            noise=False,</span>
<span class="sd">                            lower = lower,</span>
<span class="sd">                            upper= upper,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.initialize_design()</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.surrogate.plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># TODO: Improve plot (add conf. interval etc.)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
            <span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
            <span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
            <span class="p">)</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="c1"># Predict based on the optimized results</span>
            <span class="n">zz</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span> <span class="n">return_val</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">ravel</span><span class="p">(</span><span class="n">Y</span><span class="p">))]</span>
            <span class="p">)</span>
            <span class="n">zs</span> <span class="o">=</span> <span class="n">zz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">zse</span> <span class="o">=</span> <span class="n">zz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">Ze</span> <span class="o">=</span> <span class="n">zse</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

            <span class="n">nat_point_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">nat_point_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">contour_levels</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
            <span class="c1"># plot predicted values:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="n">contour_levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="c1"># plot observed points:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nat_point_X</span><span class="p">,</span> <span class="n">nat_point_Y</span><span class="p">,</span> <span class="s2">&quot;ow&quot;</span><span class="p">)</span>
            <span class="c1">#</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
            <span class="c1"># plot predicted values:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">contour_levels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Surrogate&quot;</span><span class="p">)</span>
            <span class="c1"># plot observed points:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nat_point_X</span><span class="p">,</span> <span class="n">nat_point_Y</span><span class="p">,</span> <span class="s2">&quot;ow&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="c1">#</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
            <span class="c1">#</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
            <span class="c1">#</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">return_val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span>
                                                                      <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the prediction (in natural units) of the surrogate at the natural coordinates of X.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            nat_X (ndarray):</span>
<span class="sd">                Design variable to evaluate in natural units.</span>
<span class="sd">            return_val (str):</span>
<span class="sd">                whether `y`, `s`, neg. `ei` (negative expected improvement),</span>
<span class="sd">                or all three values are returned.</span>
<span class="sd">                Default is (for compatibility with sklearn) &quot;y&quot;. To return `s`, select &quot;s&quot;,</span>
<span class="sd">                to return neg. `ei`, select &quot;ei&quot;.</span>
<span class="sd">                To return the tuple `(y, s, ei)`, select &quot;all&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float:</span>
<span class="sd">                The predicted value in natural units if return_val is &quot;y&quot;.</span>
<span class="sd">            float:</span>
<span class="sd">                predicted error if return_val is &quot;s&quot;.</span>
<span class="sd">            float:</span>
<span class="sd">                expected improvement if return_val is &quot;ei&quot;.</span>
<span class="sd">            Tuple[float, float, float]:</span>
<span class="sd">                The predicted value in natural units, predicted error</span>
<span class="sd">                and expected improvement if return_val is &quot;all&quot;.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                import matplotlib.pyplot as plt</span>
<span class="sd">                from numpy import linspace, arange</span>
<span class="sd">                rng = np.random.RandomState(1)</span>
<span class="sd">                X = linspace(start=0, stop=10, num=1_0).reshape(-1, 1)</span>
<span class="sd">                y = np.squeeze(X * np.sin(X))</span>
<span class="sd">                training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="sd">                X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">                S.fit(X_train, y_train)</span>
<span class="sd">                mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="sd">                print(f&quot;mean_prediction: {mean_prediction}&quot;)</span>
<span class="sd">                print(f&quot;std_prediction: {std_prediction}&quot;)</span>
<span class="sd">                print(f&quot;s_ei: {s_ei}&quot;)</span>
<span class="sd">                mean_prediction: [-1.41991225e-08  6.48310037e-01  1.76715565e+00 -6.35226564e-01</span>
<span class="sd">                                  -4.28585379e+00 -1.22301198e+00  2.49434148e+00  5.61900501e-01</span>
<span class="sd">                                  -3.04558205e+00 -5.44021104e+00]</span>
<span class="sd">                std_prediction: [3.69706811e-04 2.07958787e+00 3.69706810e-04 3.69706807e-04</span>
<span class="sd">                                3.69706809e-04 2.07958584e+00 3.69706811e-04 2.60615408e+00</span>
<span class="sd">                                2.60837033e+00 3.69706811e-04]</span>
<span class="sd">                s_ei: [-0.00000000e+00 -1.02341235e-03 -0.00000000e+00 -0.00000000e+00</span>
<span class="sd">                       -0.00000000e+00 -1.63799181e-02 -0.00000000e+00 -9.45766290e-03</span>
<span class="sd">                       -2.53405666e-01 -1.47459347e-04]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for the shape and the type of the Input</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">nat_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;13.1: Input to predict was not convertible to the size of X&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type of the given input is an </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">nat_X</span><span class="p">)</span><span class="si">}</span><span class="s2"> instead of an ndarray&quot;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">ei</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ei</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_coded</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;ei&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">ei</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">ei</span>

    <span class="k">def</span> <span class="nf">predict_coded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Kriging prediction of one point in the coded units as described in (2.20) in [Forr08a].</span>
<span class="sd">        The error is returned as well.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            cod_x (np.ndarray):</span>
<span class="sd">                Point in coded units to make prediction at.</span>

<span class="sd">        Returns:</span>
<span class="sd">            f (float): Predicted value in coded units.</span>
<span class="sd">            SSqr (float): Predicted error.</span>
<span class="sd">            EI (float): Expected improvement.</span>

<span class="sd">        Note:</span>
<span class="sd">            `self.mu` and `self.SigmaSqr` are computed in `likelihood`, not here.</span>
<span class="sd">            See also [Forr08a, p.60].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_psi_vec</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span>
        <span class="n">U_T_inv</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lambda</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="c1"># Error in [Forr08a, p.87]:</span>
        <span class="n">SSqr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Lambda</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">))))</span>
        <span class="n">SSqr</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">SSqr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_imp</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s0</span><span class="o">=</span><span class="n">SSqr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SSqr</span><span class="p">,</span> <span class="n">EI</span>

    <span class="k">def</span> <span class="nf">build_psi_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the psi vector. Needed by `predict_cod`, `predict_err_coded`,</span>
<span class="sd">        `regression_predict_coded`. Modifies `self.psi`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            cod_x (ndarray):</span>
<span class="sd">                point to calculate psi</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.psi (ndarray):</span>
<span class="sd">                psi vector</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotPython.build.kriging import Kriging</span>
<span class="sd">                X_train = np.array([[1., 2.],</span>
<span class="sd">                                    [2., 4.],</span>
<span class="sd">                                    [3., 6.]])</span>
<span class="sd">                y_train = np.array([1., 2., 3.])</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;,</span>
<span class="sd">                            seed=123,</span>
<span class="sd">                            log_level=50,</span>
<span class="sd">                            n_theta=1,</span>
<span class="sd">                            noise=False,</span>
<span class="sd">                            cod_type=&quot;norm&quot;)</span>
<span class="sd">                S.fit(X_train, y_train)</span>
<span class="sd">                # force theta to simple values:</span>
<span class="sd">                S.theta = np.array([0.0])</span>
<span class="sd">                nat_X = np.array([1., 0.])</span>
<span class="sd">                S.psi = np.zeros((S.n, 1))</span>
<span class="sd">                S.build_psi_vec(nat_X)</span>
<span class="sd">                res = np.array([[np.exp(-4)],</span>
<span class="sd">                    [np.exp(-17)],</span>
<span class="sd">                    [np.exp(-40)]])</span>
<span class="sd">                assert np.array_equal(S.psi, res)</span>
<span class="sd">                print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="sd">                print(f&quot;Control value res: {res}&quot;)</span>
<span class="sd">                S.psi:</span>
<span class="sd">                [[1.83156389e-02]</span>
<span class="sd">                [4.13993772e-08]</span>
<span class="sd">                [4.24835426e-18]]</span>
<span class="sd">                Control value res:</span>
<span class="sd">                [[1.83156389e-02]</span>
<span class="sd">                [4.13993772e-08]</span>
<span class="sd">                [4.24835426e-18]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_ordered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
                <span class="n">x_ordered</span> <span class="o">=</span> <span class="n">cod_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_ordered</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)),</span>
                          <span class="n">X_ordered</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)),</span>
                          <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;sqeuclidean&#39;</span><span class="p">,</span>
                          <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
                <span class="n">x_factor</span> <span class="o">=</span> <span class="n">cod_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_factor</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)),</span>
                               <span class="n">X_factor</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)),</span>
                               <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span>
                               <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building psi failed:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">weighted_exp_imp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Weighted expected improvement.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>
<span class="sd">            cod_x (np.ndarray): A coded design vector.</span>
<span class="sd">            w (float): Weight.</span>

<span class="sd">        Returns:</span>
<span class="sd">            EI (float): Weighted expected improvement.</span>

<span class="sd">        References:</span>
<span class="sd">            [Sobester et al. 2005].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">s0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_coded</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span>
        <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s0</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">EI</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_min_y0</span> <span class="o">=</span> <span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span>
            <span class="n">EI_one</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">y_min_y0</span>
                    <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_min_y0</span> <span class="o">/</span> <span class="n">s0</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="n">EI_two</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
                    <span class="o">*</span> <span class="p">(</span><span class="n">s0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)))</span>
                    <span class="o">*</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min_y0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">s0</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="n">EI</span> <span class="o">=</span> <span class="n">EI_one</span> <span class="o">+</span> <span class="n">EI_two</span>
        <span class="k">return</span> <span class="n">EI</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;kriging&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">124</span><span class="p">,</span> <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_fun_evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_theta</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">max_theta</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">n_theta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta_init_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_val</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">n_p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">optim_p</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_Lambda</span><span class="o">=</span><span class="mf">1e-09</span><span class="p">,</span> <span class="n">max_Lambda</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Kriging surrogate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>noise</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Use regression instead of interpolation kriging. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>var_type</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Variable type. Can be either &ldquo;num&rdquo; (numerical) or &ldquo;factor&rdquo; (factor).
Defaults to [&ldquo;num&rdquo;].</p>
            </div>
          </td>
          <td>
                <code>[&#39;num&#39;]</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Surrogate name. Defaults to &ldquo;kriging&rdquo;.</p>
            </div>
          </td>
          <td>
                <code>&#39;kriging&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Random seed. Defaults to 124.</p>
            </div>
          </td>
          <td>
                <code>124</code>
          </td>
        </tr>
        <tr>
          <td><code>model_optimizer</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[object]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optimizer on the surrogate. If None, differential_evolution is selected.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>model_fun_evals</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of iterations used by the optimizer on the surrogate.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>min_theta</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Min log10 theta value. Defaults to -3.</p>
            </div>
          </td>
          <td>
                <code>-3.0</code>
          </td>
        </tr>
        <tr>
          <td><code>max_theta</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Max log10 theta value. Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2.0</code>
          </td>
        </tr>
        <tr>
          <td><code>n_theta</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of theta values. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>theta_init_zero</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialize theta with zero. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>p_val</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>p value. Used as an initial value if optim_p = True. Otherwise as a constant. Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2.0</code>
          </td>
        </tr>
        <tr>
          <td><code>n_p</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of p values. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>optim_p</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether p should be optimized. Deafults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>min_Lambda</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Min Lambda value. Defaults to 1e-9.</p>
            </div>
          </td>
          <td>
                <code>1e-09</code>
          </td>
        </tr>
        <tr>
          <td><code>max_Lambda</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Max Lambda value. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>log_level</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logging level, e.g., 20 is &ldquo;INFO&rdquo;. Defaults to 50 (&ldquo;CRITICAL&rdquo;).</p>
            </div>
          </td>
          <td>
                <code>50</code>
          </td>
        </tr>
        <tr>
          <td><code>spot_writer</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[object]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spot writer. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>counter</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Counter. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    import matplotlib.pyplot as plt</span>
<span class="go">    from numpy import linspace, arange</span>
<span class="go">    rng = np.random.RandomState(1)</span>
<span class="go">    X = linspace(start=0, stop=10, num=1_000).reshape(-1, 1)</span>
<span class="go">    y = np.squeeze(X * np.sin(X))</span>
<span class="go">    training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="go">    X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="go">    S.fit(X_train, y_train)</span>
<span class="go">    mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="go">    plt.plot(X, y, label=r&quot;$f(x)$&quot;, linestyle=&quot;dotted&quot;)</span>
<span class="go">    plt.scatter(X_train, y_train, label=&quot;Observations&quot;)</span>
<span class="go">    plt.plot(X, mean_prediction, label=&quot;Mean prediction&quot;)</span>
<span class="go">    plt.fill_between(</span>
<span class="go">        X.ravel(),</span>
<span class="go">        mean_prediction - 1.96 * std_prediction,</span>
<span class="go">        mean_prediction + 1.96 * std_prediction,</span>
<span class="go">        alpha=0.5,</span>
<span class="go">        label=r&quot;95% confidence interval&quot;,</span>
<span class="go">        )</span>
<span class="go">    plt.legend()</span>
<span class="go">    plt.xlabel(&quot;$x$&quot;)</span>
<span class="go">    plt.ylabel(&quot;$f(x)$&quot;)</span>
<span class="go">    _ = plt.title(&quot;Gaussian process regression on noise-free dataset&quot;)</span>
<span class="go">    plt.show()</span>
</code></pre></div>
      <p>References:</p>
<pre><code>[[1](https://scikit-learn.org/stable/auto_examples/gaussian_process/plot_gpr_noisy_targets.html)]
scikit-learn: Gaussian Processes regression: basic introductory example
</code></pre>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
        <span class="n">noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">var_type</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;kriging&quot;</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">124</span><span class="p">,</span>
        <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">model_fun_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span>
        <span class="n">max_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">n_theta</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">theta_init_zero</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">p_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">n_p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">optim_p</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">min_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">,</span>
        <span class="n">max_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
        <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the Kriging surrogate.</span>

<span class="sd">    Args:</span>
<span class="sd">        noise (bool): Use regression instead of interpolation kriging. Defaults to False.</span>
<span class="sd">        var_type (List[str]):</span>
<span class="sd">            Variable type. Can be either &quot;num&quot; (numerical) or &quot;factor&quot; (factor).</span>
<span class="sd">            Defaults to [&quot;num&quot;].</span>
<span class="sd">        name (str):</span>
<span class="sd">            Surrogate name. Defaults to &quot;kriging&quot;.</span>
<span class="sd">        seed (int):</span>
<span class="sd">            Random seed. Defaults to 124.</span>
<span class="sd">        model_optimizer (Optional[object]):</span>
<span class="sd">            Optimizer on the surrogate. If None, differential_evolution is selected.</span>
<span class="sd">        model_fun_evals (Optional[int]):</span>
<span class="sd">            Number of iterations used by the optimizer on the surrogate.</span>
<span class="sd">        min_theta (float):</span>
<span class="sd">            Min log10 theta value. Defaults to -3.</span>
<span class="sd">        max_theta (float):</span>
<span class="sd">            Max log10 theta value. Defaults to 2.</span>
<span class="sd">        n_theta (int):</span>
<span class="sd">            Number of theta values. Defaults to 1.</span>
<span class="sd">        theta_init_zero (bool):</span>
<span class="sd">            Initialize theta with zero. Defaults to True.</span>
<span class="sd">        p_val (float):</span>
<span class="sd">            p value. Used as an initial value if optim_p = True. Otherwise as a constant. Defaults to 2.</span>
<span class="sd">        n_p (int):</span>
<span class="sd">            Number of p values. Defaults to 1.</span>
<span class="sd">        optim_p (bool):</span>
<span class="sd">            Determines whether p should be optimized. Deafults to False.</span>
<span class="sd">        min_Lambda (float):</span>
<span class="sd">            Min Lambda value. Defaults to 1e-9.</span>
<span class="sd">        max_Lambda (float):</span>
<span class="sd">            Max Lambda value. Defaults to 1.</span>
<span class="sd">        log_level (int):</span>
<span class="sd">            Logging level, e.g., 20 is &quot;INFO&quot;. Defaults to 50 (&quot;CRITICAL&quot;).</span>
<span class="sd">        spot_writer (Optional[object]):</span>
<span class="sd">            Spot writer. Defaults to None.</span>
<span class="sd">        counter (Optional[int]):</span>
<span class="sd">            Counter. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            import matplotlib.pyplot as plt</span>
<span class="sd">            from numpy import linspace, arange</span>
<span class="sd">            rng = np.random.RandomState(1)</span>
<span class="sd">            X = linspace(start=0, stop=10, num=1_000).reshape(-1, 1)</span>
<span class="sd">            y = np.squeeze(X * np.sin(X))</span>
<span class="sd">            training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="sd">            X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">            S.fit(X_train, y_train)</span>
<span class="sd">            mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="sd">            plt.plot(X, y, label=r&quot;$f(x)$&quot;, linestyle=&quot;dotted&quot;)</span>
<span class="sd">            plt.scatter(X_train, y_train, label=&quot;Observations&quot;)</span>
<span class="sd">            plt.plot(X, mean_prediction, label=&quot;Mean prediction&quot;)</span>
<span class="sd">            plt.fill_between(</span>
<span class="sd">                X.ravel(),</span>
<span class="sd">                mean_prediction - 1.96 * std_prediction,</span>
<span class="sd">                mean_prediction + 1.96 * std_prediction,</span>
<span class="sd">                alpha=0.5,</span>
<span class="sd">                label=r&quot;95% confidence interval&quot;,</span>
<span class="sd">                )</span>
<span class="sd">            plt.legend()</span>
<span class="sd">            plt.xlabel(&quot;$x$&quot;)</span>
<span class="sd">            plt.ylabel(&quot;$f(x)$&quot;)</span>
<span class="sd">            _ = plt.title(&quot;Gaussian process regression on noise-free dataset&quot;)</span>
<span class="sd">            plt.show()</span>

<span class="sd">    References:</span>

<span class="sd">        [[1](https://scikit-learn.org/stable/auto_examples/gaussian_process/plot_gpr_noisy_targets.html)]</span>
<span class="sd">        scikit-learn: Gaussian Processes regression: basic introductory example</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">log_level</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="n">var_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">log_level</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="n">spot_writer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">spacing</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span> <span class="o">=</span> <span class="n">min_theta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span> <span class="o">=</span> <span class="n">max_theta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span> <span class="o">=</span> <span class="n">min_Lambda</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span> <span class="o">=</span> <span class="n">max_Lambda</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="n">n_theta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">=</span> <span class="n">n_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span> <span class="o">=</span> <span class="n">optim_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span> <span class="o">=</span> <span class="n">theta_init_zero</span>
    <span class="c1"># Psi matrix condition:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">model_optimizer</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">differential_evolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="n">model_fun_evals</span>
    <span class="c1"># differential evolution uses maxiter = 1000</span>
    <span class="c1"># and sets the number of function evaluations to</span>
    <span class="c1"># (maxiter + 1) * popsize * N, which results in</span>
    <span class="c1"># 1000 * 15 * k, because the default popsize is 15 and</span>
    <span class="c1"># N is the number of parameters. This seems to be quite large:</span>
    <span class="c1"># for k=2 these are 30 000 iterations. Therefore we set this value to</span>
    <span class="c1"># 100</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># Logging information</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Logger</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the logger at level </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="si">}</span><span class="s2"> for module </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.__is_any__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__is_any__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.__is_any__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if any element in <code>x</code> is equal to <code>v</code>.
This method checks if any element in the input array <code>x</code> is equal to the value <code>v</code>.
If <code>x</code> is not an instance of <code>ndarray</code>, it is first converted to a numpy array using
the <code>array()</code> function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span> or <span title="numpy.array">array</span> - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input array to check for the presence of value <code>v</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>v</code></td>
          <td>
                <code>scalar</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value to check for in the input array <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if any element in <code>x</code> is equal to <code>v</code>, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    from numpy import power</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[0], [1]])</span>
<span class="go">    nat_y = np.array([0, 1])</span>
<span class="go">    n=1</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    print(S.__is_any__(power(10.0, S.theta), 0))</span>
<span class="go">    print(S.__is_any__(S.theta, 0))</span>
<span class="go">    S.theta: [0.]</span>
<span class="go">    False</span>
<span class="go">    True</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__is_any__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if any element in `x` is equal to `v`.</span>
<span class="sd">    This method checks if any element in the input array `x` is equal to the value `v`.</span>
<span class="sd">    If `x` is not an instance of `ndarray`, it is first converted to a numpy array using</span>
<span class="sd">    the `array()` function.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        x (np.ndarray or array-like):</span>
<span class="sd">            The input array to check for the presence of value `v`.</span>
<span class="sd">        v (scalar):</span>
<span class="sd">            The value to check for in the input array `x`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>
<span class="sd">            True if any element in `x` is equal to `v`, False otherwise.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            from numpy import power</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[0], [1]])</span>
<span class="sd">            nat_y = np.array([0, 1])</span>
<span class="sd">            n=1</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            print(S.__is_any__(power(10.0, S.theta), 0))</span>
<span class="sd">            print(S.__is_any__(S.theta, 0))</span>
<span class="sd">            S.theta: [0.]</span>
<span class="sd">            False</span>
<span class="sd">            True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.build_Psi" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_Psi</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.build_Psi" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Constructs a new (n x n) correlation matrix Psi to reflect new data
or a change in hyperparameters.</p>
<p>This method uses <code>theta</code>, <code>p</code>, and coded <code>X</code> values to construct the
correlation matrix as described in [Forr08a, p.57].</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.linalg.LinAlgError">LinAlgError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If building Psi fails.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.build_Psi.Psi">Psi</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Correlation matrix Psi. Shape (n,n).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.build_Psi.cnd_Psi">cnd_Psi</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Condition number of Psi.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.build_Psi.inf_Psi">inf_Psi</span></code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if Psi is infinite, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[0], [1]])</span>
<span class="go">    nat_y = np.array([0, 1])</span>
<span class="go">    n=1</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    print(S.nat_X)</span>
<span class="go">    print(S.nat_y)</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S.optimize_model()</span>
<span class="go">    S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.build_Psi()</span>
<span class="go">    print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="go">    [[0]</span>
<span class="go">    [1]]</span>
<span class="go">    [0 1]</span>
<span class="go">    S.theta: [0.]</span>
<span class="go">    S.theta: [1.72284258]</span>
<span class="go">    S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="go">    [1.14348852e-23 1.00000001e+00]]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_Psi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a new (n x n) correlation matrix Psi to reflect new data</span>
<span class="sd">    or a change in hyperparameters.</span>

<span class="sd">    This method uses `theta`, `p`, and coded `X` values to construct the</span>
<span class="sd">    correlation matrix as described in [Forr08a, p.57].</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        LinAlgError: If building Psi fails.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">        cnd_Psi (float): Condition number of Psi.</span>
<span class="sd">        inf_Psi (bool): True if Psi is infinite, False otherwise.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[0], [1]])</span>
<span class="sd">            nat_y = np.array([0, 1])</span>
<span class="sd">            n=1</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            print(S.nat_X)</span>
<span class="sd">            print(S.nat_y)</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">            S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.build_Psi()</span>
<span class="sd">            print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">            [[0]</span>
<span class="sd">            [1]]</span>
<span class="sd">            [0 1]</span>
<span class="sd">            S.theta: [0.]</span>
<span class="sd">            S.theta: [1.72284258]</span>
<span class="sd">            S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="sd">            [1.14348852e-23 1.00000001e+00]]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_ordered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span>
                <span class="n">pdist</span><span class="p">(</span>
                    <span class="n">X_ordered</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;sqeuclidean&#39;</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">squareform</span><span class="p">(</span>
                <span class="n">pdist</span><span class="p">(</span><span class="n">X_factor</span><span class="p">,</span>
                      <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span>
                      <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building Psi failed:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In build_Psi(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">[</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">[</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="n">cond</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.build_U" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_U</span><span class="p">(</span><span class="n">scipy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.build_U" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Performs Cholesky factorization of Psi as U as described in [Forr08a, p.57].
This method uses either <code>scipy_cholesky</code> or numpy&rsquo;s <code>cholesky</code> to perform the Cholesky factorization of Psi.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scipy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, use <code>scipy_cholesky</code>.
If False, use numpy&rsquo;s <code>cholesky</code>.
Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.linalg.LinAlgError">LinAlgError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If Cholesky factorization fails for Psi.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.build_U.U">U</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging U matrix, Cholesky decomposition. Shape (n,n).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[0], [1]])</span>
<span class="go">    nat_y = np.array([0, 1])</span>
<span class="go">    n=1</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    print(S.nat_X)</span>
<span class="go">    print(S.nat_y)</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S.optimize_model()</span>
<span class="go">    S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.build_Psi()</span>
<span class="go">    print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="go">    S.build_U()</span>
<span class="go">    print(f&quot;S.U:{S.U}&quot;)</span>
<span class="go">    [[0]</span>
<span class="go">    [1]]</span>
<span class="go">    [0 1]</span>
<span class="go">    S.theta: [0.]</span>
<span class="go">    S.theta: [1.72284258]</span>
<span class="go">    S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="go">    [1.14348852e-23 1.00000001e+00]]</span>
<span class="go">    S.U:[[1.00000001e+00 1.14348851e-23]</span>
<span class="go">    [0.00000000e+00 1.00000001e+00]]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_U</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scipy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs Cholesky factorization of Psi as U as described in [Forr08a, p.57].</span>
<span class="sd">    This method uses either `scipy_cholesky` or numpy&#39;s `cholesky` to perform the Cholesky factorization of Psi.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        scipy (bool):</span>
<span class="sd">            If True, use `scipy_cholesky`.</span>
<span class="sd">            If False, use numpy&#39;s `cholesky`.</span>
<span class="sd">            Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        LinAlgError:</span>
<span class="sd">            If Cholesky factorization fails for Psi.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[0], [1]])</span>
<span class="sd">            nat_y = np.array([0, 1])</span>
<span class="sd">            n=1</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            print(S.nat_X)</span>
<span class="sd">            print(S.nat_y)</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">            S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.build_Psi()</span>
<span class="sd">            print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">            S.build_U()</span>
<span class="sd">            print(f&quot;S.U:{S.U}&quot;)</span>
<span class="sd">            [[0]</span>
<span class="sd">            [1]]</span>
<span class="sd">            [0 1]</span>
<span class="sd">            S.theta: [0.]</span>
<span class="sd">            S.theta: [1.72284258]</span>
<span class="sd">            S.Psi: [[1.00000001e+00 1.14348852e-23]</span>
<span class="sd">            [1.14348852e-23 1.00000001e+00]]</span>
<span class="sd">            S.U:[[1.00000001e+00 1.14348851e-23]</span>
<span class="sd">            [0.00000000e+00 1.00000001e+00]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">scipy_cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">scipy</span> <span class="k">else</span> <span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span>
    <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;build_U() Cholesky failed for Psi:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.build_psi_vec" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_psi_vec</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.build_psi_vec" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Build the psi vector. Needed by <code>predict_cod</code>, <code>predict_err_coded</code>,
<code>regression_predict_coded</code>. Modifies <code>self.psi</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cod_x</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>point to calculate psi</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.build_psi_vec.self.psi">self.psi</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>psi vector</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">    from spotPython.build.kriging import Kriging</span>
<span class="go">    X_train = np.array([[1., 2.],</span>
<span class="go">                        [2., 4.],</span>
<span class="go">                        [3., 6.]])</span>
<span class="go">    y_train = np.array([1., 2., 3.])</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;,</span>
<span class="go">                seed=123,</span>
<span class="go">                log_level=50,</span>
<span class="go">                n_theta=1,</span>
<span class="go">                noise=False,</span>
<span class="go">                cod_type=&quot;norm&quot;)</span>
<span class="go">    S.fit(X_train, y_train)</span>
<span class="go">    # force theta to simple values:</span>
<span class="go">    S.theta = np.array([0.0])</span>
<span class="go">    nat_X = np.array([1., 0.])</span>
<span class="go">    S.psi = np.zeros((S.n, 1))</span>
<span class="go">    S.build_psi_vec(nat_X)</span>
<span class="go">    res = np.array([[np.exp(-4)],</span>
<span class="go">        [np.exp(-17)],</span>
<span class="go">        [np.exp(-40)]])</span>
<span class="go">    assert np.array_equal(S.psi, res)</span>
<span class="go">    print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="go">    print(f&quot;Control value res: {res}&quot;)</span>
<span class="go">    S.psi:</span>
<span class="go">    [[1.83156389e-02]</span>
<span class="go">    [4.13993772e-08]</span>
<span class="go">    [4.24835426e-18]]</span>
<span class="go">    Control value res:</span>
<span class="go">    [[1.83156389e-02]</span>
<span class="go">    [4.13993772e-08]</span>
<span class="go">    [4.24835426e-18]]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_psi_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build the psi vector. Needed by `predict_cod`, `predict_err_coded`,</span>
<span class="sd">    `regression_predict_coded`. Modifies `self.psi`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        cod_x (ndarray):</span>
<span class="sd">            point to calculate psi</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.psi (ndarray):</span>
<span class="sd">            psi vector</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotPython.build.kriging import Kriging</span>
<span class="sd">            X_train = np.array([[1., 2.],</span>
<span class="sd">                                [2., 4.],</span>
<span class="sd">                                [3., 6.]])</span>
<span class="sd">            y_train = np.array([1., 2., 3.])</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;,</span>
<span class="sd">                        seed=123,</span>
<span class="sd">                        log_level=50,</span>
<span class="sd">                        n_theta=1,</span>
<span class="sd">                        noise=False,</span>
<span class="sd">                        cod_type=&quot;norm&quot;)</span>
<span class="sd">            S.fit(X_train, y_train)</span>
<span class="sd">            # force theta to simple values:</span>
<span class="sd">            S.theta = np.array([0.0])</span>
<span class="sd">            nat_X = np.array([1., 0.])</span>
<span class="sd">            S.psi = np.zeros((S.n, 1))</span>
<span class="sd">            S.build_psi_vec(nat_X)</span>
<span class="sd">            res = np.array([[np.exp(-4)],</span>
<span class="sd">                [np.exp(-17)],</span>
<span class="sd">                [np.exp(-40)]])</span>
<span class="sd">            assert np.array_equal(S.psi, res)</span>
<span class="sd">            print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="sd">            print(f&quot;Control value res: {res}&quot;)</span>
<span class="sd">            S.psi:</span>
<span class="sd">            [[1.83156389e-02]</span>
<span class="sd">            [4.13993772e-08]</span>
<span class="sd">            [4.24835426e-18]]</span>
<span class="sd">            Control value res:</span>
<span class="sd">            [[1.83156389e-02]</span>
<span class="sd">            [4.13993772e-08]</span>
<span class="sd">            [4.24835426e-18]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_ordered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
            <span class="n">x_ordered</span> <span class="o">=</span> <span class="n">cod_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_ordered</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)),</span>
                      <span class="n">X_ordered</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)),</span>
                      <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;sqeuclidean&#39;</span><span class="p">,</span>
                      <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
            <span class="n">x_factor</span> <span class="o">=</span> <span class="n">cod_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_factor</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)),</span>
                           <span class="n">X_factor</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)),</span>
                           <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span>
                           <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">w</span><span class="o">=</span><span class="n">theta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building psi failed:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">err</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.exp_imp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exp_imp</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.exp_imp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates the expected improvement for a given function value and error in coded units.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y0</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The function value in coded units.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s0</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The error value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>float</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The expected improvement value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="go">    S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="go">    S.exp_imp(1.0, 0.0)</span>
<span class="go">    0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="go">    S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="go">    # assert S.exp_imp(0.0, 1.0) == 1/np.sqrt(2*np.pi)</span>
<span class="go">    # which is approx. 0.3989422804014327</span>
<span class="go">    S.exp_imp(0.0, 1.0)</span>
<span class="go">    0.3989422804014327</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exp_imp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">s0</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the expected improvement for a given function value and error in coded units.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        y0 (float): The function value in coded units.</span>
<span class="sd">        s0 (float): The error value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The expected improvement value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">            S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="sd">            S.exp_imp(1.0, 0.0)</span>
<span class="sd">            0.0</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">            S.aggregated_mean_y = [0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="sd">            # assert S.exp_imp(0.0, 1.0) == 1/np.sqrt(2*np.pi)</span>
<span class="sd">            # which is approx. 0.3989422804014327</span>
<span class="sd">            S.exp_imp(0.0, 1.0)</span>
<span class="sd">            0.3989422804014327</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We do not use the min y values, but the aggragated mean values</span>
    <span class="c1"># y_min = min(self.nat_y)</span>
    <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s0</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">elif</span> <span class="n">s0</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">EI_one</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">s0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">EI_two</span> <span class="o">=</span> <span class="p">(</span><span class="n">s0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">s0</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="n">EI_one</span> <span class="o">+</span> <span class="n">EI_two</span>
    <span class="k">return</span> <span class="n">EI</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.extract_from_bounds" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_from_bounds</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.extract_from_bounds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extract <code>theta</code>, <code>p</code>, and <code>Lambda</code> from bounds. The kriging object stores
<code>theta</code> as an array,  <code>p</code> as an array, and <code>Lambda</code> as a float.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>new_theta_p_Lambda</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1d-array with theta, p, and Lambda values. Order is important.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">    from spotPython.build.kriging import Kriging</span>
<span class="go">    n=2</span>
<span class="go">    p=4</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S.extract_from_bounds(np.array([1, 2, 3]))</span>
<span class="go">    print(S.theta)</span>
<span class="go">    print(S.p)</span>
<span class="go">    [1 2]</span>
<span class="go">    [3]</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_from_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract `theta`, `p`, and `Lambda` from bounds. The kriging object stores</span>
<span class="sd">    `theta` as an array,  `p` as an array, and `Lambda` as a float.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        new_theta_p_Lambda (np.ndarray):</span>
<span class="sd">            1d-array with theta, p, and Lambda values. Order is important.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotPython.build.kriging import Kriging</span>
<span class="sd">            n=2</span>
<span class="sd">            p=4</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S.extract_from_bounds(np.array([1, 2, 3]))</span>
<span class="sd">            print(S.theta)</span>
<span class="sd">            print(S.p)</span>
<span class="sd">            [1 2]</span>
<span class="sd">            [3]</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): new_theta_p_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">new_theta_p_Lambda</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In extract_from_bounds(): self.Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.fit" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.fit" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fits the hyperparameters (<code>theta</code>, <code>p</code>, <code>Lambda</code>) of the Kriging model.</p>
<p>The function computes the following internal values:
1. <code>theta</code>, <code>p</code>, and <code>Lambda</code> values via optimization of the function <code>fun_likelihood()</code>.
2. Correlation matrix <code>Psi</code> via <code>rebuildPsi()</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nat_X</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sample points.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nat_y</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>object</code></td>          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Fitted estimator.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.theta">theta</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging theta values. Shape (k,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.p">p</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging p values. Shape (k,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.LnDetPsi">LnDetPsi</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determinant Psi matrix.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.Psi">Psi</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Correlation matrix Psi. Shape (n,n).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.psi">psi</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>psi vector. Shape (n,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.one">one</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>vector of ones. Shape (n,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.mu">mu</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging expected mean value mu.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.U">U</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging U matrix, Cholesky decomposition. Shape (n,n).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.SigmaSqr">SigmaSqr</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sigma squared value.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fit.Lambda">Lambda</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>lambda noise value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[1, 0], [1, 0]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    S = Kriging()</span>
<span class="go">    S.fit(nat_X, nat_y)</span>
<span class="go">    print(S.Psi)</span>
<span class="go">    [[1.00000001 1.        ]</span>
<span class="go">    [1.         1.00000001]]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fits the hyperparameters (`theta`, `p`, `Lambda`) of the Kriging model.</span>

<span class="sd">    The function computes the following internal values:</span>
<span class="sd">    1. `theta`, `p`, and `Lambda` values via optimization of the function `fun_likelihood()`.</span>
<span class="sd">    2. Correlation matrix `Psi` via `rebuildPsi()`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        nat_X (np.ndarray): Sample points.</span>
<span class="sd">        nat_y (np.ndarray): Function values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Fitted estimator.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        theta (np.ndarray): Kriging theta values. Shape (k,).</span>
<span class="sd">        p (np.ndarray): Kriging p values. Shape (k,).</span>
<span class="sd">        LnDetPsi (np.float64): Determinant Psi matrix.</span>
<span class="sd">        Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">        psi (np.ndarray): psi vector. Shape (n,).</span>
<span class="sd">        one (np.ndarray): vector of ones. Shape (n,).</span>
<span class="sd">        mu (np.float64): Kriging expected mean value mu.</span>
<span class="sd">        U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>
<span class="sd">        SigmaSqr (np.float64): Sigma squared value.</span>
<span class="sd">        Lambda (float): lambda noise value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[1, 0], [1, 0]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            S = Kriging()</span>
<span class="sd">            S.fit(nat_X, nat_y)</span>
<span class="sd">            print(S.Psi)</span>
<span class="sd">            [[1.00000001 1.        ]</span>
<span class="sd">            [1.         1.00000001]]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit(): nat_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit(): nat_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialize_variables</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_variable_types</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_theta_values</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialize_matrices</span><span class="p">()</span>
    <span class="c1"># build_Psi() and build_U() are called in fun_likelihood</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_de_bounds</span><span class="p">()</span>
    <span class="c1"># Finally, set new theta and p values and update the surrogate again</span>
    <span class="c1"># for new_theta_p_Lambda in de_results[&quot;x&quot;]:</span>
    <span class="n">new_theta_p_Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_model</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extract_from_bounds</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_U</span><span class="p">()</span>
    <span class="c1"># TODO: check if the following line is necessary!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_log</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.fun_likelihood" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fun_likelihood</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.fun_likelihood" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute log likelihood for a set of hyperparameters (theta, p, Lambda).</p>
<p>This method computes the log likelihood for a set of hyperparameters
(theta, p, Lambda) by performing the following steps:
1. Extracts the hyperparameters from the input array using <code>extract_from_bounds()</code>.
2. Checks if any element in <code>10^theta</code> is equal to 0. If so, logs a warning and
returns the penalty value (<code>pen_val</code>).
3. Builds the <code>Psi</code> matrix using <code>build_Psi()</code>.
4. Checks if <code>Psi</code> is ill-conditioned or infinite. If so, logs a warning and returns
the penalty value (<code>pen_val</code>).
5. Builds the <code>U</code> matrix using <code>build_U()</code>. If an exception occurs, logs an error and
returns the penalty value (<code>pen_val</code>).
6. Computes the negative log likelihood using <code>likelihood()</code>.
7. Returns the computed negative log likelihood (<code>negLnLike</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>new_theta_p_Lambda</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array containing the <code>theta</code>, <code>p</code>, and <code>Lambda</code> values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>float</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The negative log likelihood of the surface at the specified hyperparameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.theta">theta</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging theta values. Shape (k,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.p">p</span></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging p values. Shape (k,).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.Lambda">Lambda</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>lambda noise value.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.Psi">Psi</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Correlation matrix Psi. Shape (n,n).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.U">U</span></code></td>
          <td>
                <code><span title="numpy.matrix">matrix</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging U matrix, Cholesky decomposition. Shape (n,n).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.negLnLike">negLnLike</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Negative log likelihood of the surface at the specified hyperparameters.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.fun_likelihood.pen_val">pen_val</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Penalty value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[0], [1]])</span>
<span class="go">    nat_y = np.array([0, 1])</span>
<span class="go">    n=1</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    print(S.cod_X)</span>
<span class="go">    print(S.cod_y)</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S.optimize_model()</span>
<span class="go">    S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.build_Psi()</span>
<span class="go">    print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="go">    S.build_U()</span>
<span class="go">    print(f&quot;S.U:{S.U}&quot;)</span>
<span class="go">    S.likelihood()</span>
<span class="go">    S.negLnLike</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fun_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_theta_p_Lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute log likelihood for a set of hyperparameters (theta, p, Lambda).</span>

<span class="sd">    This method computes the log likelihood for a set of hyperparameters</span>
<span class="sd">    (theta, p, Lambda) by performing the following steps:</span>
<span class="sd">    1. Extracts the hyperparameters from the input array using `extract_from_bounds()`.</span>
<span class="sd">    2. Checks if any element in `10^theta` is equal to 0. If so, logs a warning and</span>
<span class="sd">    returns the penalty value (`pen_val`).</span>
<span class="sd">    3. Builds the `Psi` matrix using `build_Psi()`.</span>
<span class="sd">    4. Checks if `Psi` is ill-conditioned or infinite. If so, logs a warning and returns</span>
<span class="sd">    the penalty value (`pen_val`).</span>
<span class="sd">    5. Builds the `U` matrix using `build_U()`. If an exception occurs, logs an error and</span>
<span class="sd">    returns the penalty value (`pen_val`).</span>
<span class="sd">    6. Computes the negative log likelihood using `likelihood()`.</span>
<span class="sd">    7. Returns the computed negative log likelihood (`negLnLike`).</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        new_theta_p_Lambda (np.ndarray):</span>
<span class="sd">            An array containing the `theta`, `p`, and `Lambda` values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float:</span>
<span class="sd">            The negative log likelihood of the surface at the specified hyperparameters.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        theta (np.ndarray): Kriging theta values. Shape (k,).</span>
<span class="sd">        p (np.ndarray): Kriging p values. Shape (k,).</span>
<span class="sd">        Lambda (float): lambda noise value.</span>
<span class="sd">        Psi (np.matrix): Correlation matrix Psi. Shape (n,n).</span>
<span class="sd">        U (np.matrix): Kriging U matrix, Cholesky decomposition. Shape (n,n).</span>
<span class="sd">        negLnLike (float): Negative log likelihood of the surface at the specified hyperparameters.</span>
<span class="sd">        pen_val (float): Penalty value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[0], [1]])</span>
<span class="sd">            nat_y = np.array([0, 1])</span>
<span class="sd">            n=1</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            print(S.cod_X)</span>
<span class="sd">            print(S.cod_y)</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">            S.extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.build_Psi()</span>
<span class="sd">            print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">            S.build_U()</span>
<span class="sd">            print(f&quot;S.U:{S.U}&quot;)</span>
<span class="sd">            S.likelihood()</span>
<span class="sd">            S.negLnLike</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extract_from_bounds</span><span class="p">(</span><span class="n">new_theta_p_Lambda</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_any__</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failure in fun_likelihood: 10^theta == 0. Setting negLnLike to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">&gt;</span> <span class="mf">1e9</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failure in fun_likelihood: Psi is ill conditioned: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Setting negLnLike to: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_U</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">penalty_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in fun_likelihood(). Call to build_U() failed.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error=</span><span class="si">%s</span><span class="s2">, type(error)=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting negLnLike to </span><span class="si">%.2f</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">penalty_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.initialize_matrices" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_matrices</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.initialize_matrices" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the matrices for the class instance.</p>
<p>This method initializes several matrices and attributes for the class instance.
The <code>p</code> attribute is initialized as a list of ones with length <code>n_p</code>, multiplied by 2.0.
The <code>pen_val</code> attribute is initialized as the natural logarithm of the
variance of <code>nat_y</code>, multiplied by <code>n</code>, plus 1e4.
The <code>negLnLike</code>, <code>LnDetPsi</code>, <code>mu</code>, <code>U</code>, <code>SigmaSqr</code>, and <code>Lambda</code> attributes are all set to None.
The <code>gen</code> attribute is initialized using the <code>spacefilling</code> function with arguments <code>k</code> and <code>seed</code>.
The <code>Psi</code> attribute is initialized as a zero matrix with shape <code>(n, n)</code> and dtype <code>float64</code>.
The <code>psi</code> attribute is initialized as a zero matrix with shape <code>(n, 1)</code>.
The <code>one</code> attribute is initialized as a list of ones with length <code>n</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    from numpy import log, var</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4], [5, 6]])</span>
<span class="go">    nat_y = np.array([1, 2, 3])</span>
<span class="go">    n=3</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    # if var(self.nat_y) is &gt; 0, then self.pen_val = self.n * log(var(self.nat_y)) + 1e4</span>
<span class="go">    # else self.pen_val = self.n * var(self.nat_y) + 1e4</span>
<span class="go">    assert S.pen_val == nat_X.shape[0] * log(var(S.nat_y)) + 1e4</span>
<span class="go">    assert S.Psi.shape == (n, n)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the matrices for the class instance.</span>

<span class="sd">    This method initializes several matrices and attributes for the class instance.</span>
<span class="sd">    The `p` attribute is initialized as a list of ones with length `n_p`, multiplied by 2.0.</span>
<span class="sd">    The `pen_val` attribute is initialized as the natural logarithm of the</span>
<span class="sd">    variance of `nat_y`, multiplied by `n`, plus 1e4.</span>
<span class="sd">    The `negLnLike`, `LnDetPsi`, `mu`, `U`, `SigmaSqr`, and `Lambda` attributes are all set to None.</span>
<span class="sd">    The `gen` attribute is initialized using the `spacefilling` function with arguments `k` and `seed`.</span>
<span class="sd">    The `Psi` attribute is initialized as a zero matrix with shape `(n, n)` and dtype `float64`.</span>
<span class="sd">    The `psi` attribute is initialized as a zero matrix with shape `(n, 1)`.</span>
<span class="sd">    The `one` attribute is initialized as a list of ones with length `n`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            from numpy import log, var</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4], [5, 6]])</span>
<span class="sd">            nat_y = np.array([1, 2, 3])</span>
<span class="sd">            n=3</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            # if var(self.nat_y) is &gt; 0, then self.pen_val = self.n * log(var(self.nat_y)) + 1e4</span>
<span class="sd">            # else self.pen_val = self.n * var(self.nat_y) + 1e4</span>
<span class="sd">            assert S.pen_val == nat_X.shape[0] * log(var(S.nat_y)) + 1e4</span>
<span class="sd">            assert S.Psi.shape == (n, n)</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.n_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
    <span class="c1"># if var(self.nat_y) is &gt; 0, then self.pen_val = self.n * log(var(self.nat_y)) + 1e4</span>
    <span class="c1"># else self.pen_val = self.n * var(self.nat_y) + 1e4</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): var(self.nat_y): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e4</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e4</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.pen_val: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen_val</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.seed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="n">spacefilling</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.gen: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.Psi: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psi</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.psi: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">one</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_matrices(): self.one: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.initialize_variables" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_variables</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.initialize_variables" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize variables for the class instance.</p>
<p>This method takes in the independent and dependent variable data as input
and initializes the class instance variables.
It creates deep copies of the input data and stores them in the
instance variables <code>nat_X</code> and <code>nat_y</code>.
It also calculates the number of observations <code>n</code> and
the number of independent variables <code>k</code> from the shape of <code>nat_X</code>.
Finally, it creates empty arrays with the same shape as <code>nat_X</code>
and <code>nat_y</code> and stores them in the instance variables <code>cod_X</code> and <code>cod_y</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nat_X</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The independent variable data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nat_y</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dependent variable data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    S = Kriging()</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    print(f&quot;S.nat_X: {S.nat_X}&quot;)</span>
<span class="go">    print(f&quot;S.nat_y: {S.nat_y}&quot;)</span>
<span class="go">    S.nat_X: [[1 2]</span>
<span class="go">              [3 4]]</span>
<span class="go">    S.nat_y: [1 2]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">nat_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize variables for the class instance.</span>

<span class="sd">    This method takes in the independent and dependent variable data as input</span>
<span class="sd">    and initializes the class instance variables.</span>
<span class="sd">    It creates deep copies of the input data and stores them in the</span>
<span class="sd">    instance variables `nat_X` and `nat_y`.</span>
<span class="sd">    It also calculates the number of observations `n` and</span>
<span class="sd">    the number of independent variables `k` from the shape of `nat_X`.</span>
<span class="sd">    Finally, it creates empty arrays with the same shape as `nat_X`</span>
<span class="sd">    and `nat_y` and stores them in the instance variables `cod_X` and `cod_y`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        nat_X (np.ndarray): The independent variable data.</span>
<span class="sd">        nat_y (np.ndarray): The dependent variable data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            S = Kriging()</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            print(f&quot;S.nat_X: {S.nat_X}&quot;)</span>
<span class="sd">            print(f&quot;S.nat_y: {S.nat_y}&quot;)</span>
<span class="sd">            S.nat_X: [[1 2]</span>
<span class="sd">                      [3 4]]</span>
<span class="sd">            S.nat_y: [1 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nat_X</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nat_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">aggregate_mean_var</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
    <span class="c1"># aggregated y values:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.nat_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.nat_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.aggregated_mean_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregated_mean_y</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.min_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.max_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In initialize_variables(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.likelihood" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">likelihood</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.likelihood" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates the negative of the concentrated log-likelihood.</p>
<p>This method implements equation (2.32) in [Forr08a] to calculate
the negative of the concentrated log-likelihood. It also modifies <code>mu</code>,
<code>SigmaSqr</code>, <code>LnDetPsi</code>, and <code>negLnLike</code>.</p>

<details class="note" open>
  <summary>Note</summary>
  <p><code>build_Psi</code> and <code>build_U</code> should be called first.</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.likelihood.mu">mu</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kriging expected mean value mu.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.likelihood.SigmaSqr">SigmaSqr</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sigma squared value.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.likelihood.LnDetPsi">LnDetPsi</span></code></td>
          <td>
                <code><span title="numpy.float64">float64</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determinant Psi matrix.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="spotPython.build.kriging.Kriging.likelihood.negLnLike">negLnLike</span></code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Negative log likelihood of the surface at the specified hyperparameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[1], [2]])</span>
<span class="go">    nat_y = np.array([5, 10])</span>
<span class="go">    n=2</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False, theta_init_zero=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.build_Psi()</span>
<span class="go">    S.build_U()</span>
<span class="go">    S.likelihood()</span>
<span class="go">    # assert S.mu is close to 7.5 with a tolerance of 1e-6</span>
<span class="go">    assert np.allclose(S.mu, 7.5, atol=1e-6)</span>
<span class="go">    E = np.exp(1)</span>
<span class="go">    sigma2 = E/(E**2 -1) * (25/4 + 25/4*E)</span>
<span class="go">    # asssert S.SigmaSqr is close to sigma2 with a tolerance of 1e-6</span>
<span class="go">    assert np.allclose(S.SigmaSqr, sigma2, atol=1e-6)</span>
<span class="go">    print(f&quot;S.LnDetPsi:{S.LnDetPsi}&quot;)</span>
<span class="go">    print(f&quot;S.self.negLnLike:{S.negLnLike}&quot;)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the negative of the concentrated log-likelihood.</span>

<span class="sd">    This method implements equation (2.32) in [Forr08a] to calculate</span>
<span class="sd">    the negative of the concentrated log-likelihood. It also modifies `mu`,</span>
<span class="sd">    `SigmaSqr`, `LnDetPsi`, and `negLnLike`.</span>

<span class="sd">    Note:</span>
<span class="sd">        `build_Psi` and `build_U` should be called first.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        mu (np.float64): Kriging expected mean value mu.</span>
<span class="sd">        SigmaSqr (np.float64): Sigma squared value.</span>
<span class="sd">        LnDetPsi (np.float64): Determinant Psi matrix.</span>
<span class="sd">        negLnLike (float): Negative log likelihood of the surface at the specified hyperparameters.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[1], [2]])</span>
<span class="sd">            nat_y = np.array([5, 10])</span>
<span class="sd">            n=2</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False, theta_init_zero=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.build_Psi()</span>
<span class="sd">            S.build_U()</span>
<span class="sd">            S.likelihood()</span>
<span class="sd">            # assert S.mu is close to 7.5 with a tolerance of 1e-6</span>
<span class="sd">            assert np.allclose(S.mu, 7.5, atol=1e-6)</span>
<span class="sd">            E = np.exp(1)</span>
<span class="sd">            sigma2 = E/(E**2 -1) * (25/4 + 25/4*E)</span>
<span class="sd">            # asssert S.SigmaSqr is close to sigma2 with a tolerance of 1e-6</span>
<span class="sd">            assert np.allclose(S.SigmaSqr, sigma2, atol=1e-6)</span>
<span class="sd">            print(f&quot;S.LnDetPsi:{S.LnDetPsi}&quot;)</span>
<span class="sd">            print(f&quot;S.self.negLnLike:{S.negLnLike}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># (2.20) in [Forr08a]:</span>
    <span class="n">U_T_inv_one</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="p">)</span>
    <span class="n">U_T_inv_cod_y</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv_cod_y</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv_one</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
    <span class="c1"># (2.31) in [Forr08a]</span>
    <span class="n">cod_y_minus_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">=</span> <span class="n">cod_y_minus_mu</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cod_y_minus_mu</span><span class="p">)))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
    <span class="c1"># (2.32) in [Forr08a]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">))))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LnDetPsi</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.optimize_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">optimize_model</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.optimize_model" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Optimize the model using the specified model_optimizer.</p>
<p>This method uses the specified model_optimizer to optimize the
likelihood function (<code>fun_likelihood</code>) with respect to the model parameters.
The optimization is performed within the bounds specified by the attribute
<code>de_bounds</code>.
The result of the optimization is returned as a list or tuple of optimized parameter values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    n=2</span>
<span class="go">    p=2</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S.optimize_model()</span>
<span class="go">    print(new_theta_p_Lambda)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[float], <span title="typing.Tuple">Tuple</span>[float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>result[&ldquo;x&rdquo;] (Union[List[float], Tuple[float]]):
A list or tuple of optimized parameter values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">optimize_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Optimize the model using the specified model_optimizer.</span>

<span class="sd">    This method uses the specified model_optimizer to optimize the</span>
<span class="sd">    likelihood function (`fun_likelihood`) with respect to the model parameters.</span>
<span class="sd">    The optimization is performed within the bounds specified by the attribute</span>
<span class="sd">    `de_bounds`.</span>
<span class="sd">    The result of the optimization is returned as a list or tuple of optimized parameter values.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            n=2</span>
<span class="sd">            p=2</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">            print(new_theta_p_Lambda)</span>

<span class="sd">    Returns:</span>
<span class="sd">        result[&quot;x&quot;] (Union[List[float], Tuple[float]]):</span>
<span class="sd">            A list or tuple of optimized parameter values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In optimize_model(): self.de_bounds passed to optimizer: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;dual_annealing&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                      <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;differential_evolution&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                      <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
                                      <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span><span class="p">,</span>
                                      <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                      <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
                                      <span class="c1"># maxfun=self.model_fun_evals,</span>
                                      <span class="n">eps</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;shgo&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                      <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;basinhopping&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span>
                                      <span class="n">x0</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_likelihood</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In optimize_model(): result: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;In optimize_model(): returned result[&quot;x&quot;]: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.plot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.plot" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>This function plots 1D and 2D surrogates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>show</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the plots are displayed.
If <code>False</code>, <code>plt.show()</code> should be called outside this function.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This method provides only a basic plot. For more advanced plots,
    use the <code>plot_contour()</code> method of the <code>Spot</code> class.</li>
</ul>
</details>


<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">    from spotPython.fun.objectivefunctions import analytical</span>
<span class="go">    from spotPython.spot import spot</span>
<span class="go">    # 1-dimensional example</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    lower = np.array([-1])</span>
<span class="go">    upper = np.array([1])</span>
<span class="go">    design_control={&quot;init_size&quot;: 10}</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                noise=False,</span>
<span class="go">                lower = lower,</span>
<span class="go">                upper= upper,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.initialize_design()</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.surrogate.plot()</span>
<span class="go">    # 2-dimensional example</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    lower = np.array([-1, -1])</span>
<span class="go">    upper = np.array([1, 1])</span>
<span class="go">    design_control={&quot;init_size&quot;: 10}</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                noise=False,</span>
<span class="go">                lower = lower,</span>
<span class="go">                upper= upper,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.initialize_design()</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.surrogate.plot()</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots 1D and 2D surrogates.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        show (bool):</span>
<span class="sd">            If `True`, the plots are displayed.</span>
<span class="sd">            If `False`, `plt.show()` should be called outside this function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Note:</span>
<span class="sd">        * This method provides only a basic plot. For more advanced plots,</span>
<span class="sd">            use the `plot_contour()` method of the `Spot` class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotPython.fun.objectivefunctions import analytical</span>
<span class="sd">            from spotPython.spot import spot</span>
<span class="sd">            # 1-dimensional example</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            lower = np.array([-1])</span>
<span class="sd">            upper = np.array([1])</span>
<span class="sd">            design_control={&quot;init_size&quot;: 10}</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        noise=False,</span>
<span class="sd">                        lower = lower,</span>
<span class="sd">                        upper= upper,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.initialize_design()</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.surrogate.plot()</span>
<span class="sd">            # 2-dimensional example</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            lower = np.array([-1, -1])</span>
<span class="sd">            upper = np.array([1, 1])</span>
<span class="sd">            design_control={&quot;init_size&quot;: 10}</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        noise=False,</span>
<span class="sd">                        lower = lower,</span>
<span class="sd">                        upper= upper,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.initialize_design()</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.surrogate.plot()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># TODO: Improve plot (add conf. interval etc.)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
        <span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
        <span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span>
        <span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="c1"># Predict based on the optimized results</span>
        <span class="n">zz</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span> <span class="n">return_val</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">ravel</span><span class="p">(</span><span class="n">Y</span><span class="p">))]</span>
        <span class="p">)</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="n">zz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">zse</span> <span class="o">=</span> <span class="n">zz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">Ze</span> <span class="o">=</span> <span class="n">zse</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">nat_point_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">nat_point_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">contour_levels</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
        <span class="c1"># plot predicted values:</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="n">contour_levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="c1"># plot observed points:</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nat_point_X</span><span class="p">,</span> <span class="n">nat_point_Y</span><span class="p">,</span> <span class="s2">&quot;ow&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
        <span class="c1"># plot predicted values:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">contour_levels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Surrogate&quot;</span><span class="p">)</span>
        <span class="c1"># plot observed points:</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nat_point_X</span><span class="p">,</span> <span class="n">nat_point_Y</span><span class="p">,</span> <span class="s2">&quot;ow&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.predict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">return_val</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.predict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>This function returns the prediction (in natural units) of the surrogate at the natural coordinates of X.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nat_X</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Design variable to evaluate in natural units.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_val</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether <code>y</code>, <code>s</code>, neg. <code>ei</code> (negative expected improvement),
or all three values are returned.
Default is (for compatibility with sklearn) &ldquo;y&rdquo;. To return <code>s</code>, select &ldquo;s&rdquo;,
to return neg. <code>ei</code>, select &ldquo;ei&rdquo;.
To return the tuple <code>(y, s, ei)</code>, select &ldquo;all&rdquo;.</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>float</code></td>          <td>
                <code><span title="typing.Union">Union</span>[float, <span title="typing.Tuple">Tuple</span>[float, float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The predicted value in natural units if return_val is &ldquo;y&rdquo;.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>float</code></td>          <td>
                <code><span title="typing.Union">Union</span>[float, <span title="typing.Tuple">Tuple</span>[float, float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>predicted error if return_val is &ldquo;s&rdquo;.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>float</code></td>          <td>
                <code><span title="typing.Union">Union</span>[float, <span title="typing.Tuple">Tuple</span>[float, float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>expected improvement if return_val is &ldquo;ei&rdquo;.</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code><span title="typing.Union">Union</span>[float, <span title="typing.Tuple">Tuple</span>[float, float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple[float, float, float]:
The predicted value in natural units, predicted error
and expected improvement if return_val is &ldquo;all&rdquo;.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    import matplotlib.pyplot as plt</span>
<span class="go">    from numpy import linspace, arange</span>
<span class="go">    rng = np.random.RandomState(1)</span>
<span class="go">    X = linspace(start=0, stop=10, num=1_0).reshape(-1, 1)</span>
<span class="go">    y = np.squeeze(X * np.sin(X))</span>
<span class="go">    training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="go">    X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="go">    S.fit(X_train, y_train)</span>
<span class="go">    mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="go">    print(f&quot;mean_prediction: {mean_prediction}&quot;)</span>
<span class="go">    print(f&quot;std_prediction: {std_prediction}&quot;)</span>
<span class="go">    print(f&quot;s_ei: {s_ei}&quot;)</span>
<span class="go">    mean_prediction: [-1.41991225e-08  6.48310037e-01  1.76715565e+00 -6.35226564e-01</span>
<span class="go">                      -4.28585379e+00 -1.22301198e+00  2.49434148e+00  5.61900501e-01</span>
<span class="go">                      -3.04558205e+00 -5.44021104e+00]</span>
<span class="go">    std_prediction: [3.69706811e-04 2.07958787e+00 3.69706810e-04 3.69706807e-04</span>
<span class="go">                    3.69706809e-04 2.07958584e+00 3.69706811e-04 2.60615408e+00</span>
<span class="go">                    2.60837033e+00 3.69706811e-04]</span>
<span class="go">    s_ei: [-0.00000000e+00 -1.02341235e-03 -0.00000000e+00 -0.00000000e+00</span>
<span class="go">           -0.00000000e+00 -1.63799181e-02 -0.00000000e+00 -9.45766290e-03</span>
<span class="go">           -2.53405666e-01 -1.47459347e-04]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nat_X</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">return_val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span>
                                                                  <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns the prediction (in natural units) of the surrogate at the natural coordinates of X.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        nat_X (ndarray):</span>
<span class="sd">            Design variable to evaluate in natural units.</span>
<span class="sd">        return_val (str):</span>
<span class="sd">            whether `y`, `s`, neg. `ei` (negative expected improvement),</span>
<span class="sd">            or all three values are returned.</span>
<span class="sd">            Default is (for compatibility with sklearn) &quot;y&quot;. To return `s`, select &quot;s&quot;,</span>
<span class="sd">            to return neg. `ei`, select &quot;ei&quot;.</span>
<span class="sd">            To return the tuple `(y, s, ei)`, select &quot;all&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float:</span>
<span class="sd">            The predicted value in natural units if return_val is &quot;y&quot;.</span>
<span class="sd">        float:</span>
<span class="sd">            predicted error if return_val is &quot;s&quot;.</span>
<span class="sd">        float:</span>
<span class="sd">            expected improvement if return_val is &quot;ei&quot;.</span>
<span class="sd">        Tuple[float, float, float]:</span>
<span class="sd">            The predicted value in natural units, predicted error</span>
<span class="sd">            and expected improvement if return_val is &quot;all&quot;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            import matplotlib.pyplot as plt</span>
<span class="sd">            from numpy import linspace, arange</span>
<span class="sd">            rng = np.random.RandomState(1)</span>
<span class="sd">            X = linspace(start=0, stop=10, num=1_0).reshape(-1, 1)</span>
<span class="sd">            y = np.squeeze(X * np.sin(X))</span>
<span class="sd">            training_indices = rng.choice(arange(y.size), size=6, replace=False)</span>
<span class="sd">            X_train, y_train = X[training_indices], y[training_indices]</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">            S.fit(X_train, y_train)</span>
<span class="sd">            mean_prediction, std_prediction, s_ei = S.predict(X, return_val=&quot;all&quot;)</span>
<span class="sd">            print(f&quot;mean_prediction: {mean_prediction}&quot;)</span>
<span class="sd">            print(f&quot;std_prediction: {std_prediction}&quot;)</span>
<span class="sd">            print(f&quot;s_ei: {s_ei}&quot;)</span>
<span class="sd">            mean_prediction: [-1.41991225e-08  6.48310037e-01  1.76715565e+00 -6.35226564e-01</span>
<span class="sd">                              -4.28585379e+00 -1.22301198e+00  2.49434148e+00  5.61900501e-01</span>
<span class="sd">                              -3.04558205e+00 -5.44021104e+00]</span>
<span class="sd">            std_prediction: [3.69706811e-04 2.07958787e+00 3.69706810e-04 3.69706807e-04</span>
<span class="sd">                            3.69706809e-04 2.07958584e+00 3.69706811e-04 2.60615408e+00</span>
<span class="sd">                            2.60837033e+00 3.69706811e-04]</span>
<span class="sd">            s_ei: [-0.00000000e+00 -1.02341235e-03 -0.00000000e+00 -0.00000000e+00</span>
<span class="sd">                   -0.00000000e+00 -1.63799181e-02 -0.00000000e+00 -9.45766290e-03</span>
<span class="sd">                   -2.53405666e-01 -1.47459347e-04]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for the shape and the type of the Input</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nat_X</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">nat_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;13.1: Input to predict was not convertible to the size of X&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type of the given input is an </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">nat_X</span><span class="p">)</span><span class="si">}</span><span class="s2"> instead of an ndarray&quot;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">ei</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ei</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_coded</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span>
    <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;ei&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">ei</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">ei</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.predict_coded" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict_coded</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.predict_coded" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Kriging prediction of one point in the coded units as described in (2.20) in [Forr08a].
The error is returned as well.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cod_x</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Point in coded units to make prediction at.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>f</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Predicted value in coded units.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>SSqr</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Predicted error.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>EI</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Expected improvement.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p><code>self.mu</code> and <code>self.SigmaSqr</code> are computed in <code>likelihood</code>, not here.
See also [Forr08a, p.60].</p>
</details>
          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_coded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kriging prediction of one point in the coded units as described in (2.20) in [Forr08a].</span>
<span class="sd">    The error is returned as well.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        cod_x (np.ndarray):</span>
<span class="sd">            Point in coded units to make prediction at.</span>

<span class="sd">    Returns:</span>
<span class="sd">        f (float): Predicted value in coded units.</span>
<span class="sd">        SSqr (float): Predicted error.</span>
<span class="sd">        EI (float): Expected improvement.</span>

<span class="sd">    Note:</span>
<span class="sd">        `self.mu` and `self.SigmaSqr` are computed in `likelihood`, not here.</span>
<span class="sd">        See also [Forr08a, p.60].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_psi_vec</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span>
    <span class="n">U_T_inv</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">U_T_inv</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Error in [Forr08a, p.87]:</span>
    <span class="n">SSqr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SigmaSqr</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Lambda</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">))))</span>
    <span class="n">SSqr</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">SSqr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">EI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_imp</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s0</span><span class="o">=</span><span class="n">SSqr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SSqr</span><span class="p">,</span> <span class="n">EI</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.set_de_bounds" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_de_bounds</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.set_de_bounds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determine search bounds for model_optimizer, e.g., differential evolution.</p>
<p>This method sets the attribute <code>de_bounds</code> of the object to a list of lists,
where each inner list represents the lower and upper bounds for a parameter
being optimized. The number of inner lists is determined by the number of
parameters being optimized (<code>n_theta</code> and <code>n_p</code>), as well as whether noise is
being considered (<code>noise</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    print(S.de_bounds)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_de_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine search bounds for model_optimizer, e.g., differential evolution.</span>

<span class="sd">    This method sets the attribute `de_bounds` of the object to a list of lists,</span>
<span class="sd">    where each inner list represents the lower and upper bounds for a parameter</span>
<span class="sd">    being optimized. The number of inner lists is determined by the number of</span>
<span class="sd">    parameters being optimized (`n_theta` and `n_p`), as well as whether noise is</span>
<span class="sd">    being considered (`noise`).</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;, seed=124)</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            print(S.de_bounds)</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.optim_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.n_p: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.noise: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.min_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.max_Lambda: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">)</span>

    <span class="n">de_bounds</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
        <span class="n">de_bounds</span> <span class="o">+=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_bounds</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_de_bounds(): self.de_bounds: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.set_theta_values" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_theta_values</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.set_theta_values" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set the theta values for the class instance.</p>
<p>This method sets the theta values for the class instance based
on the <code>n_theta</code> and <code>k</code> attributes. If <code>n_theta</code> is greater than
<code>k</code>, <code>n_theta</code> is set to <code>k</code> and a warning is logged.
The method then initializes the <code>theta</code> attribute as a list
of zeros with length <code>n_theta</code>.
The <code>x0_theta</code> attribute is also initialized as a list of ones
with length <code>n_theta</code>, multiplied by <code>n / (100 * k)</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    None</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    from numpy import array</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    n=2</span>
<span class="go">    p=2</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    assert S.theta.all() == array([0., 0.]).all()</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_theta_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the theta values for the class instance.</span>

<span class="sd">    This method sets the theta values for the class instance based</span>
<span class="sd">    on the `n_theta` and `k` attributes. If `n_theta` is greater than</span>
<span class="sd">    `k`, `n_theta` is set to `k` and a warning is logged.</span>
<span class="sd">    The method then initializes the `theta` attribute as a list</span>
<span class="sd">    of zeros with length `n_theta`.</span>
<span class="sd">    The `x0_theta` attribute is also initialized as a list of ones</span>
<span class="sd">    with length `n_theta`, multiplied by `n / (100 * k)`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            from numpy import array</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            n=2</span>
<span class="sd">            p=2</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            assert S.theta.all() == array([0., 0.]).all()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Too few theta values or more theta values than dimensions. `n_theta` set to `k`.&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n_theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.n: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">,))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_theta_values(): self.theta: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.set_variable_types" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_variable_types</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.set_variable_types" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set the variable types for the class instance.</p>
<p>This method sets the variable types for the class instance based
on the <code>var_type</code> attribute. If the length of <code>var_type</code> is less
than <code>k</code>, all variable types are forced to &lsquo;num&rsquo; and a warning is logged.
The method then creates Boolean masks for each variable
type (&lsquo;num&rsquo;, &lsquo;factor&rsquo;, &lsquo;int&rsquo;, &lsquo;ordered&rsquo;) using numpy arrays, e.g.,
<code>num_mask = array([ True,  True])</code> if two numerical variables are present.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    n=2</span>
<span class="go">    p=2</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="go">    assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="go">    assert S.num_mask.all() == True</span>
<span class="go">    assert S.factor_mask.all() == False</span>
<span class="go">    assert S.int_mask.all() == False</span>
<span class="go">    assert S.ordered_mask.all() == True</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_variable_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the variable types for the class instance.</span>

<span class="sd">    This method sets the variable types for the class instance based</span>
<span class="sd">    on the `var_type` attribute. If the length of `var_type` is less</span>
<span class="sd">    than `k`, all variable types are forced to &#39;num&#39; and a warning is logged.</span>
<span class="sd">    The method then creates Boolean masks for each variable</span>
<span class="sd">    type (&#39;num&#39;, &#39;factor&#39;, &#39;int&#39;, &#39;ordered&#39;) using numpy arrays, e.g.,</span>
<span class="sd">    `num_mask = array([ True,  True])` if two numerical variables are present.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            n=2</span>
<span class="sd">            p=2</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="sd">            assert S.var_type == [&#39;num&#39;, &#39;num&#39;]</span>
<span class="sd">            assert S.num_mask.all() == True</span>
<span class="sd">            assert S.factor_mask.all() == False</span>
<span class="sd">            assert S.int_mask.all() == False</span>
<span class="sd">            assert S.ordered_mask.all() == True</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.k: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.var_type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
    <span class="c1"># assume all variable types are &quot;num&quot; if &quot;num&quot; is</span>
    <span class="c1"># specified once:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): All variable types forced to &#39;num&#39;.&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.var_type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">int_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;num&quot;</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.num_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_mask</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.factor_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.int_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_mask</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In set_variable_types(): self.ordered_mask: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.update_log" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_log</span><span class="p">()</span></code>

<a href="#spotPython.build.kriging.Kriging.update_log" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update the log with the current values of negLnLike, theta, p, and Lambda.</p>
<p>This method appends the current values of negLnLike, theta, p (if optim_p is True),
and Lambda (if noise is True)
to their respective lists in the log dictionary.
It also updates the log_length attribute with the current length
of the negLnLike list in the log.</p>
<p>If spot_writer is not None, this method also writes the current values of
negLnLike, theta, p (if optim_p is True),
and Lambda (if noise is True) to the spot_writer object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotPython.build.kriging</span> <span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="go">    nat_y = np.array([1, 2])</span>
<span class="go">    n=2</span>
<span class="go">    p=2</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="go">    S.initialize_variables(nat_X, nat_y)</span>
<span class="go">    S.set_variable_types()</span>
<span class="go">    S.set_theta_values()</span>
<span class="go">    S.initialize_matrices()</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S.optimize_model()</span>
<span class="go">    S.update_log()</span>
<span class="go">    print(S.log)</span>
<span class="go">    {&#39;negLnLike&#39;: array([-1.38629436]),</span>
<span class="go">     &#39;theta&#39;: array([-1.14525993,  1.6123372 ]),</span>
<span class="go">      &#39;p&#39;: array([1.84444406, 1.74590865]),</span>
<span class="go">      &#39;Lambda&#39;: array([0.44268472])}</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the log with the current values of negLnLike, theta, p, and Lambda.</span>

<span class="sd">    This method appends the current values of negLnLike, theta, p (if optim_p is True),</span>
<span class="sd">    and Lambda (if noise is True)</span>
<span class="sd">    to their respective lists in the log dictionary.</span>
<span class="sd">    It also updates the log_length attribute with the current length</span>
<span class="sd">    of the negLnLike list in the log.</span>

<span class="sd">    If spot_writer is not None, this method also writes the current values of</span>
<span class="sd">    negLnLike, theta, p (if optim_p is True),</span>
<span class="sd">    and Lambda (if noise is True) to the spot_writer object.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotPython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[1, 2], [3, 4]])</span>
<span class="sd">            nat_y = np.array([1, 2])</span>
<span class="sd">            n=2</span>
<span class="sd">            p=2</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=True)</span>
<span class="sd">            S.initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S.set_variable_types()</span>
<span class="sd">            S.set_theta_values()</span>
<span class="sd">            S.initialize_matrices()</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S.optimize_model()</span>
<span class="sd">            S.update_log()</span>
<span class="sd">            print(S.log)</span>
<span class="sd">            {&#39;negLnLike&#39;: array([-1.38629436]),</span>
<span class="sd">             &#39;theta&#39;: array([-1.14525993,  1.6123372 ]),</span>
<span class="sd">              &#39;p&#39;: array([1.84444406, 1.74590865]),</span>
<span class="sd">              &#39;Lambda&#39;: array([0.44268472])}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
    <span class="c1"># get the length of the log</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span>
        <span class="n">negLnLike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_negLnLike&quot;</span><span class="p">,</span> <span class="n">negLnLike</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
        <span class="c1"># add the self.n_theta theta values to the writer with one key &quot;theta&quot;,</span>
        <span class="c1"># i.e, the same key for all theta values</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_theta&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;theta_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)},</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_Lambda&quot;</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_p&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="spotPython.build.kriging.Kriging.weighted_exp_imp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">weighted_exp_imp</span><span class="p">(</span><span class="n">cod_x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span></code>

<a href="#spotPython.build.kriging.Kriging.weighted_exp_imp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Weighted expected improvement.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kriging object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cod_x</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A coded design vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>w</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>EI</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weighted expected improvement.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="references" open>
  <summary>References</summary>
  <p>[Sobester et al. 2005].</p>
</details>
          <details class="quote">
            <summary>Source code in <code>spotPython/build/kriging.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">weighted_exp_imp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cod_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Weighted expected improvement.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): The Kriging object.</span>
<span class="sd">        cod_x (np.ndarray): A coded design vector.</span>
<span class="sd">        w (float): Weight.</span>

<span class="sd">    Returns:</span>
<span class="sd">        EI (float): Weighted expected improvement.</span>

<span class="sd">    References:</span>
<span class="sd">        [Sobester et al. 2005].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y0</span><span class="p">,</span> <span class="n">s0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_coded</span><span class="p">(</span><span class="n">cod_x</span><span class="p">)</span>
    <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nat_y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s0</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_min_y0</span> <span class="o">=</span> <span class="n">y_min</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="n">EI_one</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">y_min_y0</span>
                <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_min_y0</span> <span class="o">/</span> <span class="n">s0</span><span class="p">)))</span>
        <span class="p">)</span>
        <span class="n">EI_two</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">s0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)))</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_min_y0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">s0</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)))</span>
        <span class="p">)</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="n">EI_one</span> <span class="o">+</span> <span class="n">EI_two</span>
    <span class="k">return</span> <span class="n">EI</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2004 - 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bartzbeielstein" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomas-bartz-beielstein-3157b541/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>