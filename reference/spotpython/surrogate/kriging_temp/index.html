
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="spotpython - Sequential Parameter Optimization Toolbox in Python">
      
      
      
        <link rel="canonical" href="https://github.com/sequential-parameter-optimization/spotpython/reference/spotpython/surrogate/kriging_temp/">
      
      
        <link rel="prev" href="../kriging_ny/">
      
      
        <link rel="next" href="../plot/">
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>kriging_temp - spotpython</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotpython.surrogate.kriging_temp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotpython" class="md-header__button md-logo" aria-label="spotpython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotpython
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              kriging_temp
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotpython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../budget/ocba/" class="md-tabs__link">
          
  
  
    
  
  Code Reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-tabs__link">
        
  
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../download/" class="md-tabs__link">
        
  
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotpython" class="md-nav__button md-logo" aria-label="spotpython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotpython
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotpython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    spotpython
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            spotpython
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    budget
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            budget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../budget/ocba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ocba
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    build
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/kriging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/surrogates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    surrogates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/california/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    california
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/california_housing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    california_housing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/csvdataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    csvdataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/diabetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    diabetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/friedman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    friedman
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightcrossvalidationdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lightcrossvalidationdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lightdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/manydataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    manydataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/mnistdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mnistdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/pkldataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pkldataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/torchdata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchdata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/vbdp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vbdp
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/clustered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    clustered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/designs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    designs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/factorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    factorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    grid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/poor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    poor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/random/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    random
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/sobol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sobol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/spacefilling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spacefilling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    fun
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            fun
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypersklearn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hypersklearn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypertorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hypertorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/mohyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mohyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/multiobjectivefunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multiobjectivefunctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/objectivefunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    objectivefunctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/xai_hyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xai_hyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    gp
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            gp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/covar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    covar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/distances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    distances
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/gp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/gp_sep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gp_sep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/likelihood/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    likelihood
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/linalg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linalg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/lite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/util/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hyperdict
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            hyperdict
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/light_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    light_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/sklearn_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sklearn_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/torch_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torch_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hyperparameters
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            hyperparameters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/categorical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    categorical
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/listgenerator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    listgenerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    values
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9" id="__nav_2_1_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    light
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9">
            <span class="md-nav__icon md-icon"></span>
            light
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_1" id="__nav_2_1_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    classification
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_1">
            <span class="md-nav__icon md-icon"></span>
            classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/classification/netlightbasemapk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netlightbasemapk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/classification/nn_funnel_classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_funnel_classifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_2" id="__nav_2_1_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_2">
            <span class="md-nav__icon md-icon"></span>
            cnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/googlenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    googlenet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/inceptionblock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    inceptionblock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/netcnnbase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcnnbase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cvmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cvmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/litmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    litmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/loadmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    loadmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/predictmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    predictmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_7" id="__nav_2_1_9_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    regression
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            regression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/netlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_condnet_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_condnet_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_funnel_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_funnel_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_linear_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_linear_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_gru_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_gru_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_lstm_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_lstm_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_rnn_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_rnn_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_resnet_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_resnet_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_transformer_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_transformer_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/pos_enc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pos_enc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/rnnlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rnnlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/transformerlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transformerlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/testmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    testmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/trainmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trainmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_10" id="__nav_2_1_9_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    transformer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_10">
            <span class="md-nav__icon md-icon"></span>
            transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    encoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoderblock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    encoderblock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/multiheadattention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multiheadattention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    positionalEncoding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncodingBasic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    positionalEncodingBasic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/skiplinear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    skiplinear
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/transformerlightpredictor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transformerlightpredictor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_10" id="__nav_2_1_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    mo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_10">
            <span class="md-nav__icon md-icon"></span>
            mo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/pareto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pareto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11" id="__nav_2_1_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pinns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11">
            <span class="md-nav__icon md-icon"></span>
            pinns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11_1" id="__nav_2_1_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    nn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11_1">
            <span class="md-nav__icon md-icon"></span>
            nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/nn/fcn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fcn
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11_2" id="__nav_2_1_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11_2">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/plot/result/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    result
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    solvers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_12" >
        
          
          <label class="md-nav__link" for="__nav_2_1_12" id="__nav_2_1_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_12">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/contour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    contour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/importance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/ts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/xai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xai
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/xy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" >
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    sklearn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/traintest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traintest
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_14" >
        
          
          <label class="md-nav__link" for="__nav_2_1_14" id="__nav_2_1_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    spot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_14">
            <span class="md-nav__icon md-icon"></span>
            spot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spot/spot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_15" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_15" id="__nav_2_1_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    surrogate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_15">
            <span class="md-nav__icon md-icon"></span>
            surrogate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_15_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_15_1" id="__nav_2_1_15_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_15_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_15_1">
            <span class="md-nav__icon md-icon"></span>
            functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/forr08a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    forr08a
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kriging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kriging_0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging_0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kriging_ny/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging_ny
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    kriging_temp
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    kriging_temp
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp" class="md-nav__link">
    <span class="md-ellipsis">
      kriging_temp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging" class="md-nav__link">
    <span class="md-ellipsis">
      Kriging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kriging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.build_Psi" class="md-nav__link">
    <span class="md-ellipsis">
      build_Psi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.build_psi_vec" class="md-nav__link">
    <span class="md-ellipsis">
      build_psi_vec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.get_model_params" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.max_likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      max_likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_16" >
        
          
          <label class="md-nav__link" for="__nav_2_1_16" id="__nav_2_1_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    torch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_16">
            <span class="md-nav__icon md-icon"></span>
            torch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/activation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    activation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/cosinewarmupcheduler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cosinewarmupcheduler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/dataframedataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dataframedataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/dimensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dimensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/mapk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mapk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcifar10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcifar10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netfashionMNIST/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netfashionMNIST
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netvbdp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netvbdp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/traintest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traintest
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_17" >
        
          
          <label class="md-nav__link" for="__nav_2_1_17" id="__nav_2_1_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    uc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_17">
            <span class="md-nav__icon md-icon"></span>
            uc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../uc/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_18" >
        
          
          <label class="md-nav__link" for="__nav_2_1_18" id="__nav_2_1_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_18">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/aggregate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aggregate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/compare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    compare
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/convert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    convert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/device/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    device
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    effects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/linalg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linalg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/numpy2json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    numpy2json
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optimize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    parallel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/pca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pca
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/preprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    preprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/progress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    progress
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/repair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    repair
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/scaler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scaler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/seed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    seed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/split/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    split
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/stats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/tensorboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tensorboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transform
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp" class="md-nav__link">
    <span class="md-ellipsis">
      kriging_temp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging" class="md-nav__link">
    <span class="md-ellipsis">
      Kriging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kriging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.build_Psi" class="md-nav__link">
    <span class="md-ellipsis">
      build_Psi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.build_psi_vec" class="md-nav__link">
    <span class="md-ellipsis">
      build_psi_vec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.get_model_params" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.max_likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      max_likelihood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.surrogate.kriging_temp.Kriging.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>kriging_temp</h1>

<div class="doc doc-object doc-module">



<a id="spotpython.surrogate.kriging_temp"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="spotpython.surrogate.kriging_temp.Kriging" class="doc doc-heading">
            <code>Kriging</code>


<a href="#spotpython.surrogate.kriging_temp.Kriging" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code>, <code><span title="sklearn.base.RegressorMixin">RegressorMixin</span></code></p>


        <p>A scikit-learn compatible Kriging model class for regression tasks.
Provides methods for likelihood evaluation, predictions, and hyperparameter optimization.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.eps">eps</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A small regularization term to reduce ill-conditioning.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.penalty">penalty</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The penalty value used if the correlation matrix is ill-conditioned.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.logtheta_lambda_">logtheta_lambda_</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Best-fit log(theta) parameters from fit().</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.U_">U_</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Cholesky factor of the correlation matrix after fit().</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.X_">X_</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The training input data (n x d).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.y_">y_</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The training target values (n,).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.negLnLike">negLnLike</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The negative log-likelihood of the model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.Psi_">Psi_</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The correlation matrix after fit().</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.method">method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fitting method used, can be &ldquo;interpolation&rdquo;, &ldquo;regression&rdquo;, or &ldquo;reinterpolation&rdquo;.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.isotropic">isotropic</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the model is isotropic or not.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.approximation">approximation</span></code></td>
            <td>
                  <code><span title="str">str</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximation method used, e.g., &ldquo;nystroem&rdquo; or None. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.surrogate.kriging_temp.Kriging.n_components_nystroem">n_components_nystroem</span></code></td>
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of components for Nystrm approximation. Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__init__(eps=None, penalty=10000.0, method='regression', noise=False, var_type=['num'], name='Kriging', seed=124, model_optimizer=None, model_fun_evals=None, min_theta=-3.0, max_theta=2.0, theta_init_zero=False, p_val=2.0, n_p=1, optim_p=False, min_p=1.0, max_p=2.0, min_Lambda=-9.0, max_Lambda=0.0, log_level=50, spot_writer=None, counter=None, metric_factorial='canberra', isotropic=False, approximation=None, n_components_nystroem=None, **kwargs) (spotpython.surrogate.kriging_temp.Kriging.__init__)" href="#spotpython.surrogate.kriging_temp.Kriging.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Initializes the Kriging model with hyperparameters.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="spotpython.surrogate.kriging_temp.Kriging._get_eps">_get_eps</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the square root of machine epsilon.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="spotpython.surrogate.kriging_temp.Kriging._set_variable_types">_set_variable_types</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Sets variable types for the model.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_model_params() (spotpython.surrogate.kriging_temp.Kriging.get_model_params)" href="#spotpython.surrogate.kriging_temp.Kriging.get_model_params">get_model_params</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns additional model parameters not included in get_params().</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="spotpython.surrogate.kriging_temp.Kriging._update_log">_update_log</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Updates the log with current model parameters.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="fit(X, y, bounds=None) (spotpython.surrogate.kriging_temp.Kriging.fit)" href="#spotpython.surrogate.kriging_temp.Kriging.fit">fit</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Fits the Kriging model to training data X and y.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="predict(X, return_std=False, return_val='y') (spotpython.surrogate.kriging_temp.Kriging.predict)" href="#spotpython.surrogate.kriging_temp.Kriging.predict">predict</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Predicts the Kriging response at a set of points X.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="build_Psi() (spotpython.surrogate.kriging_temp.Kriging.build_Psi)" href="#spotpython.surrogate.kriging_temp.Kriging.build_Psi">build_Psi</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Constructs a new correlation matrix Psi.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="likelihood(x) (spotpython.surrogate.kriging_temp.Kriging.likelihood)" href="#spotpython.surrogate.kriging_temp.Kriging.likelihood">likelihood</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the negative concentrated log-likelihood and correlation matrix.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="build_psi_vec(x) (spotpython.surrogate.kriging_temp.Kriging.build_psi_vec)" href="#spotpython.surrogate.kriging_temp.Kriging.build_psi_vec">build_psi_vec</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Builds the psi vector for predictive methods.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="spotpython.surrogate.kriging_temp.Kriging._pred">_pred</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes a single-point Kriging prediction.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>








              <details class="quote">
                <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Kriging</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A scikit-learn compatible Kriging model class for regression tasks.</span>
<span class="sd">    Provides methods for likelihood evaluation, predictions, and hyperparameter optimization.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        eps (float): A small regularization term to reduce ill-conditioning.</span>
<span class="sd">        penalty (float): The penalty value used if the correlation matrix is ill-conditioned.</span>
<span class="sd">        logtheta_lambda_ (np.ndarray): Best-fit log(theta) parameters from fit().</span>
<span class="sd">        U_ (np.ndarray): The Cholesky factor of the correlation matrix after fit().</span>
<span class="sd">        X_ (np.ndarray): The training input data (n x d).</span>
<span class="sd">        y_ (np.ndarray): The training target values (n,).</span>
<span class="sd">        negLnLike (float): The negative log-likelihood of the model.</span>
<span class="sd">        Psi_ (np.ndarray): The correlation matrix after fit().</span>
<span class="sd">        method (str): The fitting method used, can be &quot;interpolation&quot;, &quot;regression&quot;, or &quot;reinterpolation&quot;.</span>
<span class="sd">        isotropic (bool): Whether the model is isotropic or not.</span>
<span class="sd">        approximation (str or None): Approximation method used, e.g., &quot;nystroem&quot; or None. Defaults to None.</span>
<span class="sd">        n_components_nystroem (int or None): Number of components for Nystrm approximation. Defaults to None.</span>

<span class="sd">    Methods:</span>
<span class="sd">        __init__: Initializes the Kriging model with hyperparameters.</span>
<span class="sd">        _get_eps: Returns the square root of machine epsilon.</span>
<span class="sd">        _set_variable_types: Sets variable types for the model.</span>
<span class="sd">        get_model_params: Returns additional model parameters not included in get_params().</span>
<span class="sd">        _update_log: Updates the log with current model parameters.</span>
<span class="sd">        fit: Fits the Kriging model to training data X and y.</span>
<span class="sd">        predict: Predicts the Kriging response at a set of points X.</span>
<span class="sd">        build_Psi: Constructs a new correlation matrix Psi.</span>
<span class="sd">        likelihood: Computes the negative concentrated log-likelihood and correlation matrix.</span>
<span class="sd">        build_psi_vec: Builds the psi vector for predictive methods.</span>
<span class="sd">        _pred: Computes a single-point Kriging prediction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">penalty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;regression&quot;</span><span class="p">,</span>
        <span class="n">noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">var_type</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">124</span><span class="p">,</span>
        <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">model_fun_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span>
        <span class="n">max_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">theta_init_zero</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">p_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">n_p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">optim_p</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">min_p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">max_p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">min_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.0</span><span class="p">,</span>
        <span class="n">max_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">metric_factorial</span><span class="o">=</span><span class="s2">&quot;canberra&quot;</span><span class="p">,</span>
        <span class="n">isotropic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">approximation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Default is None</span>
        <span class="n">n_components_nystroem</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Number of components for Nystrm</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the Kriging model.</span>

<span class="sd">        Args:</span>
<span class="sd">            eps (float, optional):</span>
<span class="sd">                Small number added to the diagonal of the correlation matrix to reduce</span>
<span class="sd">                ill-conditioning. Defaults to the square root of machine epsilon.</span>
<span class="sd">                Only used if method is &quot;interpolation&quot;. Otherwise, if method is &quot;regression&quot; or &quot;reinterpolation&quot;, eps is replaced by the</span>
<span class="sd">                lambda_ parameter. Defaults to None.</span>
<span class="sd">            penalty (float, optional):</span>
<span class="sd">                Large negative log-likelihood assigned if the correlation matrix is</span>
<span class="sd">                not positive-definite. Defaults to 1e4.</span>
<span class="sd">            method (str, optional):</span>
<span class="sd">                The type how the model uis fitted. Can be &quot;interpolation&quot;, &quot;regression&quot;, or &quot;reinterpolation&quot;. Defaults to &quot;regression&quot;.</span>
<span class="sd">            isotropic (bool, optional):</span>
<span class="sd">                If True, the model is isotropic, meaning all variables are treated equally (only one theta value is used).</span>
<span class="sd">                If False, the model can handle different theta values, one for each dimension. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_eps</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;eps must be positive&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">penalty</span> <span class="o">=</span> <span class="n">penalty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="n">var_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">log_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="n">spot_writer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span> <span class="o">=</span> <span class="n">metric_factorial</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span> <span class="o">=</span> <span class="n">min_theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span> <span class="o">=</span> <span class="n">max_theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span> <span class="o">=</span> <span class="n">min_Lambda</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span> <span class="o">=</span> <span class="n">max_Lambda</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span> <span class="o">=</span> <span class="n">min_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span> <span class="o">=</span> <span class="n">max_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Will be set in fit() based on self.k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isotropic</span> <span class="o">=</span> <span class="n">isotropic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">=</span> <span class="n">n_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span> <span class="o">=</span> <span class="n">optim_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span> <span class="o">=</span> <span class="n">theta_init_zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">model_optimizer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">differential_evolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="n">model_fun_evals</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Training data for the Kriging model (could be Nystrm features)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psi_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of &#39;interpolation&#39;, &#39;regression&#39;, or &#39;reinterpolation&#39;]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Nystrm specific initializations</span>
        <span class="k">if</span> <span class="n">approximation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">approximation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nystroem&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;approximation must be &#39;nystroem&#39; or None&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">=</span> <span class="n">approximation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">approximation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span> <span class="o">=</span> <span class="n">n_components_nystroem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Stores the actual subset of original X points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Stores U_m @ Sigma_m^{-1/2} from SVD of K_mm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_n_components_actual</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Actual components used after filtering small eigenvalues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># Random number generator for reproducible sampling</span>

        <span class="c1"># Attributes to store original input dimensions and masks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Original number of features (before Nystrm)</span>

        <span class="c1"># Attributes for the Kriging model&#39;s feature space (could be Nystrm transformed)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Current number of features for the Kriging model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type_kriging</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Variable types for the Kriging model&#39;s feature space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_eps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the square root of the machine epsilon.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The square root of the machine epsilon.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_var_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">X_kriging</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes variable types and masks for both original and Kriging feature spaces.</span>

<span class="sd">        This method sets up masks for the original input data (`_orig`) which are</span>
<span class="sd">        used for kernel computations (e.g., in Nystrm). It then sets up masks</span>
<span class="sd">        for the feature space the Kriging model will actually be fitted on (`_kriging`),</span>
<span class="sd">        which might be the original data or transformed features (e.g., from Nystrm).</span>

<span class="sd">        Args:</span>
<span class="sd">            X_orig (np.ndarray): The original input data.</span>
<span class="sd">            X_kriging (np.ndarray): The data the Kriging model will be fitted on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1. Set types and masks for the ORIGINAL feature space</span>
        <span class="n">k_original</span> <span class="o">=</span> <span class="n">X_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">k_original</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">k_original</span>
        <span class="n">var_type_array_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">var_type_array_orig</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span> <span class="o">=</span> <span class="n">var_type_array_orig</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span>

        <span class="c1"># 2. Set types and masks for the KRIGING model&#39;s feature space</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
            <span class="c1"># self.k_kriging = X_kriging.shape[1]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kriging model feature space dimension (self.k_kriging): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Nystrm features are always numerical</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type_kriging</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For standard Kriging, the feature space is the original one</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_model_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the model parameters (in addition to sklearn&#39;s get_params method).</span>

<span class="sd">        This method is NOT required for scikit-learn compatibility.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Parameter names not included in get_params() mapped to their values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;log_theta_lambda&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="s2">&quot;negLnLike&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If spot_writer is not None, this method writes the current values of</span>
<span class="sd">        negLnLike, theta, p (if optim_p is True),</span>
<span class="sd">        and Lambda (if method is not &quot;interpolation&quot;) to the spot_writer object.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): The Kriging object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
        <span class="c1"># get the length of the log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">negLnLike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_negLnLike&quot;</span><span class="p">,</span> <span class="n">negLnLike</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="c1"># add the self.n_theta theta values to the writer with one key &quot;theta&quot;,</span>
            <span class="c1"># i.e, the same key for all theta values</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_theta&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;theta_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">):</span>
                <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_Lambda&quot;</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_p&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_length</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compute_kernel_matrix_for_original_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">X2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">theta10_for_kernel</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the kernel (correlation) matrix between two sets of ORIGINAL features X1 and X2,</span>
<span class="sd">        respecting original variable types (ordered/factor).</span>
<span class="sd">        This helper is specifically for the Nystrm transformation stage.</span>

<span class="sd">        Args:</span>
<span class="sd">            X1 (np.ndarray): First set of input points (n1 x d).</span>
<span class="sd">            X2 (np.ndarray): Second set of input points (n2 x d).</span>
<span class="sd">            theta10_for_kernel (np.ndarray): Theta values for kernel computation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The computed kernel matrix (n1 x n2).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the dimensions of X1 and X2 do not match.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - This method uses the original variable type masks (self.ordered_mask_orig and self.factor_mask_orig)</span>
<span class="sd">              to compute distances appropriately for numerical and categorical variables.</span>
<span class="sd">            - The kernel is computed as exp(-D), where D is the combined distance matrix.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.surrogate.kriging import Kriging</span>
<span class="sd">                model = Kriging()</span>
<span class="sd">                X1 = np.array([[0.5, 1], [1.0, 2]])  # [num, factor]</span>
<span class="sd">                X2 = np.array([[0.6, 1], [1.2, 3]])  # [num, factor]</span>
<span class="sd">                theta = np.array([2.0, 0.5])  # Anisotropic theta</span>
<span class="sd">                model.var_type = [&quot;num&quot;, &quot;factor&quot;]</span>
<span class="sd">                model._initialize_var_types(X1, X2)</span>
<span class="sd">                K = model._compute_kernel_matrix_for_original_features(X1, X2, theta)</span>
<span class="sd">                print(K)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computing kernel matrix for original features with shapes X1: </span><span class="si">{</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, X2: </span><span class="si">{</span><span class="n">X2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Check if n1, n2 are correct:</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">X2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;theta10_for_kernel: </span><span class="si">{</span><span class="n">theta10_for_kernel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X1_ordered</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span><span class="p">]</span>
            <span class="n">X2_ordered</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span><span class="p">]</span>
            <span class="c1"># Ensure theta10_for_kernel has the correct length for ordered variables</span>
            <span class="n">theta10_ordered</span> <span class="o">=</span> <span class="n">theta10_for_kernel</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span><span class="p">]</span> <span class="k">if</span> <span class="n">theta10_for_kernel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">theta10_for_kernel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">X1_ordered</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theta for ordered kernel computation: </span><span class="si">{</span><span class="n">theta10_ordered</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">D_ordered</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X1_ordered</span><span class="p">,</span> <span class="n">X2_ordered</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_ordered</span><span class="p">)</span>
            <span class="n">D</span> <span class="o">+=</span> <span class="n">D_ordered</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X1_factor</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span><span class="p">]</span>
            <span class="n">X2_factor</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span><span class="p">]</span>
            <span class="c1"># Ensure theta10_for_kernel has the correct length for factor variables</span>
            <span class="n">theta10_factor</span> <span class="o">=</span> <span class="n">theta10_for_kernel</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span><span class="p">]</span> <span class="k">if</span> <span class="n">theta10_for_kernel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">theta10_for_kernel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">X1_factor</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theta for factor kernel computation: </span><span class="si">{</span><span class="n">theta10_factor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">D_factor</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X1_factor</span><span class="p">,</span> <span class="n">X2_factor</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_factor</span><span class="p">)</span>
            <span class="n">D</span> <span class="o">+=</span> <span class="n">D_factor</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_nystroem_approximation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the Nystrm transformation to the original data X_orig.</span>
<span class="sd">        Returns success status and transformed (or original) data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_components_nystroem must be between 1 and n_samples (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="si">}</span><span class="s2">), got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure original masks are set</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calling _initialize_var_types from _apply_nystroem_approximation()&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_var_types</span><span class="p">(</span><span class="n">X_orig</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="o">=</span> <span class="n">X_orig</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset_indices</span><span class="p">]</span>

        <span class="n">initial_theta_for_nystroem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial theta for Nystrm kernel computation: </span><span class="si">{</span><span class="n">initial_theta_for_nystroem</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">K_mm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_kernel_matrix_for_original_features</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span><span class="p">,</span> <span class="n">initial_theta_for_nystroem</span><span class="p">)</span>
        <span class="n">K_mm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_eps</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">K_mm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Use fully qualified SVD to make mocking predictable</span>
        <span class="n">U_mm</span><span class="p">,</span> <span class="n">s_mm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">K_mm</span><span class="p">)</span>

        <span class="n">valid_s</span> <span class="o">=</span> <span class="n">s_mm</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_eps</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_n_components_actual</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">valid_s</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_n_components_actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Fallback: reset Nystrm state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_n_components_actual</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">X_orig</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="o">=</span> <span class="n">U_mm</span><span class="p">[:,</span> <span class="n">valid_s</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s_mm</span><span class="p">[</span><span class="n">valid_s</span><span class="p">]))</span>
        <span class="n">K_nm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_kernel_matrix_for_original_features</span><span class="p">(</span><span class="n">X_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span><span class="p">,</span> <span class="n">initial_theta_for_nystroem</span><span class="p">)</span>
        <span class="n">X_nystroem</span> <span class="o">=</span> <span class="n">K_nm</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">X_nystroem</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits the Kriging model to training data X and y. This method is compatible with scikit-learn and</span>
<span class="sd">        uses differential evolution to optimize the hyperparameters (log(theta)).</span>
<span class="sd">        If &#39;approximation&#39; is set to &#39;nystroem&#39;, the input data X is first transformed using Nystrm approximation.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (np.ndarray):</span>
<span class="sd">                Training input data of shape (n_samples, n_features).</span>
<span class="sd">            y (np.ndarray):</span>
<span class="sd">                Target values of shape (n_samples,) or (n_samples, 1).</span>
<span class="sd">            bounds (Optional[List[Tuple[float, float]]]):</span>
<span class="sd">                Bounds for each dimension of log(theta). If None, defaults to [(-3, 2)] * n_features.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Kriging:</span>
<span class="sd">                The fitted Kriging model instance (self).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.surrogate.kriging import Kriging</span>
<span class="sd">            &gt;&gt;&gt; # Training data</span>
<span class="sd">            &gt;&gt;&gt; X_train = np.array([[0.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">            &gt;&gt;&gt; y_train = np.array([0.1, 0.2, 0.3])</span>
<span class="sd">            &gt;&gt;&gt; # Fit the Kriging model</span>
<span class="sd">            &gt;&gt;&gt; model = Kriging().fit(X_train, y_train)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Fitted theta:&quot;, model.theta)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Fitted Lambda:&quot;, model.Lambda)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Negative Log-Likelihood:&quot;, model.negLnLike)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Training data used for Kriging (X_):&quot;, model.X_)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Training targets (y_):&quot;, model.y_)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Cholesky factor (U_):&quot;, model.U_)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Correlation matrix (Psi_):&quot;, model.Psi_)</span>
<span class="sd">            &gt;&gt;&gt; # Predict responses</span>
<span class="sd">            &gt;&gt;&gt; X_test = np.array([[0.25, 0.25], [0.75, 0.75]])</span>
<span class="sd">            &gt;&gt;&gt; y_pred = model.predict(X_test)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Predictions:&quot;, y_pred)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">y_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X_orig</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># Store the original approximation setting</span>
        <span class="n">original_approximation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span>

        <span class="k">if</span> <span class="n">original_approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
            <span class="n">success</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_nystroem_approximation</span><span class="p">(</span><span class="n">X_orig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span>  <span class="c1"># Update self.k to the Kriging feature space dimension</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
                <span class="c1"># Explicitly set approximation to None on failure</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X_orig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X_orig</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">y_orig</span>

        <span class="c1"># Initialize all feature types and masks based on the final X_ for the model</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calling _initialize_var_types from fit()&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_var_types</span><span class="p">(</span><span class="n">X_orig</span><span class="o">=</span><span class="n">X_orig</span><span class="p">,</span> <span class="n">X_kriging</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Kriging fitting part (operates on self.X_)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isotropic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">original_approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of theta parameters (n_theta): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
                <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="n">n_p_to_optimize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">bounds</span> <span class="o">+=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n_p_to_optimize</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_likelihood</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized logtheta_lambda: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted theta: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted Lambda: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted p values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted theta: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted p values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psi_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_log</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predicts the Kriging response at a set of points X. This method is compatible with scikit-learn.</span>
<span class="sd">        If &#39;approximation&#39; is set to &#39;nystroem&#39;, the input data X is first transformed using</span>
<span class="sd">        the Nystrm components learned during fitting.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (np.ndarray):</span>
<span class="sd">                Array of shape (n_samples, n_features) containing the points at which</span>
<span class="sd">                to predict the Kriging response.</span>
<span class="sd">            return_std (bool, optional):</span>
<span class="sd">                If True, returns the standard deviation of the predictions as well.</span>
<span class="sd">                Implemented for compatibility with scikit-learn.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            return_val (str):</span>
<span class="sd">                Specifies which prediction values to return.</span>
<span class="sd">                It can be &quot;y&quot;, &quot;s&quot;, &quot;ei&quot;, or &quot;all&quot;.</span>
<span class="sd">                Defaults to &quot;y&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>
<span class="sd">                Predicted values of shape (n_samples,).</span>
<span class="sd">            np.ndarray:</span>
<span class="sd">                If self.return_std is True, returns the standard deviations of the predictions</span>
<span class="sd">                of shape (n_samples,).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.surrogate.kriging import Kriging</span>
<span class="sd">            &gt;&gt;&gt; # Training data</span>
<span class="sd">            &gt;&gt;&gt; X_train = np.array([[0.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">            &gt;&gt;&gt; y_train = np.array([0.1, 0.2, 0.3])</span>
<span class="sd">            &gt;&gt;&gt; # Fit the Kriging model</span>
<span class="sd">            &gt;&gt;&gt; model = Kriging().fit(X_train, y_train)</span>
<span class="sd">            &gt;&gt;&gt; # Test data</span>
<span class="sd">            &gt;&gt;&gt; X_test = np.array([[0.25, 0.25], [0.75, 0.75]])</span>
<span class="sd">            &gt;&gt;&gt; # Predict responses</span>
<span class="sd">            &gt;&gt;&gt; y_pred, sd, ei = model.predict(X_test)</span>
<span class="sd">            &gt;&gt;&gt; print(&quot;Predictions:&quot;, y_pred)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X_pred_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Kriging model with Nystrm approximation is not fitted yet. Call fit() first.&quot;</span><span class="p">)</span>

            <span class="c1"># Use the same initial theta for Nystrm kernel computation as in fit()</span>
            <span class="n">initial_theta_for_nystroem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span><span class="p">))</span>

            <span class="c1"># Transform prediction points using the fitted Nystrm components</span>
            <span class="n">K_test_subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_kernel_matrix_for_original_features</span><span class="p">(</span><span class="n">X_pred_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span><span class="p">,</span> <span class="n">initial_theta_for_nystroem</span><span class="p">)</span>
            <span class="n">X_pred_for_kriging</span> <span class="o">=</span> <span class="n">K_test_subset</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_pred_for_kriging</span> <span class="o">=</span> <span class="n">X_pred_orig</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>

        <span class="c1"># Original predict logic using X_pred_for_kriging</span>
        <span class="k">if</span> <span class="n">return_std</span><span class="p">:</span>
            <span class="c1"># Return predictions and standard deviations</span>
            <span class="c1"># Compatibility with scikit-learn</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
            <span class="c1"># Return only standard deviations</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="c1"># Return predictions, standard deviations, and expected improvements</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span><span class="p">,</span> <span class="n">eis</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eis</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;ei&quot;</span><span class="p">:</span>
            <span class="c1"># Return only neg. expected improvements</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">predictions</span><span class="p">,</span> <span class="n">eis</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Return only predictions (case &quot;y&quot;)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_Psi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a new (n x n) correlation matrix Psi to reflect new data or a change in hyperparameters.</span>
<span class="sd">        Operates on the Kriging model&#39;s current feature space (self.X_).</span>
<span class="sd">        This method uses `theta`, `p`, and coded `X` values to construct the</span>
<span class="sd">        correlation matrix as described in [Forr08a, p.57].</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>
<span class="sd">                Upper triangular part of the correlation matrix Psi (excluding diagonal).</span>

<span class="sd">        Raises:</span>
<span class="sd">            LinAlgError: If building Psi fails.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.build.kriging import Kriging</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                nat_X = np.array([[0], [1]])</span>
<span class="sd">                nat_y = np.array([0, 1])</span>
<span class="sd">                n=1</span>
<span class="sd">                p=1</span>
<span class="sd">                S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">                S._initialize_variables(nat_X, nat_y)</span>
<span class="sd">                S._set_variable_types()</span>
<span class="sd">                print(S.nat_X)</span>
<span class="sd">                print(S.nat_y)</span>
<span class="sd">                S._set_theta_values()</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S._initialize_matrices()</span>
<span class="sd">                S._set_de_bounds()</span>
<span class="sd">                new_theta_p_Lambda = S._optimize_model()</span>
<span class="sd">                S._extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">                print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">                S.build_Psi()</span>
<span class="sd">                print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">                    [[0]</span>
<span class="sd">                    [1]]</span>
<span class="sd">                    [0 1]</span>
<span class="sd">                    S.theta: [0.]</span>
<span class="sd">                    S.theta: [1.60036366]</span>
<span class="sd">                    S.Psi: [[1.00000001e+00 4.96525625e-18]</span>
<span class="sd">                    [4.96525625e-18 1.00000001e+00]]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">k_current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">theta10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">theta10</span> <span class="o">=</span> <span class="n">theta10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k_current</span><span class="p">)</span>  <span class="c1"># Ensure theta10 matches current feature dimension</span>

            <span class="n">Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

            <span class="c1"># Use Kriging model&#39;s own masks (self.ordered_mask_kriging, self.factor_mask_kriging)</span>
            <span class="c1"># These masks are set in _set_kriging_model_feature_types based on whether Nystrm is active.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_ordered_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
                <span class="n">theta10_ordered_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
                <span class="n">D_ordered</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X_ordered_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_ordered_for_kriging</span><span class="p">))</span>
                <span class="n">Psi</span> <span class="o">+=</span> <span class="n">D_ordered</span>

            <span class="c1"># Add the contribution of factor variables to the distance matrix</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_factor_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
                <span class="n">theta10_factor_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
                <span class="n">D_factor</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X_factor_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_factor_for_kriging</span><span class="p">))</span>
                <span class="n">Psi</span> <span class="o">+=</span> <span class="n">D_factor</span>

            <span class="c1"># Calculate correlation from distance</span>
            <span class="n">Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Psi</span><span class="p">)</span>
            <span class="c1"># Check for infinite values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
            <span class="c1"># Calculate condition number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="n">cond</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span>
            <span class="c1"># Return only the upper triangle, as the matrix is symmetric</span>
            <span class="c1"># and the diagonal will be handled later.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">Psi</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building Psi failed. Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">, Type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the negative of the concentrated log-likelihood for a given set</span>
<span class="sd">        of log(theta) parameters using a power exponent p=1.99. Returns the</span>
<span class="sd">        negative log-likelihood, the correlation matrix Psi, and its Cholesky factor U.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (np.ndarray):</span>
<span class="sd">                1D array of log(theta) parameters of length k. If self.method is &quot;regression&quot; or</span>
<span class="sd">                &quot;reinterpolation&quot;, length is k+1 and the last element of x is the log(noise) parameter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (float, np.ndarray, np.ndarray):</span>
<span class="sd">                (negLnLike, Psi, U) where:</span>
<span class="sd">                - negLnLike (float): The negative concentrated log-likelihood.</span>
<span class="sd">                - Psi (np.ndarray): The correlation matrix.</span>
<span class="sd">                - U (np.ndarray): The Cholesky factor (or None if ill-conditioned).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract data</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">):</span>
            <span class="c1"># theta = x[:-1]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="c1"># lambda_ = x[-1]</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1"># lambda is in log scale, so transform it back:</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">lambda_</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
            <span class="c1"># theta = x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="c1"># use the original, untransformed eps:</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of &#39;interpolation&#39;, &#39;regression&#39;, or &#39;reinterpolation&#39;&quot;</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="n">Psi_upper_triangle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>

        <span class="n">Psi</span> <span class="o">=</span> <span class="n">Psi_upper_triangle</span> <span class="o">+</span> <span class="n">Psi_upper_triangle</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">lambda_</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">LinAlgError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">penalty</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">LnDetPsi</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">U</span><span class="p">))))</span>

        <span class="n">temp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">temp_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">one</span><span class="p">)</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">temp_y</span><span class="p">)</span>
        <span class="n">vone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">temp_one</span><span class="p">)</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">vy</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">vone</span><span class="p">)</span>
        <span class="n">resid</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">one</span> <span class="o">*</span> <span class="n">mu</span>
        <span class="n">tresid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">resid</span><span class="p">)</span>
        <span class="n">tresid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tresid</span><span class="p">)</span>
        <span class="n">SigmaSqr</span> <span class="o">=</span> <span class="p">(</span><span class="n">resid</span> <span class="o">@</span> <span class="n">tresid</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

        <span class="n">negLnLike</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">SigmaSqr</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">LnDetPsi</span>
        <span class="k">return</span> <span class="n">negLnLike</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">U</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_psi_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the psi vector required for predictive methods.</span>
<span class="sd">        Operates on a single point &#39;x&#39; in the Kriging model&#39;s current feature space.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (np.ndarray): 1D array of length k for the point at which to compute psi.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The psi vector of shape (n,).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.build.kriging import Kriging</span>
<span class="sd">                X_train = np.array([[1., 2.],</span>
<span class="sd">                                    [2., 4.],</span>
<span class="sd">                                    [3., 6.]])</span>
<span class="sd">                y_train = np.array([1., 2., 3.])</span>
<span class="sd">                S = Kriging(name=&#39;kriging&#39;,</span>
<span class="sd">                            seed=123,</span>
<span class="sd">                            log_level=50,</span>
<span class="sd">                            n_theta=1,</span>
<span class="sd">                            noise=False,</span>
<span class="sd">                            cod_type=&quot;norm&quot;)</span>
<span class="sd">                S.fit(X_train, y_train)</span>
<span class="sd">                # force theta to simple values:</span>
<span class="sd">                S.theta = np.array([0.0])</span>
<span class="sd">                nat_X = np.array([1., 0.])</span>
<span class="sd">                S.psi = np.zeros((S.n, 1))</span>
<span class="sd">                S.build_psi_vec(nat_X)</span>
<span class="sd">                res = np.array([[np.exp(-4)],</span>
<span class="sd">                    [np.exp(-17)],</span>
<span class="sd">                    [np.exp(-40)]])</span>
<span class="sd">                assert np.array_equal(S.psi, res)</span>
<span class="sd">                print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="sd">                print(f&quot;Control value res: {res}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">k_current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">theta10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">theta10</span> <span class="o">=</span> <span class="n">theta10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k_current</span><span class="p">)</span>

            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

            <span class="c1"># Use Kriging model&#39;s own masks (self.ordered_mask_kriging, self.factor_mask_kriging)</span>
            <span class="c1"># These masks are set in _set_kriging_model_feature_types based on whether Nystrm is active.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_ordered_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
                <span class="n">x_ordered_for_kriging</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
                <span class="n">theta10_ordered_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">+=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_ordered_for_kriging</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">X_ordered_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_ordered_for_kriging</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">X_factor_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
                <span class="n">x_factor_for_kriging</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
                <span class="n">theta10_factor_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">+=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_factor_for_kriging</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">X_factor_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_factor_for_kriging</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

            <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">psi</span>
        <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building psi failed due to a linear algebra error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">. Error type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_pred</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a single-point Kriging prediction using the correlation matrix</span>
<span class="sd">        information. Internal helper method.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (np.ndarray): 1D array of length k for the point at which to predict.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The Kriging prediction at x.</span>
<span class="sd">            float: The standard deviation of the prediction.</span>
<span class="sd">            float: The NEGATIVE expected improvement at x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1"># lambda is in log scale, so transform it back:</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">lambda_</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
            <span class="c1"># use the original, untransformed eps:</span>
            <span class="n">lambda_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of &#39;interpolation&#39;, &#39;regression&#39;, or &#39;reinterpolation&#39;&quot;</span><span class="p">)</span>

        <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="c1"># Compute mu</span>
        <span class="n">y_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">y_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">y_tilde</span><span class="p">)</span>
        <span class="n">one_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">one</span><span class="p">)</span>
        <span class="n">one_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">one_tilde</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">y_tilde</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">one_tilde</span><span class="p">)</span>

        <span class="n">resid</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">one</span> <span class="o">*</span> <span class="n">mu</span>
        <span class="n">resid_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">resid</span><span class="p">)</span>
        <span class="n">resid_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">resid_tilde</span><span class="p">)</span>

        <span class="n">psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_psi_vec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># Compute SigmaSqr and SSqr</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">):</span>
            <span class="n">SigmaSqr</span> <span class="o">=</span> <span class="p">(</span><span class="n">resid</span> <span class="o">@</span> <span class="n">resid_tilde</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
            <span class="c1"># Compute SSqr</span>
            <span class="n">psi_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>
            <span class="n">psi_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">psi_tilde</span><span class="p">)</span>
            <span class="c1"># Eq. (3.1) in [forr08a] without lambda:</span>
            <span class="n">SSqr</span> <span class="o">=</span> <span class="n">SigmaSqr</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">lambda_</span> <span class="o">-</span> <span class="n">psi</span> <span class="o">@</span> <span class="n">psi_tilde</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># method is &quot;reinterpolation&quot;</span>
            <span class="n">Psi_adjusted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psi_</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
            <span class="n">SigmaSqr</span> <span class="o">=</span> <span class="p">(</span><span class="n">resid</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">Psi_adjusted</span> <span class="o">@</span> <span class="n">resid_tilde</span><span class="p">)))</span> <span class="o">/</span> <span class="n">n</span>
            <span class="c1"># Compute Uint (Cholesky factor of the adjusted Psi matrix)</span>
            <span class="n">Uint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Psi_adjusted</span><span class="p">)</span>

            <span class="c1"># Compute SSqr</span>
            <span class="n">psi_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Uint</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>
            <span class="n">psi_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Uint</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">psi_tilde</span><span class="p">)</span>
            <span class="n">SSqr</span> <span class="o">=</span> <span class="n">SigmaSqr</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">psi</span> <span class="o">@</span> <span class="n">psi_tilde</span><span class="p">)</span>

        <span class="n">SSqr</span> <span class="o">=</span> <span class="n">SSqr</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="c1"># Compute s</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">SSqr</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

        <span class="c1"># Final prediction</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">psi</span> <span class="o">@</span> <span class="n">resid_tilde</span>
        <span class="c1"># print(f&quot;Prediction at {x}: f={f}, s={s}, SigmaSqr={SigmaSqr}, SSqr={SSqr}&quot;)</span>

        <span class="c1"># Compute ExpImp</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span><span class="p">:</span>
            <span class="n">yBest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">EITermOne</span> <span class="o">=</span> <span class="p">(</span><span class="n">yBest</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">yBest</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span><span class="p">)))</span>
            <span class="n">EITermTwo</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">yBest</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">SSqr</span><span class="p">))</span>
            <span class="n">ExpImp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">EITermOne</span> <span class="o">+</span> <span class="n">EITermTwo</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">s</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="p">(</span><span class="o">-</span><span class="n">ExpImp</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">s</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">max_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maximizes the Kriging likelihood function using differential evolution</span>
<span class="sd">        over the range of log(theta) specified by bounds.</span>

<span class="sd">        Args:</span>
<span class="sd">            bounds (List[Tuple[float, float]]): Sequence of (low, high) bounds for log(theta).</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray, float): (best_x, best_fun) where best_x is the</span>
<span class="sd">            optimal log(theta) array and best_fun is the minimized negative log-likelihood.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">logtheta_lambda</span><span class="p">):</span>
            <span class="n">neg_ln_like</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">logtheta_lambda</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">neg_ln_like</span>

        <span class="c1"># result = differential_evolution(objective, bounds, seed=self.seed, maxiter=self.model_fun_evals)</span>
        <span class="c1"># print(f&quot;bounds for differential_evolution: {bounds}&quot;)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">add_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots 1D and 2D surrogates.</span>
<span class="sd">        Only for compatibility with the old Kriging implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                The Kriging object.</span>
<span class="sd">            i (int):</span>
<span class="sd">                The index of the first variable to plot.</span>
<span class="sd">            j (int):</span>
<span class="sd">                The index of the second variable to plot.</span>
<span class="sd">            show (bool):</span>
<span class="sd">                If `True`, the plots are displayed.</span>
<span class="sd">                If `False`, `plt.show()` should be called outside this function.</span>
<span class="sd">            add_points (bool):</span>
<span class="sd">                If `True`, the points from the design are added to the plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Note:</span>
<span class="sd">            * This method provides only a basic plot. For more advanced plots,</span>
<span class="sd">                use the `plot_contour()` method of the `Spot` class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="sd">                # 1-dimensional example</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control=fun_control_init(lower = np.array([-1]),</span>
<span class="sd">                                            upper = np.array([1]),</span>
<span class="sd">                                            noise=False)</span>
<span class="sd">                design_control=design_control_init(init_size=10)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control)</span>
<span class="sd">                S.initialize_design()</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.surrogate.plot()</span>
<span class="sd">                # 2-dimensional example</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control=fun_control_init(lower = np.array([-1, -1]),</span>
<span class="sd">                                            upper = np.array([1, 1]),</span>
<span class="sd">                                            noise=False)</span>
<span class="sd">                design_control=design_control_init(init_size=10)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control)</span>
<span class="sd">                S.initialize_design()</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.surrogate.plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plotkd</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span> <span class="n">add_points</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">10000.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Kriging&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">124</span><span class="p">,</span> <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_fun_evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_theta</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">max_theta</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">theta_init_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">p_val</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">n_p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">optim_p</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">max_p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">min_Lambda</span><span class="o">=-</span><span class="mf">9.0</span><span class="p">,</span> <span class="n">max_Lambda</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric_factorial</span><span class="o">=</span><span class="s1">&#39;canberra&#39;</span><span class="p">,</span> <span class="n">isotropic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">approximation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_components_nystroem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes the Kriging model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Small number added to the diagonal of the correlation matrix to reduce
ill-conditioning. Defaults to the square root of machine epsilon.
Only used if method is &ldquo;interpolation&rdquo;. Otherwise, if method is &ldquo;regression&rdquo; or &ldquo;reinterpolation&rdquo;, eps is replaced by the
lambda_ parameter. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>penalty</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Large negative log-likelihood assigned if the correlation matrix is
not positive-definite. Defaults to 1e4.</p>
              </div>
            </td>
            <td>
                  <code>10000.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type how the model uis fitted. Can be &ldquo;interpolation&rdquo;, &ldquo;regression&rdquo;, or &ldquo;reinterpolation&rdquo;. Defaults to &ldquo;regression&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;regression&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>isotropic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the model is isotropic, meaning all variables are treated equally (only one theta value is used).
If False, the model can handle different theta values, one for each dimension. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">penalty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;regression&quot;</span><span class="p">,</span>
    <span class="n">noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">var_type</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">124</span><span class="p">,</span>
    <span class="n">model_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">model_fun_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span>
    <span class="n">max_theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">theta_init_zero</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">p_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">n_p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">optim_p</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">min_p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">max_p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">min_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.0</span><span class="p">,</span>
    <span class="n">max_Lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">spot_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">counter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">metric_factorial</span><span class="o">=</span><span class="s2">&quot;canberra&quot;</span><span class="p">,</span>
    <span class="n">isotropic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">approximation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Default is None</span>
    <span class="n">n_components_nystroem</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Number of components for Nystrm</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the Kriging model.</span>

<span class="sd">    Args:</span>
<span class="sd">        eps (float, optional):</span>
<span class="sd">            Small number added to the diagonal of the correlation matrix to reduce</span>
<span class="sd">            ill-conditioning. Defaults to the square root of machine epsilon.</span>
<span class="sd">            Only used if method is &quot;interpolation&quot;. Otherwise, if method is &quot;regression&quot; or &quot;reinterpolation&quot;, eps is replaced by the</span>
<span class="sd">            lambda_ parameter. Defaults to None.</span>
<span class="sd">        penalty (float, optional):</span>
<span class="sd">            Large negative log-likelihood assigned if the correlation matrix is</span>
<span class="sd">            not positive-definite. Defaults to 1e4.</span>
<span class="sd">        method (str, optional):</span>
<span class="sd">            The type how the model uis fitted. Can be &quot;interpolation&quot;, &quot;regression&quot;, or &quot;reinterpolation&quot;. Defaults to &quot;regression&quot;.</span>
<span class="sd">        isotropic (bool, optional):</span>
<span class="sd">            If True, the model is isotropic, meaning all variables are treated equally (only one theta value is used).</span>
<span class="sd">            If False, the model can handle different theta values, one for each dimension. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_eps</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;eps must be positive&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">penalty</span> <span class="o">=</span> <span class="n">penalty</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="n">var_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">log_level</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="n">spot_writer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span> <span class="o">=</span> <span class="n">metric_factorial</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span> <span class="o">=</span> <span class="n">min_theta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span> <span class="o">=</span> <span class="n">max_theta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span> <span class="o">=</span> <span class="n">min_Lambda</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span> <span class="o">=</span> <span class="n">max_Lambda</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_p</span> <span class="o">=</span> <span class="n">min_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span> <span class="o">=</span> <span class="n">max_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Will be set in fit() based on self.k</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">isotropic</span> <span class="o">=</span> <span class="n">isotropic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">=</span> <span class="n">n_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span> <span class="o">=</span> <span class="n">optim_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">theta_init_zero</span> <span class="o">=</span> <span class="n">theta_init_zero</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">model_optimizer</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer</span> <span class="o">=</span> <span class="n">differential_evolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="n">model_fun_evals</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_fun_evals</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;negLnLike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">U_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Training data for the Kriging model (could be Nystrm features)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Psi_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of &#39;interpolation&#39;, &#39;regression&#39;, or &#39;reinterpolation&#39;]&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Nystrm specific initializations</span>
    <span class="k">if</span> <span class="n">approximation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">approximation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nystroem&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;approximation must be &#39;nystroem&#39; or None&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">=</span> <span class="n">approximation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">approximation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_components_nystroem</span> <span class="o">=</span> <span class="n">n_components_nystroem</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Stores the actual subset of original X points</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Stores U_m @ Sigma_m^{-1/2} from SVD of K_mm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_n_components_actual</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Actual components used after filtering small eigenvalues</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># Random number generator for reproducible sampling</span>

    <span class="c1"># Attributes to store original input dimensions and masks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_orig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_orig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Original number of features (before Nystrm)</span>

    <span class="c1"># Attributes for the Kriging model&#39;s feature space (could be Nystrm transformed)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Current number of features for the Kriging model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">var_type_kriging</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Variable types for the Kriging model&#39;s feature space</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.build_Psi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_Psi</span><span class="p">()</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.build_Psi" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Constructs a new (n x n) correlation matrix Psi to reflect new data or a change in hyperparameters.
Operates on the Kriging model&rsquo;s current feature space (self.X_).
This method uses <code>theta</code>, <code>p</code>, and coded <code>X</code> values to construct the
correlation matrix as described in [Forr08a, p.57].</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
Upper triangular part of the correlation matrix Psi (excluding diagonal).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.linalg.LinAlgError">LinAlgError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If building Psi fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.build.kriging</span><span class="w"> </span><span class="kn">import</span> <span class="n">Kriging</span>
<span class="go">    import numpy as np</span>
<span class="go">    nat_X = np.array([[0], [1]])</span>
<span class="go">    nat_y = np.array([0, 1])</span>
<span class="go">    n=1</span>
<span class="go">    p=1</span>
<span class="go">    S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="go">    S._initialize_variables(nat_X, nat_y)</span>
<span class="go">    S._set_variable_types()</span>
<span class="go">    print(S.nat_X)</span>
<span class="go">    print(S.nat_y)</span>
<span class="go">    S._set_theta_values()</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S._initialize_matrices()</span>
<span class="go">    S._set_de_bounds()</span>
<span class="go">    new_theta_p_Lambda = S._optimize_model()</span>
<span class="go">    S._extract_from_bounds(new_theta_p_Lambda)</span>
<span class="go">    print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="go">    S.build_Psi()</span>
<span class="go">    print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="go">        [[0]</span>
<span class="go">        [1]]</span>
<span class="go">        [0 1]</span>
<span class="go">        S.theta: [0.]</span>
<span class="go">        S.theta: [1.60036366]</span>
<span class="go">        S.Psi: [[1.00000001e+00 4.96525625e-18]</span>
<span class="go">        [4.96525625e-18 1.00000001e+00]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_Psi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a new (n x n) correlation matrix Psi to reflect new data or a change in hyperparameters.</span>
<span class="sd">    Operates on the Kriging model&#39;s current feature space (self.X_).</span>
<span class="sd">    This method uses `theta`, `p`, and coded `X` values to construct the</span>
<span class="sd">    correlation matrix as described in [Forr08a, p.57].</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            Upper triangular part of the correlation matrix Psi (excluding diagonal).</span>

<span class="sd">    Raises:</span>
<span class="sd">        LinAlgError: If building Psi fails.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.build.kriging import Kriging</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            nat_X = np.array([[0], [1]])</span>
<span class="sd">            nat_y = np.array([0, 1])</span>
<span class="sd">            n=1</span>
<span class="sd">            p=1</span>
<span class="sd">            S=Kriging(name=&#39;kriging&#39;, seed=124, n_theta=n, n_p=p, optim_p=True, noise=False)</span>
<span class="sd">            S._initialize_variables(nat_X, nat_y)</span>
<span class="sd">            S._set_variable_types()</span>
<span class="sd">            print(S.nat_X)</span>
<span class="sd">            print(S.nat_y)</span>
<span class="sd">            S._set_theta_values()</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S._initialize_matrices()</span>
<span class="sd">            S._set_de_bounds()</span>
<span class="sd">            new_theta_p_Lambda = S._optimize_model()</span>
<span class="sd">            S._extract_from_bounds(new_theta_p_Lambda)</span>
<span class="sd">            print(f&quot;S.theta: {S.theta}&quot;)</span>
<span class="sd">            S.build_Psi()</span>
<span class="sd">            print(f&quot;S.Psi: {S.Psi}&quot;)</span>
<span class="sd">                [[0]</span>
<span class="sd">                [1]]</span>
<span class="sd">                [0 1]</span>
<span class="sd">                S.theta: [0.]</span>
<span class="sd">                S.theta: [1.60036366]</span>
<span class="sd">                S.Psi: [[1.00000001e+00 4.96525625e-18]</span>
<span class="sd">                [4.96525625e-18 1.00000001e+00]]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">k_current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">theta10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta10</span> <span class="o">=</span> <span class="n">theta10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k_current</span><span class="p">)</span>  <span class="c1"># Ensure theta10 matches current feature dimension</span>

        <span class="n">Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="c1"># Use Kriging model&#39;s own masks (self.ordered_mask_kriging, self.factor_mask_kriging)</span>
        <span class="c1"># These masks are set in _set_kriging_model_feature_types based on whether Nystrm is active.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_ordered_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
            <span class="n">theta10_ordered_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
            <span class="n">D_ordered</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X_ordered_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_ordered_for_kriging</span><span class="p">))</span>
            <span class="n">Psi</span> <span class="o">+=</span> <span class="n">D_ordered</span>

        <span class="c1"># Add the contribution of factor variables to the distance matrix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_factor_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
            <span class="n">theta10_factor_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
            <span class="n">D_factor</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X_factor_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_factor_for_kriging</span><span class="p">))</span>
            <span class="n">Psi</span> <span class="o">+=</span> <span class="n">D_factor</span>

        <span class="c1"># Calculate correlation from distance</span>
        <span class="n">Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Psi</span><span class="p">)</span>
        <span class="c1"># Check for infinite values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inf_Psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="c1"># Calculate condition number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnd_Psi</span> <span class="o">=</span> <span class="n">cond</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span>
        <span class="c1"># Return only the upper triangle, as the matrix is symmetric</span>
        <span class="c1"># and the diagonal will be handled later.</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">Psi</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building Psi failed. Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">, Type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.build_psi_vec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_psi_vec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.build_psi_vec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Build the psi vector required for predictive methods.
Operates on a single point &lsquo;x&rsquo; in the Kriging model&rsquo;s current feature space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1D array of length k for the point at which to compute psi.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The psi vector of shape (n,).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.build.kriging import Kriging</span>
<span class="go">    X_train = np.array([[1., 2.],</span>
<span class="go">                        [2., 4.],</span>
<span class="go">                        [3., 6.]])</span>
<span class="go">    y_train = np.array([1., 2., 3.])</span>
<span class="go">    S = Kriging(name=&#39;kriging&#39;,</span>
<span class="go">                seed=123,</span>
<span class="go">                log_level=50,</span>
<span class="go">                n_theta=1,</span>
<span class="go">                noise=False,</span>
<span class="go">                cod_type=&quot;norm&quot;)</span>
<span class="go">    S.fit(X_train, y_train)</span>
<span class="go">    # force theta to simple values:</span>
<span class="go">    S.theta = np.array([0.0])</span>
<span class="go">    nat_X = np.array([1., 0.])</span>
<span class="go">    S.psi = np.zeros((S.n, 1))</span>
<span class="go">    S.build_psi_vec(nat_X)</span>
<span class="go">    res = np.array([[np.exp(-4)],</span>
<span class="go">        [np.exp(-17)],</span>
<span class="go">        [np.exp(-40)]])</span>
<span class="go">    assert np.array_equal(S.psi, res)</span>
<span class="go">    print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="go">    print(f&quot;Control value res: {res}&quot;)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_psi_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build the psi vector required for predictive methods.</span>
<span class="sd">    Operates on a single point &#39;x&#39; in the Kriging model&#39;s current feature space.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.ndarray): 1D array of length k for the point at which to compute psi.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The psi vector of shape (n,).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.build.kriging import Kriging</span>
<span class="sd">            X_train = np.array([[1., 2.],</span>
<span class="sd">                                [2., 4.],</span>
<span class="sd">                                [3., 6.]])</span>
<span class="sd">            y_train = np.array([1., 2., 3.])</span>
<span class="sd">            S = Kriging(name=&#39;kriging&#39;,</span>
<span class="sd">                        seed=123,</span>
<span class="sd">                        log_level=50,</span>
<span class="sd">                        n_theta=1,</span>
<span class="sd">                        noise=False,</span>
<span class="sd">                        cod_type=&quot;norm&quot;)</span>
<span class="sd">            S.fit(X_train, y_train)</span>
<span class="sd">            # force theta to simple values:</span>
<span class="sd">            S.theta = np.array([0.0])</span>
<span class="sd">            nat_X = np.array([1., 0.])</span>
<span class="sd">            S.psi = np.zeros((S.n, 1))</span>
<span class="sd">            S.build_psi_vec(nat_X)</span>
<span class="sd">            res = np.array([[np.exp(-4)],</span>
<span class="sd">                [np.exp(-17)],</span>
<span class="sd">                [np.exp(-40)]])</span>
<span class="sd">            assert np.array_equal(S.psi, res)</span>
<span class="sd">            print(f&quot;S.psi: {S.psi}&quot;)</span>
<span class="sd">            print(f&quot;Control value res: {res}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">k_current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">theta10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta10</span> <span class="o">=</span> <span class="n">theta10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">k_current</span><span class="p">)</span>

        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="c1"># Use Kriging model&#39;s own masks (self.ordered_mask_kriging, self.factor_mask_kriging)</span>
        <span class="c1"># These masks are set in _set_kriging_model_feature_types based on whether Nystrm is active.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_ordered_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
            <span class="n">x_ordered_for_kriging</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
            <span class="n">theta10_ordered_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_mask_kriging</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">+=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_ordered_for_kriging</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">X_ordered_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_ordered_for_kriging</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">X_factor_for_kriging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
            <span class="n">x_factor_for_kriging</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
            <span class="n">theta10_factor_for_kriging</span> <span class="o">=</span> <span class="n">theta10</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor_mask_kriging</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">+=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">x_factor_for_kriging</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">X_factor_for_kriging</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_factorial</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">theta10_factor_for_kriging</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">psi</span>
    <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building psi failed due to a linear algebra error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">. Error type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fits the Kriging model to training data X and y. This method is compatible with scikit-learn and
uses differential evolution to optimize the hyperparameters (log(theta)).
If &lsquo;approximation&rsquo; is set to &lsquo;nystroem&rsquo;, the input data X is first transformed using Nystrm approximation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training input data of shape (n_samples, n_features).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values of shape (n_samples,) or (n_samples, 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bounds for each dimension of log(theta). If None, defaults to [(-3, 2)] * n_features.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Kriging</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Kriging (spotpython.surrogate.kriging_temp.Kriging)" href="#spotpython.surrogate.kriging_temp.Kriging">Kriging</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fitted Kriging model instance (self).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.surrogate.kriging</span><span class="w"> </span><span class="kn">import</span> <span class="n">Kriging</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Training data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit the Kriging model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Kriging</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted theta:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted Lambda:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Lambda</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Negative Log-Likelihood:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training data used for Kriging (X_):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">X_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training targets (y_):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cholesky factor (U_):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">U_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation matrix (Psi_):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Psi_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Predict responses</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions:&quot;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fits the Kriging model to training data X and y. This method is compatible with scikit-learn and</span>
<span class="sd">    uses differential evolution to optimize the hyperparameters (log(theta)).</span>
<span class="sd">    If &#39;approximation&#39; is set to &#39;nystroem&#39;, the input data X is first transformed using Nystrm approximation.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            Training input data of shape (n_samples, n_features).</span>
<span class="sd">        y (np.ndarray):</span>
<span class="sd">            Target values of shape (n_samples,) or (n_samples, 1).</span>
<span class="sd">        bounds (Optional[List[Tuple[float, float]]]):</span>
<span class="sd">            Bounds for each dimension of log(theta). If None, defaults to [(-3, 2)] * n_features.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Kriging:</span>
<span class="sd">            The fitted Kriging model instance (self).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.surrogate.kriging import Kriging</span>
<span class="sd">        &gt;&gt;&gt; # Training data</span>
<span class="sd">        &gt;&gt;&gt; X_train = np.array([[0.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">        &gt;&gt;&gt; y_train = np.array([0.1, 0.2, 0.3])</span>
<span class="sd">        &gt;&gt;&gt; # Fit the Kriging model</span>
<span class="sd">        &gt;&gt;&gt; model = Kriging().fit(X_train, y_train)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Fitted theta:&quot;, model.theta)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Fitted Lambda:&quot;, model.Lambda)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Negative Log-Likelihood:&quot;, model.negLnLike)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Training data used for Kriging (X_):&quot;, model.X_)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Training targets (y_):&quot;, model.y_)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Cholesky factor (U_):&quot;, model.U_)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Correlation matrix (Psi_):&quot;, model.Psi_)</span>
<span class="sd">        &gt;&gt;&gt; # Predict responses</span>
<span class="sd">        &gt;&gt;&gt; X_test = np.array([[0.25, 0.25], [0.75, 0.75]])</span>
<span class="sd">        &gt;&gt;&gt; y_pred = model.predict(X_test)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Predictions:&quot;, y_pred)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X_orig</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Store the original approximation setting</span>
    <span class="n">original_approximation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span>

    <span class="k">if</span> <span class="n">original_approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
        <span class="n">success</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_nystroem_approximation</span><span class="p">(</span><span class="n">X_orig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span>  <span class="c1"># Update self.k to the Kriging feature space dimension</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># Explicitly set approximation to None on failure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X_orig</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X_orig</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">y_orig</span>

    <span class="c1"># Initialize all feature types and masks based on the final X_ for the model</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calling _initialize_var_types from fit()&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_var_types</span><span class="p">(</span><span class="n">X_orig</span><span class="o">=</span><span class="n">X_orig</span><span class="p">,</span> <span class="n">X_kriging</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Kriging fitting part (operates on self.X_)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isotropic</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">original_approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of theta parameters (n_theta): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_theta</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
            <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">min_Lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_Lambda</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
        <span class="n">n_p_to_optimize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="n">bounds</span> <span class="o">+=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_p</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n_p_to_optimize</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_likelihood</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized logtheta_lambda: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted theta: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted Lambda: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted p values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted theta: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted p values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psi_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_update_log</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.get_model_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_params</span><span class="p">()</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.get_model_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the model parameters (in addition to sklearn&rsquo;s get_params method).</p>
<p>This method is NOT required for scikit-learn compatibility.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter names not included in get_params() mapped to their values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_model_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the model parameters (in addition to sklearn&#39;s get_params method).</span>

<span class="sd">    This method is NOT required for scikit-learn compatibility.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Parameter names not included in get_params() mapped to their values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;log_theta_lambda&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logtheta_lambda_</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="s2">&quot;negLnLike&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">negLnLike</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.likelihood" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">likelihood</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.likelihood" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the negative of the concentrated log-likelihood for a given set
of log(theta) parameters using a power exponent p=1.99. Returns the
negative log-likelihood, the correlation matrix Psi, and its Cholesky factor U.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1D array of log(theta) parameters of length k. If self.method is &ldquo;regression&rdquo; or
&ldquo;reinterpolation&rdquo;, length is k+1 and the last element of x is the log(noise) parameter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(negLnLike, Psi, U) where:
- negLnLike (float): The negative concentrated log-likelihood.
- Psi (np.ndarray): The correlation matrix.
- U (np.ndarray): The Cholesky factor (or None if ill-conditioned).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the negative of the concentrated log-likelihood for a given set</span>
<span class="sd">    of log(theta) parameters using a power exponent p=1.99. Returns the</span>
<span class="sd">    negative log-likelihood, the correlation matrix Psi, and its Cholesky factor U.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.ndarray):</span>
<span class="sd">            1D array of log(theta) parameters of length k. If self.method is &quot;regression&quot; or</span>
<span class="sd">            &quot;reinterpolation&quot;, length is k+1 and the last element of x is the log(noise) parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float, np.ndarray, np.ndarray):</span>
<span class="sd">            (negLnLike, Psi, U) where:</span>
<span class="sd">            - negLnLike (float): The negative concentrated log-likelihood.</span>
<span class="sd">            - Psi (np.ndarray): The correlation matrix.</span>
<span class="sd">            - U (np.ndarray): The Cholesky factor (or None if ill-conditioned).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract data</span>
    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;reinterpolation&quot;</span><span class="p">):</span>
        <span class="c1"># theta = x[:-1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="c1"># lambda_ = x[-1]</span>
        <span class="n">lambda_</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># lambda is in log scale, so transform it back:</span>
        <span class="n">lambda_</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">lambda_</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;interpolation&quot;</span><span class="p">:</span>
        <span class="c1"># theta = x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span><span class="p">]</span>
        <span class="c1"># use the original, untransformed eps:</span>
        <span class="n">lambda_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_p</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of &#39;interpolation&#39;, &#39;regression&#39;, or &#39;reinterpolation&#39;&quot;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="n">Psi_upper_triangle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_Psi</span><span class="p">()</span>

    <span class="n">Psi</span> <span class="o">=</span> <span class="n">Psi_upper_triangle</span> <span class="o">+</span> <span class="n">Psi_upper_triangle</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">lambda_</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">LinAlgError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">penalty</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">LnDetPsi</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">U</span><span class="p">))))</span>

    <span class="n">temp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">temp_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">one</span><span class="p">)</span>
    <span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">temp_y</span><span class="p">)</span>
    <span class="n">vone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">temp_one</span><span class="p">)</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">vy</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">one</span> <span class="o">@</span> <span class="n">vone</span><span class="p">)</span>
    <span class="n">resid</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">one</span> <span class="o">*</span> <span class="n">mu</span>
    <span class="n">tresid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">resid</span><span class="p">)</span>
    <span class="n">tresid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tresid</span><span class="p">)</span>
    <span class="n">SigmaSqr</span> <span class="o">=</span> <span class="p">(</span><span class="n">resid</span> <span class="o">@</span> <span class="n">tresid</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

    <span class="n">negLnLike</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">SigmaSqr</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">LnDetPsi</span>
    <span class="k">return</span> <span class="n">negLnLike</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">U</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.max_likelihood" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_likelihood</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.max_likelihood" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Maximizes the Kriging likelihood function using differential evolution
over the range of log(theta) specified by bounds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of (low, high) bounds for log(theta).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="numpy.ndarray">ndarray</span>, <span title="float">float</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(best_x, best_fun) where best_x is the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optimal log(theta) array and best_fun is the minimized negative log-likelihood.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">max_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Maximizes the Kriging likelihood function using differential evolution</span>
<span class="sd">    over the range of log(theta) specified by bounds.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (List[Tuple[float, float]]): Sequence of (low, high) bounds for log(theta).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray, float): (best_x, best_fun) where best_x is the</span>
<span class="sd">        optimal log(theta) array and best_fun is the minimized negative log-likelihood.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">logtheta_lambda</span><span class="p">):</span>
        <span class="n">neg_ln_like</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">logtheta_lambda</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">neg_ln_like</span>

    <span class="c1"># result = differential_evolution(objective, bounds, seed=self.seed, maxiter=self.model_fun_evals)</span>
    <span class="c1"># print(f&quot;bounds for differential_evolution: {bounds}&quot;)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_points</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>This function plots 1D and 2D surrogates.
Only for compatibility with the old Kriging implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kriging object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the first variable to plot.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the second variable to plot.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the plots are displayed.
If <code>False</code>, <code>plt.show()</code> should be called outside this function.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_points</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the points from the design are added to the plot.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This method provides only a basic plot. For more advanced plots,
    use the <code>plot_contour()</code> method of the <code>Spot</code> class.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="go">    # 1-dimensional example</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control=fun_control_init(lower = np.array([-1]),</span>
<span class="go">                                upper = np.array([1]),</span>
<span class="go">                                noise=False)</span>
<span class="go">    design_control=design_control_init(init_size=10)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control)</span>
<span class="go">    S.initialize_design()</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.surrogate.plot()</span>
<span class="go">    # 2-dimensional example</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control=fun_control_init(lower = np.array([-1, -1]),</span>
<span class="go">                                upper = np.array([1, 1]),</span>
<span class="go">                                noise=False)</span>
<span class="go">    design_control=design_control_init(init_size=10)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control)</span>
<span class="go">    S.initialize_design()</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.surrogate.plot()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">add_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots 1D and 2D surrogates.</span>
<span class="sd">    Only for compatibility with the old Kriging implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            The Kriging object.</span>
<span class="sd">        i (int):</span>
<span class="sd">            The index of the first variable to plot.</span>
<span class="sd">        j (int):</span>
<span class="sd">            The index of the second variable to plot.</span>
<span class="sd">        show (bool):</span>
<span class="sd">            If `True`, the plots are displayed.</span>
<span class="sd">            If `False`, `plt.show()` should be called outside this function.</span>
<span class="sd">        add_points (bool):</span>
<span class="sd">            If `True`, the points from the design are added to the plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Note:</span>
<span class="sd">        * This method provides only a basic plot. For more advanced plots,</span>
<span class="sd">            use the `plot_contour()` method of the `Spot` class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="sd">            # 1-dimensional example</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control=fun_control_init(lower = np.array([-1]),</span>
<span class="sd">                                        upper = np.array([1]),</span>
<span class="sd">                                        noise=False)</span>
<span class="sd">            design_control=design_control_init(init_size=10)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control)</span>
<span class="sd">            S.initialize_design()</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.surrogate.plot()</span>
<span class="sd">            # 2-dimensional example</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control=fun_control_init(lower = np.array([-1, -1]),</span>
<span class="sd">                                        upper = np.array([1, 1]),</span>
<span class="sd">                                        noise=False)</span>
<span class="sd">            design_control=design_control_init(init_size=10)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control)</span>
<span class="sd">            S.initialize_design()</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.surrogate.plot()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plotkd</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span> <span class="n">add_points</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.surrogate.kriging_temp.Kriging.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_val</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span></code>

<a href="#spotpython.surrogate.kriging_temp.Kriging.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Predicts the Kriging response at a set of points X. This method is compatible with scikit-learn.
If &lsquo;approximation&rsquo; is set to &lsquo;nystroem&rsquo;, the input data X is first transformed using
the Nystrm components learned during fitting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape (n_samples, n_features) containing the points at which
to predict the Kriging response.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_std</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns the standard deviation of the predictions as well.
Implemented for compatibility with scikit-learn.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_val</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which prediction values to return.
It can be &ldquo;y&rdquo;, &ldquo;s&rdquo;, &ldquo;ei&rdquo;, or &ldquo;all&rdquo;.
Defaults to &ldquo;y&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
Predicted values of shape (n_samples,).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
If self.return_std is True, returns the standard deviations of the predictions
of shape (n_samples,).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.surrogate.kriging</span><span class="w"> </span><span class="kn">import</span> <span class="n">Kriging</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Training data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit the Kriging model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Kriging</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Predict responses</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="n">ei</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions:&quot;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/surrogate/kriging_temp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predicts the Kriging response at a set of points X. This method is compatible with scikit-learn.</span>
<span class="sd">    If &#39;approximation&#39; is set to &#39;nystroem&#39;, the input data X is first transformed using</span>
<span class="sd">    the Nystrm components learned during fitting.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            Array of shape (n_samples, n_features) containing the points at which</span>
<span class="sd">            to predict the Kriging response.</span>
<span class="sd">        return_std (bool, optional):</span>
<span class="sd">            If True, returns the standard deviation of the predictions as well.</span>
<span class="sd">            Implemented for compatibility with scikit-learn.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        return_val (str):</span>
<span class="sd">            Specifies which prediction values to return.</span>
<span class="sd">            It can be &quot;y&quot;, &quot;s&quot;, &quot;ei&quot;, or &quot;all&quot;.</span>
<span class="sd">            Defaults to &quot;y&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            Predicted values of shape (n_samples,).</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            If self.return_std is True, returns the standard deviations of the predictions</span>
<span class="sd">            of shape (n_samples,).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.surrogate.kriging import Kriging</span>
<span class="sd">        &gt;&gt;&gt; # Training data</span>
<span class="sd">        &gt;&gt;&gt; X_train = np.array([[0.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">        &gt;&gt;&gt; y_train = np.array([0.1, 0.2, 0.3])</span>
<span class="sd">        &gt;&gt;&gt; # Fit the Kriging model</span>
<span class="sd">        &gt;&gt;&gt; model = Kriging().fit(X_train, y_train)</span>
<span class="sd">        &gt;&gt;&gt; # Test data</span>
<span class="sd">        &gt;&gt;&gt; X_test = np.array([[0.25, 0.25], [0.75, 0.75]])</span>
<span class="sd">        &gt;&gt;&gt; # Predict responses</span>
<span class="sd">        &gt;&gt;&gt; y_pred, sd, ei = model.predict(X_test)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Predictions:&quot;, y_pred)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_pred_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximation</span> <span class="o">==</span> <span class="s2">&quot;nystroem&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Kriging model with Nystrm approximation is not fitted yet. Call fit() first.&quot;</span><span class="p">)</span>

        <span class="c1"># Use the same initial theta for Nystrm kernel computation as in fit()</span>
        <span class="n">initial_theta_for_nystroem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_kriging</span><span class="p">))</span>

        <span class="c1"># Transform prediction points using the fitted Nystrm components</span>
        <span class="n">K_test_subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_kernel_matrix_for_original_features</span><span class="p">(</span><span class="n">X_pred_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_X_subset</span><span class="p">,</span> <span class="n">initial_theta_for_nystroem</span><span class="p">)</span>
        <span class="n">X_pred_for_kriging</span> <span class="o">=</span> <span class="n">K_test_subset</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nystroem_components_sqrt_inv</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_pred_for_kriging</span> <span class="o">=</span> <span class="n">X_pred_orig</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>

    <span class="c1"># Original predict logic using X_pred_for_kriging</span>
    <span class="k">if</span> <span class="n">return_std</span><span class="p">:</span>
        <span class="c1"># Return predictions and standard deviations</span>
        <span class="c1"># Compatibility with scikit-learn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
        <span class="c1"># Return only standard deviations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="c1"># Return predictions, standard deviations, and expected improvements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">std_devs</span><span class="p">,</span> <span class="n">eis</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">std_devs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eis</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">return_val</span> <span class="o">==</span> <span class="s2">&quot;ei&quot;</span><span class="p">:</span>
        <span class="c1"># Return only neg. expected improvements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_ei</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">eis</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Return only predictions (case &quot;y&quot;)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pred</span><span class="p">(</span><span class="n">x_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">X_pred_for_kriging</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2004 - 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bartzbeielstein" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomas-bartz-beielstein-3157b541/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>