
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="spotpython - Sequential Parameter Optimization Toolbox in Python">
      
      
      
        <link rel="canonical" href="https://github.com/sequential-parameter-optimization/spotpython/reference/spotpython/spot/spot/">
      
      
        <link rel="prev" href="../../sklearn/traintest/">
      
      
        <link rel="next" href="../../surrogate/functions/forr08a/">
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>spot - spotpython</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotpython.spot.spot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotpython" class="md-header__button md-logo" aria-label="spotpython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotpython
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              spot
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotpython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../budget/ocba/" class="md-tabs__link">
          
  
  
    
  
  Code Reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-tabs__link">
        
  
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../download/" class="md-tabs__link">
        
  
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotpython" class="md-nav__button md-logo" aria-label="spotpython" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotpython
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotpython/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    spotpython
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            spotpython
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    budget
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            budget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../budget/ocba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ocba
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    build
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/kriging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build/surrogates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    surrogates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/california/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    california
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/california_housing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    california_housing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/csvdataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    csvdataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/diabetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    diabetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/friedman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    friedman
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightcrossvalidationdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lightcrossvalidationdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/lightdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lightdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/manydataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    manydataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/mnistdatamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mnistdatamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/pkldataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pkldataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/torchdata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torchdata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/vbdp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vbdp
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/clustered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    clustered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/designs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    designs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/factorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    factorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    grid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/poor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    poor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/random/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    random
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/sobol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sobol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/spacefilling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spacefilling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    fun
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            fun
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypersklearn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hypersklearn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hypertorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hypertorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/mohyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mohyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/multiobjectivefunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multiobjectivefunctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/objectivefunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    objectivefunctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/xai_hyperlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xai_hyperlight
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    gp
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            gp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/covar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    covar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/distances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    distances
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/gp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/gp_sep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gp_sep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/likelihood/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    likelihood
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/linalg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linalg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/lite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gp/util/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hyperdict
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            hyperdict
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/light_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    light_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/sklearn_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sklearn_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperdict/torch_hyper_dict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torch_hyper_dict
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hyperparameters
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            hyperparameters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/categorical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    categorical
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/listgenerator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    listgenerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    values
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9" id="__nav_2_1_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    light
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9">
            <span class="md-nav__icon md-icon"></span>
            light
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_1" id="__nav_2_1_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    classification
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_1">
            <span class="md-nav__icon md-icon"></span>
            classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/classification/netlightbasemapk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netlightbasemapk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/classification/nn_funnel_classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_funnel_classifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_2" id="__nav_2_1_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_2">
            <span class="md-nav__icon md-icon"></span>
            cnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/googlenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    googlenet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/inceptionblock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    inceptionblock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cnn/netcnnbase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcnnbase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/cvmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cvmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/litmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    litmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/loadmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    loadmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/predictmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    predictmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_7" id="__nav_2_1_9_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    regression
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            regression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/netlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_condnet_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_condnet_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_funnel_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_funnel_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_linear_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_linear_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_gru_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_gru_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_lstm_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_lstm_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_many_to_many_rnn_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_many_to_many_rnn_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_resnet_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_resnet_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/nn_transformer_regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nn_transformer_regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/pos_enc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pos_enc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/rnnlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rnnlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/regression/transformerlightregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transformerlightregression
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/testmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    testmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/trainmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trainmodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9_10" id="__nav_2_1_9_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    transformer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_9_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9_10">
            <span class="md-nav__icon md-icon"></span>
            transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    encoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/encoderblock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    encoderblock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/multiheadattention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multiheadattention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    positionalEncoding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/positionalEncodingBasic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    positionalEncodingBasic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/skiplinear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    skiplinear
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../light/transformer/transformerlightpredictor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transformerlightpredictor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_10" id="__nav_2_1_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    mo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_10">
            <span class="md-nav__icon md-icon"></span>
            mo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/pareto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pareto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mo/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11" id="__nav_2_1_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pinns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11">
            <span class="md-nav__icon md-icon"></span>
            pinns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11_1" id="__nav_2_1_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    nn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11_1">
            <span class="md-nav__icon md-icon"></span>
            nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/nn/fcn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fcn
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11_2" id="__nav_2_1_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11_2">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/plot/result/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    result
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pinns/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    solvers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_12" >
        
          
          <label class="md-nav__link" for="__nav_2_1_12" id="__nav_2_1_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_12">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/contour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    contour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/importance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/ts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/xai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xai
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/xy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" >
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    sklearn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/traintest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traintest
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_14" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_14" id="__nav_2_1_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    spot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_14">
            <span class="md-nav__icon md-icon"></span>
            spot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    spot
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    spot
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotpython.spot.spot" class="md-nav__link">
    <span class="md-ellipsis">
      spot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot" class="md-nav__link">
    <span class="md-ellipsis">
      Spot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.chg" class="md-nav__link">
    <span class="md-ellipsis">
      chg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.evaluate_initial_design" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_initial_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.fit_surrogate" class="md-nav__link">
    <span class="md-ellipsis">
      fit_surrogate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.generate_design" class="md-nav__link">
    <span class="md-ellipsis">
      generate_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.generate_random_point" class="md-nav__link">
    <span class="md-ellipsis">
      generate_random_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_importance" class="md-nav__link">
    <span class="md-ellipsis">
      get_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_new_X0" class="md-nav__link">
    <span class="md-ellipsis">
      get_new_X0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_spot_attributes_as_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_spot_attributes_as_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_tuned_hyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_tuned_hyperparameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.infill" class="md-nav__link">
    <span class="md-ellipsis">
      infill
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.initialize_design" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.initialize_design_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_design_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.parallel_plot" class="md-nav__link">
    <span class="md-ellipsis">
      parallel_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_contour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_importance" class="md-nav__link">
    <span class="md-ellipsis">
      plot_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_important_hyperparameter_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_important_hyperparameter_contour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_model" class="md-nav__link">
    <span class="md-ellipsis">
      plot_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_progress" class="md-nav__link">
    <span class="md-ellipsis">
      plot_progress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.prepare_plot" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.print_importance" class="md-nav__link">
    <span class="md-ellipsis">
      print_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.process_z00" class="md-nav__link">
    <span class="md-ellipsis">
      process_z00
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.save_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      save_experiment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.save_result" class="md-nav__link">
    <span class="md-ellipsis">
      save_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.set_de_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      set_de_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.show_progress_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      show_progress_if_needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.suggest_new_X" class="md-nav__link">
    <span class="md-ellipsis">
      suggest_new_X
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.surrogate_setup" class="md-nav__link">
    <span class="md-ellipsis">
      surrogate_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_all_dim" class="md-nav__link">
    <span class="md-ellipsis">
      to_all_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_all_dim_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      to_all_dim_if_needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_red_dim" class="md-nav__link">
    <span class="md-ellipsis">
      to_red_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.update_design" class="md-nav__link">
    <span class="md-ellipsis">
      update_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.update_stats" class="md-nav__link">
    <span class="md-ellipsis">
      update_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.write_initial_tensorboard_log" class="md-nav__link">
    <span class="md-ellipsis">
      write_initial_tensorboard_log
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_15" >
        
          
          <label class="md-nav__link" for="__nav_2_1_15" id="__nav_2_1_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    surrogate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_15">
            <span class="md-nav__icon md-icon"></span>
            surrogate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_15_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_15_1" id="__nav_2_1_15_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_15_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_15_1">
            <span class="md-nav__icon md-icon"></span>
            functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../surrogate/functions/forr08a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    forr08a
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../surrogate/kriging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../surrogate/kriging_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging_basic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../surrogate/kriging_ny/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kriging_ny
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../surrogate/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_16" >
        
          
          <label class="md-nav__link" for="__nav_2_1_16" id="__nav_2_1_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    torch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_16">
            <span class="md-nav__icon md-icon"></span>
            torch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/activation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    activation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/cosinewarmupcheduler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cosinewarmupcheduler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/dataframedataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dataframedataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/dimensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dimensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/mapk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mapk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcifar10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcifar10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netcore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netcore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netfashionMNIST/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netfashionMNIST
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netregression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netregression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/netvbdp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    netvbdp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../torch/traintest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traintest
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_17" >
        
          
          <label class="md-nav__link" for="__nav_2_1_17" id="__nav_2_1_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    uc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_17">
            <span class="md-nav__icon md-icon"></span>
            uc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../uc/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_18" >
        
          
          <label class="md-nav__link" for="__nav_2_1_18" id="__nav_2_1_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_18">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/aggregate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aggregate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/compare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    compare
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/convert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    convert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/device/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    device
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    effects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/linalg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linalg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/numpy2json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    numpy2json
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optimize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    parallel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/pca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pca
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/preprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    preprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/progress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    progress
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/repair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    repair
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/scaler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scaler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/seed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    seed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/split/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    split
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/stats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/tensorboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tensorboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transform
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotpython.spot.spot" class="md-nav__link">
    <span class="md-ellipsis">
      spot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot" class="md-nav__link">
    <span class="md-ellipsis">
      Spot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.chg" class="md-nav__link">
    <span class="md-ellipsis">
      chg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.evaluate_initial_design" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_initial_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.fit_surrogate" class="md-nav__link">
    <span class="md-ellipsis">
      fit_surrogate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.generate_design" class="md-nav__link">
    <span class="md-ellipsis">
      generate_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.generate_random_point" class="md-nav__link">
    <span class="md-ellipsis">
      generate_random_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_importance" class="md-nav__link">
    <span class="md-ellipsis">
      get_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_new_X0" class="md-nav__link">
    <span class="md-ellipsis">
      get_new_X0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_spot_attributes_as_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_spot_attributes_as_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.get_tuned_hyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_tuned_hyperparameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.infill" class="md-nav__link">
    <span class="md-ellipsis">
      infill
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.initialize_design" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.initialize_design_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_design_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.parallel_plot" class="md-nav__link">
    <span class="md-ellipsis">
      parallel_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_contour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_importance" class="md-nav__link">
    <span class="md-ellipsis">
      plot_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_important_hyperparameter_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_important_hyperparameter_contour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_model" class="md-nav__link">
    <span class="md-ellipsis">
      plot_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.plot_progress" class="md-nav__link">
    <span class="md-ellipsis">
      plot_progress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.prepare_plot" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.print_importance" class="md-nav__link">
    <span class="md-ellipsis">
      print_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.process_z00" class="md-nav__link">
    <span class="md-ellipsis">
      process_z00
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.save_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      save_experiment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.save_result" class="md-nav__link">
    <span class="md-ellipsis">
      save_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.set_de_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      set_de_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.show_progress_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      show_progress_if_needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.suggest_new_X" class="md-nav__link">
    <span class="md-ellipsis">
      suggest_new_X
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.surrogate_setup" class="md-nav__link">
    <span class="md-ellipsis">
      surrogate_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_all_dim" class="md-nav__link">
    <span class="md-ellipsis">
      to_all_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_all_dim_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      to_all_dim_if_needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.to_red_dim" class="md-nav__link">
    <span class="md-ellipsis">
      to_red_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.update_design" class="md-nav__link">
    <span class="md-ellipsis">
      update_design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.update_stats" class="md-nav__link">
    <span class="md-ellipsis">
      update_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotpython.spot.spot.Spot.write_initial_tensorboard_log" class="md-nav__link">
    <span class="md-ellipsis">
      write_initial_tensorboard_log
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>spot</h1>

<div class="doc doc-object doc-module">



<a id="spotpython.spot.spot"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="spotpython.spot.spot.Spot" class="doc doc-heading">
            <code>Spot</code>


<a href="#spotpython.spot.spot.Spot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Spot base class to handle the following tasks in a uniform manner:</p>
<ul>
<li>Getting and setting parameters. This is done via the <code>Spot</code> initialization.</li>
<li>Running surrogate based hyperparameter optimization. After the class is initialized, hyperparameter tuning
runs can be performed via the <code>run</code> method.</li>
<li>Displaying information. The <code>plot</code> method can be used for visualizing results. The <code>print</code> methods summarizes
information about the tuning run.</li>
</ul>
<p>The <code>Spot</code> class is built in a modular manner. It combines the following components:</p>
<pre><code>1. Fun (objective function)
2. Design (experimental design)
3. Optimizer to be used on the surrogate model
4. Surrogate (model)
</code></pre>
<p>For each of the components different implementations can be selected and combined.
Internal components are selected as default.
These can be replaced by components from other packages, e.g., scikit-learn or scikit-optimize.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>objective function</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fun_control</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>objective function information stored as a dictionary.
Default value is <code>fun_control_init()</code>.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="fun_control_init(_L_in=None, _L_out=None, _L_cond=None, _torchmetric=None, PREFIX=None, TENSORBOARD_CLEAN=False, accelerator='auto', check_finite=True, collate_fn_name=None, converters=None, core_model=None, core_model_name=None, data=None, data_full_train=None, divergence_threshold=None, hacky=False, data_val=None, data_dir='./data', data_module=None, data_set=None, data_set_name=None, data_test=None, db_dict_name=None, design=None, device=None, devices='auto', enable_progress_bar=False, EXPERIMENT_NAME=None, eval=None, force_run=True, fun_evals=15, fun_mo2so=None, fun_repeats=1, horizon=None, hyperdict=None, infill_criterion='y', log_every_n_steps=50, log_level=50, lower=None, max_time=1, max_surrogate_points=30, metric_sklearn=None, metric_sklearn_name=None, noise=False, n_points=1, n_samples=None, num_sanity_val_steps=2, n_total=None, num_workers=0, num_nodes=1, ocba_delta=0, oml_grace_period=None, optimizer=None, penalty_NA=None, precision='32', prep_model=None, prep_model_name=None, progress_file=None, save_experiment=False, save_result=True, scaler=None, scaler_name=None, scenario=None, seed=123, show_config=False, show_models=False, show_progress=True, shuffle=None, shuffle_train=True, shuffle_val=False, shuffle_test=False, sigma=0.0, stopping_threshold=None, strategy='auto', surrogate=None, target_column=None, target_type=None, task=None, tensorboard_log=False, tensorboard_start=False, tensorboard_stop=False, test=None, test_seed=1234, test_size=0.4, tkagg=False, train=None, tolerance_x=0, upper=None, var_name=None, var_type=['num'], verbosity=0, weights=1.0, weight_coeff=0.0, weights_entry=None) (spotpython.utils.init.fun_control_init)" href="../../utils/init/#spotpython.utils.init.fun_control_init">fun_control_init</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>experimental design. If <code>None</code>, spotpython&rsquo;s <code>SpaceFilling</code> is used.
Default value is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design_control</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>experimental design information stored as a dictionary.
Default value is <code>design_control_init()</code>.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="design_control_init(init_size=10, repeats=1) (spotpython.utils.init.design_control_init)" href="../../utils/init/#spotpython.utils.init.design_control_init">design_control_init</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optimizer on the surrogate. If <code>None</code>, <code>scipy.optimize</code>&rsquo;s <code>differential_evolution</code> is used.
Default value is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer_control</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>information about the optimizer stored as a dictionary.
Default value is <code>optimizer_control_init()</code>.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="optimizer_control_init(max_iter=1000, seed=125) (spotpython.utils.init.optimizer_control_init)" href="../../utils/init/#spotpython.utils.init.optimizer_control_init">optimizer_control_init</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>surrogate</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>surrogate model. If <code>None</code>, spotpython&rsquo;s <code>Kriging</code> is used. Default value is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>surrogate_control</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>surrogate model information stored as a dictionary.
Default value is <code>surrogate_control_init()</code>.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="surrogate_control_init(log_level=50, method='regression', model_optimizer=differential_evolution, model_fun_evals=10000, min_theta=-3.0, max_theta=2.0, isotropic=False, p_val=2.0, n_p=1, optim_p=False, min_Lambda=-9, max_Lambda=0, seed=124, theta_init_zero=False, var_type=None, metric_factorial='canberra') (spotpython.utils.init.surrogate_control_init)" href="../../utils/init/#spotpython.utils.init.surrogate_control_init">surrogate_control_init</a>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Description in the source code refers to [bart21i]:
Bartz-Beielstein, T., and Zaefferer, M. Hyperparameter tuning approaches.
In Hyperparameter Tuning for Machine and Deep Learning with R - A Practical Guide,
E. Bartz, T. Bartz-Beielstein, M. Zaefferer, and O. Mersmann, Eds. Springer, 2022, ch. 4, pp. 67114.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from math import inf</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init,</span>
<span class="go">        design_control_init,</span>
<span class="go">        surrogate_control_init,</span>
<span class="go">        optimizer_control_init)</span>
<span class="go">    def objective_function(X, fun_control=None):</span>
<span class="go">        if not isinstance(X, np.ndarray):</span>
<span class="go">            X = np.array(X)</span>
<span class="go">        if X.shape[1] != 2:</span>
<span class="go">            raise Exception</span>
<span class="go">        x0 = X[:, 0]</span>
<span class="go">        x1 = X[:, 1]</span>
<span class="go">        y = x0**2 + 10*x1**2</span>
<span class="go">        return y</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">                lower = np.array([0, 0]),</span>
<span class="go">                upper = np.array([10, 10]),</span>
<span class="go">                fun_evals=8,</span>
<span class="go">                fun_repeats=1,</span>
<span class="go">                max_time=inf,</span>
<span class="go">                noise=False,</span>
<span class="go">                tolerance_x=0,</span>
<span class="go">                ocba_delta=0,</span>
<span class="go">                var_type=[&quot;num&quot;, &quot;num&quot;],</span>
<span class="go">                infill_criterion=&quot;ei&quot;,</span>
<span class="go">                n_points=1,</span>
<span class="go">                seed=123,</span>
<span class="go">                log_level=20,</span>
<span class="go">                show_models=False,</span>
<span class="go">                show_progress=True)</span>
<span class="go">    design_control = design_control_init(</span>
<span class="go">                init_size=5,</span>
<span class="go">                repeats=1)</span>
<span class="go">    surrogate_control = surrogate_control_init(</span>
<span class="go">                model_optimizer=differential_evolution,</span>
<span class="go">                model_fun_evals=10000,</span>
<span class="go">                min_theta=-3,</span>
<span class="go">                max_theta=3,</span>
<span class="go">                theta_init_zero=False,</span>
<span class="go">                n_p=1,</span>
<span class="go">                optim_p=False,</span>
<span class="go">                var_type=[&quot;num&quot;, &quot;num&quot;],</span>
<span class="go">                metric_factorial=&quot;canberra&quot;,</span>
<span class="go">                seed=124)</span>
<span class="go">    optimizer_control = optimizer_control_init(</span>
<span class="go">                max_iter=1000,</span>
<span class="go">                seed=125)</span>
<span class="go">    spot = spot.Spot(fun=objective_function,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,</span>
<span class="go">                surrogate_control=surrogate_control,</span>
<span class="go">                optimizer_control=optimizer_control)</span>
<span class="go">    spot.run()</span>
<span class="go">    spot.plot_progress()</span>
<span class="go">    spot.plot_contour(i=0, j=1)</span>
<span class="go">    spot.plot_importance()</span>
</code></pre></div>








              <details class="quote">
                <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Spot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spot base class to handle the following tasks in a uniform manner:</span>

<span class="sd">    * Getting and setting parameters. This is done via the `Spot` initialization.</span>
<span class="sd">    * Running surrogate based hyperparameter optimization. After the class is initialized, hyperparameter tuning</span>
<span class="sd">    runs can be performed via the `run` method.</span>
<span class="sd">    * Displaying information. The `plot` method can be used for visualizing results. The `print` methods summarizes</span>
<span class="sd">    information about the tuning run.</span>

<span class="sd">    The `Spot` class is built in a modular manner. It combines the following components:</span>

<span class="sd">        1. Fun (objective function)</span>
<span class="sd">        2. Design (experimental design)</span>
<span class="sd">        3. Optimizer to be used on the surrogate model</span>
<span class="sd">        4. Surrogate (model)</span>

<span class="sd">    For each of the components different implementations can be selected and combined.</span>
<span class="sd">    Internal components are selected as default.</span>
<span class="sd">    These can be replaced by components from other packages, e.g., scikit-learn or scikit-optimize.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun (Callable):</span>
<span class="sd">            objective function</span>
<span class="sd">        fun_control (Dict[str, Union[int, float]]):</span>
<span class="sd">            objective function information stored as a dictionary.</span>
<span class="sd">            Default value is `fun_control_init()`.</span>
<span class="sd">        design (object):</span>
<span class="sd">            experimental design. If `None`, spotpython&#39;s `SpaceFilling` is used.</span>
<span class="sd">            Default value is `None`.</span>
<span class="sd">        design_control (Dict[str, Union[int, float]]):</span>
<span class="sd">            experimental design information stored as a dictionary.</span>
<span class="sd">            Default value is `design_control_init()`.</span>
<span class="sd">        optimizer (object):</span>
<span class="sd">            optimizer on the surrogate. If `None`, `scipy.optimize`&#39;s `differential_evolution` is used.</span>
<span class="sd">            Default value is `None`.</span>
<span class="sd">        optimizer_control (Dict[str, Union[int, float]]):</span>
<span class="sd">            information about the optimizer stored as a dictionary.</span>
<span class="sd">            Default value is `optimizer_control_init()`.</span>
<span class="sd">        surrogate (object):</span>
<span class="sd">            surrogate model. If `None`, spotpython&#39;s `Kriging` is used. Default value is `None`.</span>
<span class="sd">        surrogate_control (Dict[str, Union[int, float]]):</span>
<span class="sd">            surrogate model information stored as a dictionary.</span>
<span class="sd">            Default value is `surrogate_control_init()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>

<span class="sd">    Note:</span>
<span class="sd">        Description in the source code refers to [bart21i]:</span>
<span class="sd">        Bartz-Beielstein, T., and Zaefferer, M. Hyperparameter tuning approaches.</span>
<span class="sd">        In Hyperparameter Tuning for Machine and Deep Learning with R - A Practical Guide,</span>
<span class="sd">        E. Bartz, T. Bartz-Beielstein, M. Zaefferer, and O. Mersmann, Eds. Springer, 2022, ch. 4, pp. 67114.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from math import inf</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init,</span>
<span class="sd">                design_control_init,</span>
<span class="sd">                surrogate_control_init,</span>
<span class="sd">                optimizer_control_init)</span>
<span class="sd">            def objective_function(X, fun_control=None):</span>
<span class="sd">                if not isinstance(X, np.ndarray):</span>
<span class="sd">                    X = np.array(X)</span>
<span class="sd">                if X.shape[1] != 2:</span>
<span class="sd">                    raise Exception</span>
<span class="sd">                x0 = X[:, 0]</span>
<span class="sd">                x1 = X[:, 1]</span>
<span class="sd">                y = x0**2 + 10*x1**2</span>
<span class="sd">                return y</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                        lower = np.array([0, 0]),</span>
<span class="sd">                        upper = np.array([10, 10]),</span>
<span class="sd">                        fun_evals=8,</span>
<span class="sd">                        fun_repeats=1,</span>
<span class="sd">                        max_time=inf,</span>
<span class="sd">                        noise=False,</span>
<span class="sd">                        tolerance_x=0,</span>
<span class="sd">                        ocba_delta=0,</span>
<span class="sd">                        var_type=[&quot;num&quot;, &quot;num&quot;],</span>
<span class="sd">                        infill_criterion=&quot;ei&quot;,</span>
<span class="sd">                        n_points=1,</span>
<span class="sd">                        seed=123,</span>
<span class="sd">                        log_level=20,</span>
<span class="sd">                        show_models=False,</span>
<span class="sd">                        show_progress=True)</span>
<span class="sd">            design_control = design_control_init(</span>
<span class="sd">                        init_size=5,</span>
<span class="sd">                        repeats=1)</span>
<span class="sd">            surrogate_control = surrogate_control_init(</span>
<span class="sd">                        model_optimizer=differential_evolution,</span>
<span class="sd">                        model_fun_evals=10000,</span>
<span class="sd">                        min_theta=-3,</span>
<span class="sd">                        max_theta=3,</span>
<span class="sd">                        theta_init_zero=False,</span>
<span class="sd">                        n_p=1,</span>
<span class="sd">                        optim_p=False,</span>
<span class="sd">                        var_type=[&quot;num&quot;, &quot;num&quot;],</span>
<span class="sd">                        metric_factorial=&quot;canberra&quot;,</span>
<span class="sd">                        seed=124)</span>
<span class="sd">            optimizer_control = optimizer_control_init(</span>
<span class="sd">                        max_iter=1000,</span>
<span class="sd">                        seed=125)</span>
<span class="sd">            spot = spot.Spot(fun=objective_function,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">                        surrogate_control=surrogate_control,</span>
<span class="sd">                        optimizer_control=optimizer_control)</span>
<span class="sd">            spot.run()</span>
<span class="sd">            spot.plot_progress()</span>
<span class="sd">            spot.plot_contour(i=0, j=1)</span>
<span class="sd">            spot.plot_importance()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">design</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">design_control</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">design_control_init</span><span class="p">(),</span>
        <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fun_control</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">fun_control_init</span><span class="p">(),</span>
        <span class="n">optimizer</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">optimizer_control</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">optimizer_control_init</span><span class="p">(),</span>
        <span class="n">surrogate</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">surrogate_control</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">surrogate_control_init</span><span class="p">(),</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span> <span class="o">=</span> <span class="n">fun_control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span> <span class="o">=</span> <span class="n">design_control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span> <span class="o">=</span> <span class="n">optimizer_control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span> <span class="o">=</span> <span class="n">surrogate_control</span>

        <span class="c1"># small value:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">spacing</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_fun</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_bounds_and_dim</span><span class="p">()</span>

        <span class="c1"># Random number generator:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">])</span>
        <span class="n">set_all_seeds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_var_type</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_var_name</span><span class="p">()</span>

        <span class="c1"># Reduce dim based on lower == upper logic:</span>
        <span class="c1"># modifies lower, upper, var_type, and var_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_red_dim</span><span class="p">()</span>

        <span class="c1"># Additional self attributes updates:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_additional_attributes</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_de_bounds</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_design_setup</span><span class="p">(</span><span class="n">design</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_setup</span><span class="p">(</span><span class="n">optimizer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surrogate_control_setup</span><span class="p">()</span>

        <span class="c1"># The writer (Tensorboard) must be initialized before the surrogate model,</span>
        <span class="c1"># because the writer is passed to the surrogate model:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_spot_writer</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_setup</span><span class="p">(</span><span class="n">surrogate</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;save_experiment&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_experiment</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the logger at level </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="si">}</span><span class="s2"> for module </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() init(): fun_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() init(): design_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() init(): optimizer_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() init(): surrogate_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() init(): self.get_spot_attributes_as_df(): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spot_attributes_as_df</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_de_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the bounds for the differential evolution optimizer.</span>
<span class="sd">        The bounds are internal, because they are functions of self.lower and self.upper</span>
<span class="sd">        and used by the optimizer. They are stored in self.de_bounds as a list of lists,</span>
<span class="sd">        where each inner list contains the lower and upper bound for one dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower=np.array([-1, -1]),</span>
<span class="sd">                    upper=np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">                S = spot.Spot(fun=lambda x: x, fun_control=fun_control)</span>
<span class="sd">                S.set_de_bounds()</span>
<span class="sd">                print(S.de_bounds)</span>
<span class="sd">                [[-1, 1], [-1, 1]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">de_bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_bounds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the objective function.</span>

<span class="sd">        Args:</span>
<span class="sd">            fun (Callable): objective function</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: No objective function specified.</span>
<span class="sd">            Exception: Objective function is not callable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">fun</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No objective function specified.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Objective function is not callable.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_bounds_and_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the lower and upper bounds and the number of dimensions.</span>
<span class="sd">        These are based on the fun_control dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># lower attribute updates:</span>
        <span class="c1"># if lower is in the fun_control dictionary, use the value of the key &quot;lower&quot; as the lower bound</span>
        <span class="k">if</span> <span class="n">get_control_key_value</span><span class="p">(</span><span class="n">control_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="n">get_control_key_value</span><span class="p">(</span><span class="n">control_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
        <span class="c1"># Number of dimensions is based on lower</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">size</span>

        <span class="c1"># upper attribute updates:</span>
        <span class="c1"># if upper is in fun_control dictionary, use the value of the key &quot;upper&quot; as the upper bound</span>
        <span class="k">if</span> <span class="n">get_control_key_value</span><span class="p">(</span><span class="n">control_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="n">get_control_key_value</span><span class="p">(</span><span class="n">control_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_var_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the variable types based on the fun_control dictionary.</span>
<span class="sd">        If the variable types are not specified,</span>
<span class="sd">        all variable types are forced to &#39;num&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;var_type&quot;</span><span class="p">]</span>
        <span class="c1"># Force numeric type as default in every dim:</span>
        <span class="c1"># assume all variable types are &quot;num&quot; if &quot;num&quot; is</span>
        <span class="c1"># specified less than k times</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;All variable types forced to &#39;num&#39;.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_var_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the variable names based on the fun_control dictionary.</span>
<span class="sd">        If the variable names are not specified,</span>
<span class="sd">        all variable names are set to x0, x1, x2, ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;var_name&quot;</span><span class="p">]</span>
        <span class="c1"># use x0, x1, ... as default variable names:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">))]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_additional_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set additional attributes based on the fun_control dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;fun_evals&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_repeats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;fun_repeats&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;max_time&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;noise&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;tolerance_x&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;ocba_delta&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;log_level&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;show_models&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;show_progress&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infill_criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;infill_criterion&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;n_points&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_surrogate_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;max_surrogate_points&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;progress_file&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tkagg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;tkagg&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tkagg</span><span class="p">:</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;verbosity&quot;</span><span class="p">]</span>

        <span class="c1"># Internal attributes:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Logging information:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_design_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">design</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Design related information:</span>
<span class="sd">        If no design is specified, use the internal spacefilling design.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">design</span> <span class="o">=</span> <span class="n">design</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">design</span> <span class="o">=</span> <span class="n">SpaceFilling</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_optimizer_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Optimizer setup. If no optimizer is specified, use Differential Evolution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">differential_evolution</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_surrogate_control_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;var_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">})</span>
        <span class="c1"># Surrogate control updates:</span>
        <span class="c1"># The default value for `method` from the surrogate_control dictionary</span>
        <span class="c1"># based on surrogate_control.init() is None. This value is updated</span>
        <span class="c1"># to the value of the key &quot;method&quot; from the fun_control dictionary.</span>
        <span class="c1"># If the value is set (i.e., not None), it is not updated.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">method</span><span class="p">})</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_fun_evals&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;model_fun_evals&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;max_iter&quot;</span><span class="p">]})</span>
        <span class="c1"># self.optimizer is not None here. If 1) the key &quot;model_optimizer&quot;</span>
        <span class="c1"># is still None or 2) a user specified optimizer is provided, update the value of</span>
        <span class="c1"># the key &quot;model_optimizer&quot; to the value of self.optimizer.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_optimizer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;model_optimizer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">surrogate_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surrogate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the surrogate model for the optimization process.</span>
<span class="sd">        This method initializes the surrogate model. If no surrogate model is provided,</span>
<span class="sd">        it creates an internal Kriging surrogate with parameters specified in surrogate_control.</span>

<span class="sd">        Args:</span>
<span class="sd">            surrogate (object, optional):</span>
<span class="sd">                A surrogate model object. If None, an internal Kriging model is created.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Note:</span>
<span class="sd">            If no surrogate is provided, a Kriging model is initialized with the following parameters</span>
<span class="sd">            from surrogate_control:</span>
<span class="sd">                - method: The Kriging method (e.g., &quot;interpolation&quot; or &quot;regression&quot;)</span>
<span class="sd">                - var_type: Variable types for each dimension</span>
<span class="sd">                - seed: Random seed for reproducibility</span>
<span class="sd">                - model_optimizer: Optimizer for model parameter tuning</span>
<span class="sd">                - model_fun_evals: Number of function evaluations for model optimization</span>
<span class="sd">                - min/max_theta: Bounds for theta parameters</span>
<span class="sd">                - theta_init_zero: Whether to initialize theta at zero</span>
<span class="sd">                - p_val: Power parameter p value</span>
<span class="sd">                - n_p: Number of p parameters</span>
<span class="sd">                - optim_p: Whether to optimize p parameters</span>
<span class="sd">                - min/max_Lambda: Bounds for lambda parameters</span>
<span class="sd">                - metric_factorial: Metric for factorial parameters</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.spot import spot</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.utils.init import (</span>
<span class="sd">            ...     fun_control_init,</span>
<span class="sd">            ...     surrogate_control_init,</span>
<span class="sd">            ...     design_control_init</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Setup with default Kriging surrogate</span>
<span class="sd">            &gt;&gt;&gt; fun_control = fun_control_init(</span>
<span class="sd">            ...     lower=np.array([-1, -1]),</span>
<span class="sd">            ...     upper=np.array([1, 1])</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">            ...     method=&quot;interpolation&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; S = spot.Spot(</span>
<span class="sd">            ...     fun=Analytical().fun_sphere,</span>
<span class="sd">            ...     fun_control=fun_control,</span>
<span class="sd">            ...     surrogate_control=surrogate_control</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; print(S.surrogate.isotropic)</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; # Setup with custom surrogate</span>
<span class="sd">            &gt;&gt;&gt; from sklearn.gaussian_process import GaussianProcessRegressor</span>
<span class="sd">            &gt;&gt;&gt; custom_surrogate = GaussianProcessRegressor()</span>
<span class="sd">            &gt;&gt;&gt; S2 = spot.Spot(</span>
<span class="sd">            ...     fun=Analytical().fun_sphere,</span>
<span class="sd">            ...     fun_control=fun_control,</span>
<span class="sd">            ...     surrogate=custom_surrogate</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; print(type(S2.surrogate).__name__)</span>
<span class="sd">            &#39;GaussianProcessRegressor&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Surrogate related information:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="o">=</span> <span class="n">surrogate</span>
        <span class="c1"># If no surrogate model is specified, use the internal</span>
        <span class="c1"># spotpython Kriging surrogate:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Call kriging with surrogate_control parameters:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="o">=</span> <span class="n">Kriging</span><span class="p">(</span>
                <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span>
                <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;var_type&quot;</span><span class="p">],</span>
                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
                <span class="n">model_optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_optimizer&quot;</span><span class="p">],</span>
                <span class="n">model_fun_evals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_fun_evals&quot;</span><span class="p">],</span>
                <span class="n">min_theta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;min_theta&quot;</span><span class="p">],</span>
                <span class="n">max_theta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;max_theta&quot;</span><span class="p">],</span>
                <span class="n">isotropic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;isotropic&quot;</span><span class="p">],</span>
                <span class="n">theta_init_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;theta_init_zero&quot;</span><span class="p">],</span>
                <span class="n">p_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;p_val&quot;</span><span class="p">],</span>
                <span class="n">n_p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;n_p&quot;</span><span class="p">],</span>
                <span class="n">optim_p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;optim_p&quot;</span><span class="p">],</span>
                <span class="n">min_Lambda</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;min_Lambda&quot;</span><span class="p">],</span>
                <span class="n">max_Lambda</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;max_Lambda&quot;</span><span class="p">],</span>
                <span class="n">log_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">,</span>
                <span class="n">spot_writer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="p">,</span>
                <span class="n">counter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">metric_factorial</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;metric_factorial&quot;</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_spot_attributes_as_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all attributes of the spot object as a pandas dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (pandas.DataFrame): dataframe with all attributes of the spot object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from math import inf</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 7</span>
<span class="sd">                # number of points</span>
<span class="sd">                n = 10</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1]),</span>
<span class="sd">                    upper = np.array([1]),</span>
<span class="sd">                    fun_evals=n)</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                spot_1 = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                spot_1.run()</span>
<span class="sd">                df = spot_1.get_spot_attributes_as_df()</span>
<span class="sd">            df</span>
<span class="sd">                df</span>
<span class="sd">                    Attribute Name                                    Attribute Value</span>
<span class="sd">                0                   X  [[-0.3378148180708981], [0.698908280342222], [...</span>
<span class="sd">                1           all_lower                                               [-1]</span>
<span class="sd">                2           all_upper                                                [1]</span>
<span class="sd">                3        all_var_name                                               [x0]</span>
<span class="sd">                4        all_var_type                                              [num]</span>
<span class="sd">                5             counter                                                 10</span>
<span class="sd">                6           de_bounds                                          [[-1, 1]]</span>
<span class="sd">                7              design  &lt;spotpython.design.spacefilling.SpaceFilling o...</span>
<span class="sd">                8      design_control                     {&#39;init_size&#39;: 7, &#39;repeats&#39;: 1}</span>
<span class="sd">                9                 eps                                                0.0</span>
<span class="sd">                10        fun_control                         {&#39;sigma&#39;: 0, &#39;seed&#39;: None}</span>
<span class="sd">                11          fun_evals                                                 10</span>
<span class="sd">                12        fun_repeats                                                  1</span>
<span class="sd">                13              ident                                            [False]</span>
<span class="sd">                14   infill_criterion                                                  y</span>
<span class="sd">                15                  k                                                  1</span>
<span class="sd">                16          log_level                                                 50</span>
<span class="sd">                17              lower                                               [-1]</span>
<span class="sd">                18           max_time                                                inf</span>
<span class="sd">                19             mean_X                                               None</span>
<span class="sd">                20             mean_y                                               None</span>
<span class="sd">                21              min_X                           [1.5392206722432657e-05]</span>
<span class="sd">                22         min_mean_X                                               None</span>
<span class="sd">                23         min_mean_y                                               None</span>
<span class="sd">                24              min_y                                                0.0</span>
<span class="sd">                25           n_points                                                  1</span>
<span class="sd">                26              noise                                               True</span>
<span class="sd">                27         ocba_delta                                                  0</span>
<span class="sd">                28  optimizer_control                    {&#39;max_iter&#39;: 1000, &#39;seed&#39;: 125}</span>
<span class="sd">                29            red_dim                                              False</span>
<span class="sd">                30                rng                                   Generator(PCG64)</span>
<span class="sd">                31               seed                                                123</span>
<span class="sd">                32        show_models                                              False</span>
<span class="sd">                33      show_progress                                               True</span>
<span class="sd">                34        spot_writer                                               None</span>
<span class="sd">                35          surrogate  &lt;spotpython.surrogate.kriging.Kriging object at 0x...</span>
<span class="sd">                36  surrogate_control  {&#39;method&#39;: &quot;regession&quot;, &#39;model_optimizer&#39;: &lt;function ...</span>
<span class="sd">                37        tolerance_x                                                  0</span>
<span class="sd">                38              upper                                                [1]</span>
<span class="sd">                39           var_name                                               [x0]</span>
<span class="sd">                40           var_type                                              [num]</span>
<span class="sd">                41              var_y                                               None</span>
<span class="sd">                42                  y  [0.11411885130827397, 0.48847278433092195, 0.0...</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Attribute Name&quot;</span><span class="p">:</span> <span class="n">attributes</span><span class="p">,</span> <span class="s2">&quot;Attribute Value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_red_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduces the dimensionality of the optimization problem by removing dimensions</span>
<span class="sd">        where lower and upper bounds are equal, indicating that those variables are fixed.</span>
<span class="sd">        This function modifies the lower bounds, upper bounds, variable types, and variable names</span>
<span class="sd">        by filtering out the non-varying dimensions. If any dimension is reduced, the `red_dim` attribute</span>
<span class="sd">        is set to True, and the count of dimensions (`k`) is updated accordingly.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.lower (numpy.ndarray):</span>
<span class="sd">                lower bound</span>
<span class="sd">            self.upper (numpy.ndarray):</span>
<span class="sd">                upper bound</span>
<span class="sd">            self.var_type (List[str]):</span>
<span class="sd">                list of variable types</span>
<span class="sd">            self.ident (numpy.ndarray):</span>
<span class="sd">                array of boolean values indicating fixed dimensions</span>
<span class="sd">            self.red_dim (bool):</span>
<span class="sd">                True if dimensions are reduced, False otherwise. Checks if any dimension is fixed.</span>
<span class="sd">            self.all_lower (numpy.ndarray):</span>
<span class="sd">                backup of the original lower bounds</span>
<span class="sd">            self.all_upper (numpy.ndarray):</span>
<span class="sd">                backup of the original upper bounds</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                lower = np.array([-1, -1, 0, 0])</span>
<span class="sd">                upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="sd">                fun_evals = 10</span>
<span class="sd">                var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">                var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="sd">                spot_instance = spot.Spot(</span>
<span class="sd">                    # Assuming Spot takes fun, fun_control, design_control as arguments</span>
<span class="sd">                    fun = Analytical().fun_sphere,  # Replace with appropriate function</span>
<span class="sd">                    fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals, show_progress=True, log_level=50),</span>
<span class="sd">                )</span>
<span class="sd">                spot_instance.var_type = var_type</span>
<span class="sd">                spot_instance.var_name = var_name</span>
<span class="sd">                spot_instance.to_red_dim()</span>
<span class="sd">                # Assert: Check if dimensions were reduced correctly</span>
<span class="sd">                assert spot_instance.lower.size == 2, &quot;Expected size of lower to be 2 after reduction&quot;</span>
<span class="sd">                assert spot_instance.upper.size == 2, &quot;Expected size of upper to be 2 after reduction&quot;</span>
<span class="sd">                assert len(spot_instance.var_type) == 2, &quot;Expected size of var_type to be 2 after reduction&quot;</span>
<span class="sd">                assert spot_instance.k == 2, &quot;Expected k to reflect the reduced dimensions&quot;</span>
<span class="sd">                # Check remaining values</span>
<span class="sd">                expected_lower = np.array([-1, 0])</span>
<span class="sd">                expected_upper = np.array([1, 5])</span>
<span class="sd">                expected_var_type = [&#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">                # there are two remaining variables, they are named x1 and x2</span>
<span class="sd">                expected_var_name = [&#39;x1&#39;, &#39;x2&#39;]</span>
<span class="sd">                np.testing.assert_array_equal(spot_instance.lower, expected_lower)</span>
<span class="sd">                np.testing.assert_array_equal(spot_instance.upper, expected_upper)</span>
<span class="sd">                assert spot_instance.var_type == expected_var_type</span>
<span class="sd">                assert spot_instance.var_name == expected_var_name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Backup of the original values:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span>
        <span class="c1"># Select only lower != upper:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="c1"># Determine if dimension is reduced:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">red_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="c1"># Modifications:</span>
        <span class="c1"># Modify lower and upper:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span>
        <span class="c1"># Modify k (number of dim):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">size</span>
        <span class="c1"># Filter out types and names corresponding to non-varying dimensions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">vtype</span> <span class="k">for</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">fixed</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">vname</span> <span class="k">for</span> <span class="n">vname</span><span class="p">,</span> <span class="n">fixed</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X0</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expands reduced-dimensional design points back to their full-dimensional representation</span>
<span class="sd">        by reinserting fixed values for dimensions that were removed during the dimensionality</span>
<span class="sd">        reduction process.</span>
<span class="sd">        When `to_red_dim()` is called, dimensions where the lower and upper bounds are equal are</span>
<span class="sd">        removed from the design points. `to_all_dim()` reverses this process by adding back these fixed</span>
<span class="sd">        dimensions with their respective fixed values.</span>

<span class="sd">        Args:</span>
<span class="sd">            X0 (numpy.ndarray): reduced dimension design points</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray): full dimension design points</span>

<span class="sd">        Atributes:</span>
<span class="sd">            self.ident (numpy.ndarray):</span>
<span class="sd">                array of boolean values indicating fixed dimensions</span>
<span class="sd">            self.all_lower (numpy.ndarray):</span>
<span class="sd">                backup of the original lower bounds.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                lower = np.array([-1, -1, 0, 0])</span>
<span class="sd">                upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="sd">                fun_evals = 10</span>
<span class="sd">                var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">                var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="sd">                spot_instance = spot.Spot(</span>
<span class="sd">                    fun = Analytical().fun_sphere,</span>
<span class="sd">                    fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals)</span>
<span class="sd">                )</span>
<span class="sd">                X0 = np.array([[2.5, 3.5], [4.5, 5.5]])</span>
<span class="sd">                X_full_dim = spot_instance.to_all_dim(X0)</span>
<span class="sd">                print(X_full_dim)</span>
<span class="sd">                    [[ 2.5 -1.   0.   3.5]</span>
<span class="sd">                    [ 4.5 -1.   0.   5.5]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Number of design points (samples):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Number of dimensions:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
        <span class="c1"># Initialize full dimension design points:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
        <span class="c1"># The following code was modified in 0.20.5:</span>
        <span class="c1"># Index for navigating X0&#39;s compressed dimension</span>
        <span class="n">reduced_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Iterate through each dimension, reconstructing full dimensionality</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="c1"># Assign fixed dimension values using stored lower bounds</span>
                <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_lower</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Assign variable dimension values from the reduced array</span>
                <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X0</span><span class="p">[:,</span> <span class="n">reduced_index</span><span class="p">]</span>
                <span class="c1"># Move to the next variable dimension in the compact X0 array</span>
                <span class="n">reduced_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_all_dim_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conditionally expand reduced-dimensional design points back to their full-dimensional representation,</span>
<span class="sd">        if dimensionality reduction was performed.</span>
<span class="sd">        This method checks whether dimensionality reduction occurred (i.e., whether some dimensions were</span>
<span class="sd">        fixed and thus removed). If so, it uses `to_all_dim()` to restore the full-dimensional representation</span>
<span class="sd">        by reinserting the fixed dimensions. Otherwise, it returns the input design points unaltered.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (np.ndarray): A 2D numpy array of shape (n, m), where `n` is the number of samples, and `m`</span>
<span class="sd">                            corresponds to the reduced or full number of dimensions depending on the</span>
<span class="sd">                            `red_dim` status.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: A 2D numpy array of shape (n, k). If `red_dim` is True, `k` will be the full number</span>
<span class="sd">                        of dimensions (including both fixed and variable). If `red_dim` is False, `k` is</span>
<span class="sd">                        identical to `m`.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.red_dim (bool): A boolean attribute indicating if dimensionality was reduced</span>
<span class="sd">                                (True if dimensions were reduced, False otherwise).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">red_dim</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_new_X0</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate new design points for the optimization process.</span>
<span class="sd">        This method attempts to suggest and repair new design points using the surrogate model</span>
<span class="sd">        and experimental design techniques. If no valid new points are found within the specified</span>
<span class="sd">        tolerance, a new experimental design is generated.</span>

<span class="sd">        Calls `suggest_new_X()` and repairs the new design points, e.g.,</span>
<span class="sd">        by `repair_non_numeric()` and `selectNew()`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: New design points, possibly repeated according to `self.fun_repeats`.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.design (object): An experimental design object used to generate new points</span>
<span class="sd">            self.n_points (int): The expected number of new points</span>
<span class="sd">            self.fun_repeats (int): The number of times to repeat new points</span>
<span class="sd">            self.tolerance_x (float): Minimum distance required between new and existing solutions</span>
<span class="sd">            self.var_type (List[str]): Variable types for the design points</span>
<span class="sd">            self.X (np.ndarray): Existing solution points</span>
<span class="sd">            self.k (int): Number of dimensions</span>
<span class="sd">            self.fun_control (Dict): Control parameters for the function</span>
<span class="sd">            self.counter (int): Iteration counter</span>

<span class="sd">        Notes:</span>
<span class="sd">            - If no new valid design points are suggested, the function resorts</span>
<span class="sd">              to a space-filling design technique to generate the required points.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init,  design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 3</span>
<span class="sd">                X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                            n_points=10,</span>
<span class="sd">                            ocba_delta=0,</span>
<span class="sd">                            lower = np.array([-1, -1]),</span>
<span class="sd">                            upper = np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,</span>
<span class="sd">                )</span>
<span class="sd">                S.initialize_design(X_start=X_start)</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                X0 = S.get_new_X0()</span>
<span class="sd">                assert X0.shape[0] == S.n_points</span>
<span class="sd">                assert X0.shape[1] == S.lower.size</span>
<span class="sd">                # assert new points are in the interval [lower, upper]</span>
<span class="sd">                assert np.all(X0 &gt;= S.lower)</span>
<span class="sd">                assert np.all(X0 &lt;= S.upper)</span>
<span class="sd">                # print using 20 digits precision</span>
<span class="sd">                np.set_printoptions(precision=20)</span>
<span class="sd">                print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">                X0: [[-0.43905273463270317 -0.20947824142606025]</span>
<span class="sd">                    [-0.4390526520612617  -0.20947735118625146]</span>
<span class="sd">                    [-0.4390526516559971  -0.20947735345727678]</span>
<span class="sd">                    [-0.4390526491133424  -0.20947735153559494]</span>
<span class="sd">                    [-0.43905264887606393 -0.209477347335596  ]</span>
<span class="sd">                    [-0.43905264815296263 -0.20947734884431773]</span>
<span class="sd">                    [-0.4390526481478378  -0.2094773501907511 ]</span>
<span class="sd">                    [-0.43905264791185933 -0.20947734931732975]</span>
<span class="sd">                    [-0.43905264783691894 -0.20947734910961185]</span>
<span class="sd">                    [-0.4390526473921517  -0.2094773511154602 ]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Try to generate self.fun_repeats new X0 points:</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggest_new_X</span><span class="p">()</span>
        <span class="c1"># Repair non-numeric variables based on their types</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="c1"># Condition: select only X0 that have min distance self.tolerance_x</span>
        <span class="c1"># to existing solutions</span>
        <span class="n">X0</span><span class="p">,</span> <span class="n">X0_ind</span> <span class="o">=</span> <span class="n">selectNew</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">X0</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance_x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If valid new points are found, repeat them as specified</span>
            <span class="c1"># There are X0 that fullfil the condition.</span>
            <span class="c1"># Note: The number of new X0 can be smaller than self.n_points!</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;XO values are new: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X0_ind</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">repeat</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_repeats</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># If no X0 found, then generate self.n_points new solutions:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">design</span> <span class="o">=</span> <span class="n">SpaceFilling</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
            <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">],</span> <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
            <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No new XO found on surrogate. Generate new solution </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">X0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Spot</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the surrogate based optimization.</span>
<span class="sd">        The optimization process is controlled by the following steps:</span>
<span class="sd">            1. Initialize design</span>
<span class="sd">            2. Update stats</span>
<span class="sd">            3. Fit surrogate</span>
<span class="sd">            4. Update design</span>
<span class="sd">            5. Update stats</span>
<span class="sd">            6. Update writer</span>
<span class="sd">            7. Fit surrogate</span>
<span class="sd">            8. Show progress if needed</span>

<span class="sd">        Args:</span>
<span class="sd">            X_start (numpy.ndarray, optional):</span>
<span class="sd">                initial design. The initial design must have shape (n, k), where n is the number of points and k is the number of dimensions. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spot: The `Spot` instance configured and updated based on the optimization process.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 7</span>
<span class="sd">                # start point X_0</span>
<span class="sd">                X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1]))</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                S = Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.run(X_start=X_start)</span>
<span class="sd">                    spotpython tuning: 0.0 [########--] 80.00%</span>
<span class="sd">                    spotpython tuning: 0.0 [#########-] 86.67%</span>
<span class="sd">                    spotpython tuning: 0.0 [#########-] 93.33%</span>
<span class="sd">                    spotpython tuning: 0.0 [##########] 100.00% Done...</span>
<span class="sd">            &gt;&gt;&gt; S.print_results()</span>
<span class="sd">                min y: 0.0</span>
<span class="sd">                x0: 0.0</span>
<span class="sd">                x1: 0.0</span>
<span class="sd">            &gt;&gt;&gt; S.X</span>
<span class="sd">                array([[ 0.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="sd">                [ 0.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="sd">                [ 1.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="sd">                [ 1.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="sd">                [-9.0924338949946959e-01, -1.5823457680063502e-01],</span>
<span class="sd">                [-2.0581710650646035e-01, -4.8124908877104844e-01],</span>
<span class="sd">                [ 9.4974117111856260e-01, -9.4631271618736390e-01],</span>
<span class="sd">                [-1.2095571372201608e-01,  6.3835886343683867e-02],</span>
<span class="sd">                [-6.6278701759800063e-01,  1.7431637339680406e-01],</span>
<span class="sd">                [ 2.8200844136299108e-01,  9.3001011398034406e-01],</span>
<span class="sd">                [ 4.7878811540073962e-01,  6.5321058189282999e-01],</span>
<span class="sd">                [ 1.5404061268479530e-04,  4.1895410759355553e-03],</span>
<span class="sd">                [-1.7027205448129213e-04,  4.7698567182254507e-03],</span>
<span class="sd">                [-4.4080972128058849e-04,  5.2785168039883147e-03],</span>
<span class="sd">                [ 3.7700880321788425e-03,  1.8909833144458731e-02]])</span>
<span class="sd">            &gt;&gt;&gt; S.y</span>
<span class="sd">                array([0.0000000000000000e+00, 1.0000000000000000e+00,</span>
<span class="sd">                1.0000000000000000e+00, 2.0000000000000000e+00,</span>
<span class="sd">                8.5176172264376016e-01, 2.7396136677365612e-01,</span>
<span class="sd">                1.7975160489355650e+00, 1.8705305067286033e-02,</span>
<span class="sd">                4.6967282873066640e-01, 9.4444757310571603e-01,</span>
<span class="sd">                6.5592212374576153e-01, 1.7575982937307560e-05,</span>
<span class="sd">                2.2780525684937748e-05, 2.8057052860362483e-05,</span>
<span class="sd">                3.7179535332164810e-04])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#</span>
        <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">get_result_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;force_run&quot;</span><span class="p">):</span>
            <span class="c1"># print a warning and load the result</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result file </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> exists. Loading the result.&quot;</span><span class="p">)</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">load_result</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_from</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_design</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_stats</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_surrogate</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">------ Starting optimization on the Surrogate for the given Budget ------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">timeout_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_continue</span><span class="p">(</span><span class="n">timeout_start</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_design</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_stats</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_writer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit_surrogate</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show_progress_if_needed</span><span class="p">(</span><span class="n">timeout_start</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;db_dict_name&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_write_db_dict</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;save_result&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_copy_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy attributes from another object.</span>
<span class="sd">        This method copies all attributes from the `other` object to the current</span>
<span class="sd">        object (`self`). It assumes that both objects are instances of a class</span>
<span class="sd">        that share similar attributes.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: An instance of a class from which attributes will be copied to</span>
<span class="sd">            the current instance.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize design. Generate and evaluate initial design.</span>
<span class="sd">        If `X_start` is not `None`, append it to the initial design.</span>
<span class="sd">        Therefore, the design size is `init_size` + `X_start.shape[0]`.</span>

<span class="sd">        Args:</span>
<span class="sd">            X_start (numpy.ndarray, optional):</span>
<span class="sd">                initial design. Must be of shape (n, k), where n is the number</span>
<span class="sd">                of points and k is the number of dimensions. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.X (numpy.ndarray): initial design</span>
<span class="sd">            self.y (numpy.ndarray): initial design values</span>

<span class="sd">        Note:</span>
<span class="sd">            * If `X_start` is has the wrong shape, it is ignored.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init,  design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 7</span>
<span class="sd">                # start point X_0</span>
<span class="sd">                X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1]))</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.initialize_design(X_start=X_start)</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                    S.X: [[ 0.          0.        ]</span>
<span class="sd">                        [ 0.          1.        ]</span>
<span class="sd">                        [ 1.          0.        ]</span>
<span class="sd">                        [ 1.          1.        ]</span>
<span class="sd">                        [-0.90924339 -0.15823458]</span>
<span class="sd">                        [-0.20581711 -0.48124909]</span>
<span class="sd">                        [ 0.94974117 -0.94631272]</span>
<span class="sd">                        [-0.12095571  0.06383589]</span>
<span class="sd">                        [-0.66278702  0.17431637]</span>
<span class="sd">                        [ 0.28200844  0.93001011]</span>
<span class="sd">                        [ 0.47878812  0.65321058]]</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                        S.y: [0.         1.         1.         2.         0.85176172 0.27396137</span>
<span class="sd">                            1.79751605 0.01870531 0.46967283 0.94444757 0.65592212]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_design_matrix</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_initial_design</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_initial_tensorboard_log</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_design_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the design matrix for the optimization process.</span>
<span class="sd">        This method generates an initial design matrix, optionally</span>
<span class="sd">        appending any provided starting points (`X_start`). The resulting</span>
<span class="sd">        design matrix is sanitized for non-numeric values and stored in `self.X`.</span>

<span class="sd">        Args:</span>
<span class="sd">            X_start (numpy.ndarray, optional): User-provided starting points</span>
<span class="sd">                for the design. Shape should be (n=n_samples, k=n_features).</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: The design matrix that combines the generated design</span>
<span class="sd">                        with the provided starting points.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If the resulting design matrix has zero rows.</span>

<span class="sd">        Notes:</span>
<span class="sd">            * If `X_start` is not in the expected shape, it is ignored.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun import Analytical</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    tensorboard_log=True,</span>
<span class="sd">                    TENSORBOARD_CLEAN=True,</span>
<span class="sd">                    lower = np.array([-1]),</span>
<span class="sd">                    upper = np.array([1])</span>
<span class="sd">                    )</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                S = Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            )</span>
<span class="sd">                X_start = np.array([[0.5, 0.5], [0.4, 0.4]])</span>
<span class="sd">                design_matrix = S.initialize_design_matrix(X_start)</span>
<span class="sd">                print(f&quot;Design matrix: {design_matrix}&quot;)</span>
<span class="sd">                    Design matrix: [[ 0.1         0.2       ]</span>
<span class="sd">                    [ 0.3         0.4       ]</span>
<span class="sd">                    [ 0.86352963  0.7892358 ]</span>
<span class="sd">                    [-0.24407197 -0.83687436]</span>
<span class="sd">                    [ 0.36481882  0.8375811 ]</span>
<span class="sd">                    [ 0.415331    0.54468512]</span>
<span class="sd">                    [-0.56395091 -0.77797854]</span>
<span class="sd">                    [-0.90259409 -0.04899292]</span>
<span class="sd">                    [-0.16484832  0.35724741]</span>
<span class="sd">                    [ 0.05170659  0.07401196]</span>
<span class="sd">                    [-0.78548145 -0.44638164]</span>
<span class="sd">                    [ 0.64017497 -0.30363301]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span>
                <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">],</span>
                <span class="n">repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">],</span>
                <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
                <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">X_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">X_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
            <span class="n">X_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">X0</span> <span class="o">=</span> <span class="n">X_start</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;X_start has wrong shape. Ignoring it.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;X0 has zero rows. Check design_control[&#39;init_size&#39;] or X_start.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_store_mo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_mo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># store y_mo in self.y_mo (append new values) if mo, otherwise self.y_mo is None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y_mo</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span> <span class="o">=</span> <span class="n">y_mo</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># append new values</span>
            <span class="c1"># before stacking the arrays, check if the number of columns is the same in the mo case</span>
            <span class="k">if</span> <span class="n">y_mo</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of y_mo: </span><span class="si">{</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_mo: </span><span class="si">{</span><span class="n">y_mo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of self.y_mo: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;self.y_mo: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of columns (objectives) in y_mo (</span><span class="si">{</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> <span class="sa">f</span><span class="s2">&quot;does not match the number of columns in self.y_mo (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mo</span><span class="p">,</span> <span class="n">y_mo</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mo2so</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_mo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts multi-objective values to a single-objective value by applying a user-defined</span>
<span class="sd">        function from ``fun_control[&#39;fun_mo2so&#39;]``. If no user-defined function is given, the</span>
<span class="sd">        values in the first objective row are used.</span>

<span class="sd">        This method is called after the objective function evaluation (i.e., after ``self.fun()``).</span>
<span class="sd">        It typically returns a 1D array with the single-objective values.</span>

<span class="sd">        Args:</span>
<span class="sd">            y_mo (numpy.ndarray):</span>
<span class="sd">                If multi-objective values are present, this is an array of shape (n, m), where ``m`` is</span>
<span class="sd">                the number of objectives and ``n`` is the number of data points.</span>
<span class="sd">                Otherwise, it is an array of shape (n,) with single-objective values.</span>
<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray:</span>
<span class="sd">                A 1D array of shape (n,) with single-objective values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">get_shape</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_store_mo</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="c1"># do not use m as a condition, because m can be None, use ndim instead</span>
        <span class="k">if</span> <span class="n">y_mo</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;fun_mo2so&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;fun_mo2so&quot;</span><span class="p">](</span><span class="n">y_mo</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Select the first column of an (n,m) array</span>
                <span class="k">if</span> <span class="n">y_mo</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">y0</span> <span class="o">=</span> <span class="n">y_mo</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y0</span> <span class="o">=</span> <span class="n">y_mo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">y_mo</span>
        <span class="k">return</span> <span class="n">y0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_initial_design</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate the initial design.</span>

<span class="sd">        This method evaluates the initial design matrix `X0` by applying the objective function</span>
<span class="sd">        and handling NaN values. The results are stored in `self.X` and `self.y`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the resulting design matrix has zero rows after removing NaN values.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower=np.array([-1, -1]),</span>
<span class="sd">                    upper=np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                S = Spot(fun=fun, fun_control=fun_control)</span>
<span class="sd">                X0 = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">                S.initialize_design_matrix(X_start=X0)</span>
<span class="sd">                S.evaluate_initial_design()</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                    S.X: [[ 0.          0.        ]</span>
<span class="sd">                    [ 0.          1.        ]</span>
<span class="sd">                    [ 1.          0.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [ 0.86352963  0.7892358 ]</span>
<span class="sd">                    [-0.24407197 -0.83687436]</span>
<span class="sd">                    [ 0.36481882  0.8375811 ]</span>
<span class="sd">                    [ 0.415331    0.54468512]</span>
<span class="sd">                    [-0.56395091 -0.77797854]</span>
<span class="sd">                    [-0.90259409 -0.04899292]</span>
<span class="sd">                    [-0.16484832  0.35724741]</span>
<span class="sd">                    [ 0.05170659  0.07401196]</span>
<span class="sd">                    [-0.78548145 -0.44638164]</span>
<span class="sd">                    [ 0.64017497 -0.30363301]]</span>
<span class="sd">                    S.y: [0.         1.         1.         2.         1.36857656 0.75992983</span>
<span class="sd">                    0.83463487 0.46918172 0.92329124 0.8170764  0.15480068 0.00815134</span>
<span class="sd">                    0.81623768 0.502017  ]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check that self.X has at leat one row and is not None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The design matrix has zero rows. Check design_control[&#39;init_size&#39;] or X_start.&quot;</span><span class="p">)</span>

        <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), before calling self.fun: X_all: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_all</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), before calling self.fun: fun_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>

        <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_mo as returned from fun(): </span><span class="si">{</span><span class="n">y_mo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_mo shape: </span><span class="si">{</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1">#  Convert multi-objective values to single-objective values</span>
        <span class="c1"># TODO: Store y_mo in self.y_mo (append new values)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), after calling self.fun: self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># TODO: Error if only nan values are returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;New y value: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The resulting design matrix has zero rows after removing NaN values.&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), final X val, after remove nan: self.X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), final y val, after remove nan: self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_initial_tensorboard_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes initial design data using the spot_writer. The spot_writer</span>
<span class="sd">        is a tensorboard writer that writes the data to a tensorboard file.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1]),</span>
<span class="sd">                    upper = np.array([1])</span>
<span class="sd">                    )</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            )</span>
<span class="sd">                S.initialize_design()</span>
<span class="sd">                S.write_initial_tensorboard_log()</span>
<span class="sd">                    Moving TENSORBOARD_PATH: runs/ to TENSORBOARD_PATH_OLD: runs_OLD/runs_2025_01_12_09_24_15</span>
<span class="sd">                    Created spot_tensorboard_path: runs/spot_logs/00_p040025_2025-01-12_09-24-15 for SummaryWriter()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># range goes to init_size -1 because the last value is added by update_stats(),</span>
            <span class="c1"># which always adds the last value.</span>
            <span class="c1"># Changed in 0.5.9:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)):</span>
                <span class="n">X_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">y_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">X_j</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)}</span>
                <span class="c1"># var_dict = assign_values(X, get_var_name(fun_control))</span>
                <span class="c1"># config = list(generate_one_config_from_var_dict(var_dict, fun_control))[0]</span>
                <span class="c1"># see: https://github.com/pytorch/pytorch/issues/32651</span>
                <span class="c1"># self.spot_writer.add_hparams(config, {&quot;spot_y&quot;: y_j}, run_name=self.spot_tensorboard_path)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;hp_metric&quot;</span><span class="p">:</span> <span class="n">y_j</span><span class="p">})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the following stats:</span>
<span class="sd">        1. `min_y`, 2. `min_X`, and 3. `counter`</span>
<span class="sd">        If `noise` is `True`, additionally the following stats are computed:</span>
<span class="sd">        1. `mean_X`,  2. `mean_y`,  3. `var_y`, 4. `min_mean_X`(X value of the best mean y value so far),</span>
<span class="sd">        5. `min_mean_y` (best mean y value so far), and 6. `min_var_y` (ariance of the best mean y value so far).</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.min_y (float): minimum y value</span>
<span class="sd">            self.min_X (numpy.ndarray): X value of the minimum y value</span>
<span class="sd">            self.counter (int): number of function evaluations</span>
<span class="sd">            self.mean_X (numpy.ndarray): mean X values</span>
<span class="sd">            self.mean_y (numpy.ndarray): mean y values</span>
<span class="sd">            self.var_y (numpy.ndarray): variance of y values</span>
<span class="sd">            self.min_mean_y (float): minimum mean y value</span>
<span class="sd">            self.min_mean_X (numpy.ndarray): X value of the minimum mean y value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;counter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">})</span>
        <span class="c1"># Update aggregated x and y values (if noise):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">aggregate_mean_var</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c1"># X value of the best mean y value so far:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>
            <span class="c1"># best mean y value so far:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>
            <span class="c1"># variance of the best mean y value so far:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_var_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit_surrogate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit surrogate model. The surrogate model</span>
<span class="sd">        is fitted to the data stored in `self.X` and `self.y`.</span>
<span class="sd">        It uses the generic `fit()` method of the</span>
<span class="sd">        surrogate model `surrogate`. The default surrogate model is</span>
<span class="sd">        an instance from spotpython&#39;s `Kriging` class.</span>
<span class="sd">        If `show_models` is `True`, the model is plotted.</span>
<span class="sd">        If the number of points is greater than `max_surrogate_points`,</span>
<span class="sd">        the surrogate model is fitted to a subset of the data points.</span>
<span class="sd">        The subset is selected using the `select_distant_points()` function.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.surrogate (object):</span>
<span class="sd">                surrogate model</span>
<span class="sd">            self.X (numpy.ndarray):</span>
<span class="sd">                design points</span>
<span class="sd">            self.y (numpy.ndarray):</span>
<span class="sd">                function values</span>
<span class="sd">            self.max_surrogate_points (int):</span>
<span class="sd">                maximum number of points to fit the surrogate model</span>
<span class="sd">            self.show_models (bool):</span>
<span class="sd">                if True, the model is plotted</span>

<span class="sd">        Note:</span>
<span class="sd">            * As shown in https://sequential-parameter-optimization.github.io/Hyperparameter-Tuning-Cookbook/</span>
<span class="sd">            other surrogate models can be used as well.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 0</span>
<span class="sd">                X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1])</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.initialize_design(X_start=X_start)</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.surrogate.predict(np.array([[0, 0]]))</span>
<span class="sd">                    array([1.49011612e-08])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.X.shape: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.y.shape: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">X_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">X_points</span> <span class="o">==</span> <span class="n">y_points</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">X_points</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_surrogate_points</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting distant points for surrogate fitting.&quot;</span><span class="p">)</span>
                <span class="n">X_S</span><span class="p">,</span> <span class="n">y_S</span> <span class="o">=</span> <span class="n">select_distant_points</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_surrogate_points</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">X_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
                <span class="n">y_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_S</span><span class="p">,</span> <span class="n">y_S</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;X and y have different sizes. Surrogate not fitted.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_models</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_design</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update design. Generate and evaluate new design points.</span>
<span class="sd">        It is basically a call to the method `get_new_X0()`.</span>
<span class="sd">        If `noise` is `True`, additionally the following steps</span>
<span class="sd">        (from `get_X_ocba()`) are performed:</span>
<span class="sd">        1. Compute OCBA points.</span>
<span class="sd">        2. Evaluate OCBA points.</span>
<span class="sd">        3. Append OCBA points to the new design points.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        Attributes:</span>
<span class="sd">            self.X (numpy.ndarray): updated design</span>
<span class="sd">            self.y (numpy.ndarray): updated design values</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # 1. Without OCBA points:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 0</span>
<span class="sd">                X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1])</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                S = Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,)</span>
<span class="sd">                S.initialize_design(X_start=X_start)</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                X_shape_before = S.X.shape</span>
<span class="sd">                print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="sd">                print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="sd">                y_size_before = S.y.size</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.update_design()</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="sd">                print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="sd">                print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; #</span>
<span class="sd">            &gt;&gt;&gt; # 2. Using the OCBA points:</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 3</span>
<span class="sd">                X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">                fun = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                        sigma=0.02,</span>
<span class="sd">                        lower = np.array([-1, -1]),</span>
<span class="sd">                        upper = np.array([1, 1]),</span>
<span class="sd">                        noise=True,</span>
<span class="sd">                        ocba_delta=1,</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni, repeats=2)</span>
<span class="sd">                S = Spot(fun=fun,</span>
<span class="sd">                            design_control=design_control,</span>
<span class="sd">                            fun_control=fun_control</span>
<span class="sd">                )</span>
<span class="sd">                S.initialize_design(X_start=X_start)</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                X_shape_before = S.X.shape</span>
<span class="sd">                print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="sd">                print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="sd">                y_size_before = S.y.size</span>
<span class="sd">                S.update_stats()</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                S.update_design()</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="sd">                print(f&quot;S.ocba_delta: {S.ocba_delta}&quot;)</span>
<span class="sd">                print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="sd">                print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="sd">                # compare the shapes of the X and y values before and after the update_design method</span>
<span class="sd">                assert X_shape_before[0] + S.ocba_delta == S.X.shape[0]</span>
<span class="sd">                assert X_shape_before[1] == S.X.shape[1]</span>
<span class="sd">                assert y_size_before + S.ocba_delta == S.y.size</span>
<span class="sd">                Experiment saved to 000_exp.pkl</span>
<span class="sd">                    S.X: [[ 0.          1.        ]</span>
<span class="sd">                    [ 1.          0.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [ 0.54509876 -0.36921401]</span>
<span class="sd">                    [ 0.54509876 -0.36921401]</span>
<span class="sd">                    [ 0.18642675  0.87708546]</span>
<span class="sd">                    [ 0.18642675  0.87708546]</span>
<span class="sd">                    [-0.45060393 -0.208063  ]</span>
<span class="sd">                    [-0.45060393 -0.208063  ]]</span>
<span class="sd">                    S.y: [0.98021757 0.99264427 2.02575851 2.00387949 0.45185626 0.44499372</span>
<span class="sd">                    0.79130456 0.81487288 0.24000221 0.23988634]</span>
<span class="sd">                    X_shape_before: (10, 2)</span>
<span class="sd">                    y_size_before: 10</span>
<span class="sd">                    S.X: [[ 0.          1.        ]</span>
<span class="sd">                    [ 1.          0.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [ 0.54509876 -0.36921401]</span>
<span class="sd">                    [ 0.54509876 -0.36921401]</span>
<span class="sd">                    [ 0.18642675  0.87708546]</span>
<span class="sd">                    [ 0.18642675  0.87708546]</span>
<span class="sd">                    [-0.45060393 -0.208063  ]</span>
<span class="sd">                    [-0.45060393 -0.208063  ]</span>
<span class="sd">                    [-0.02292587  0.0145145 ]]</span>
<span class="sd">                    S.y: [ 0.98021757  0.99264427  2.02575851  2.00387949  0.45185626  0.44499372</span>
<span class="sd">                    0.79130456  0.81487288  0.24000221  0.23988634 -0.01904616]</span>
<span class="sd">                    S.n_points: 1</span>
<span class="sd">                    S.ocba_delta: 1</span>
<span class="sd">                    X_shape_after: (11, 2)</span>
<span class="sd">                    y_size_after: 11</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># OCBA (only if noise). Determination of the OCBA points depends on the</span>
        <span class="c1"># old X and y values.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;self.var_y &lt;= 0. OCBA points are not generated:&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;There are less than 3 points or points with no variance information.&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In update_design(): self.mean_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In update_design(): self.var_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">X_ocba</span> <span class="o">=</span> <span class="n">get_ocba_X</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_ocba</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Determine the new X0 values based on the old X and y values:</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_new_X0</span><span class="p">()</span>
        <span class="c1"># Append OCBA points to the new design points:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">X0</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="n">X_ocba</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;In update_design(): self.fun_control sigma and seed passed to fun(): </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># (S-18): Evaluating New Solutions:</span>
        <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="c1"># Convert multi-objective values to single-objective values:</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="c1"># Apply penalty for NA values works only on so values:</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Append New Solutions (only if they are not nan):</span>
        <span class="k">if</span> <span class="n">y0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># otherwise, generate a random point and append it to the design</span>
            <span class="n">Xr</span><span class="p">,</span> <span class="n">yr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_random_point</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">Xr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the results to a file.</span>
<span class="sd">        If filename is not provided, the filename is generated based on the PREFIX using the</span>
<span class="sd">        `get_result_filename()` function. The results file is saved in the current working directory</span>
<span class="sd">        unless a path is provided. The file is saved in pickle format using the highest protocol.</span>
<span class="sd">        If no arguments are provided, the file is saved with the default name PREFIX + &quot;_res.pkl&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str):</span>
<span class="sd">                The filename of the results file. If not provided,</span>
<span class="sd">                the filename is generated based on the PREFIX using the</span>
<span class="sd">                `get_result_filename()` function. Default is `None`.</span>
<span class="sd">            path (str):</span>
<span class="sd">                The path to the results file. If not provided, the file</span>
<span class="sd">                is saved in the current working directory. Default is `None`.</span>
<span class="sd">            overwrite (bool):</span>
<span class="sd">                If `True`, the file will be overwritten if it already exists.</span>
<span class="sd">                Default is `True`.</span>
<span class="sd">            verbosity (int):</span>
<span class="sd">                The level of verbosity. Default is 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">get_result_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_experiment</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s2">&quot;file_io&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s2">&quot;file_io&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the experiment to a file.</span>
<span class="sd">        If no filename is provided, the filename is generated based on the PREFIX using the</span>
<span class="sd">        `get_experiment_filename()` function. The experiment file is saved in the current working directory</span>
<span class="sd">        unless a path is provided. The file is saved in pickle format using the highest protocol.</span>
<span class="sd">        If no arguments are provided, the file is saved with the default name PREFIX + &quot;_exp.pkl&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str):</span>
<span class="sd">                The filename of the experiment file. If not provided,</span>
<span class="sd">                the filename is generated based on the PREFIX using the</span>
<span class="sd">                `get_experiment_filename()` function. Default is `None`.</span>
<span class="sd">            path (str):</span>
<span class="sd">                The path to the experiment file. If not provided, the file</span>
<span class="sd">                is saved in the current working directory. Default is `None`.</span>
<span class="sd">            overwrite (bool):</span>
<span class="sd">                If `True`, the file will be overwritten if it already exists.</span>
<span class="sd">                Default is `True`.</span>
<span class="sd">            unpickleables (str):</span>
<span class="sd">                The type of unpickleable components to exclude. Default is &quot;file_io&quot;, which</span>
<span class="sd">                excludes file I/O components like the spot_writer and logger.</span>
<span class="sd">                If set to any other value, the function will exclude the function, optimizer,</span>
<span class="sd">                surrogate, data_set, scaler, rng, and design components.</span>
<span class="sd">                Default is &quot;file_io&quot;.</span>
<span class="sd">            verbosity (int):</span>
<span class="sd">                The level of verbosity. Default is 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure we don&#39;t accidentally try to pickle unpicklable components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_and_del_spot_writer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_logger_handlers</span><span class="p">()</span>

        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pickle_safe_spot_tuner</span><span class="p">(</span><span class="n">unpickleables</span><span class="o">=</span><span class="n">unpickleables</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>

        <span class="c1"># Determine the filename based on PREFIX if not provided</span>
        <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">,</span> <span class="s2">&quot;experiment&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">get_experiment_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Check if the file already exists</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> already exists. Use overwrite=True to overwrite the file.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Serialize the experiment dictionary to the pickle file</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during pickling: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">e</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experiment saved to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_logger_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove handlers from the logger to avoid pickling issues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>  <span class="c1"># Copy the list to avoid modification during iteration</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_close_and_del_spot_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the spot_writer attribute from the object</span>
<span class="sd">        if it exists and close the writer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pickle_safe_spot_tuner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s2">&quot;file_io&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Spot</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of self excluding unpickleable components for safe pickling.</span>
<span class="sd">        This ensures no unpicklable components are passed to pickle.dump().</span>

<span class="sd">        Args:</span>
<span class="sd">            unpickleables (str):</span>
<span class="sd">                The type of unpickleable components to exclude. Default is &quot;file_io&quot;, which</span>
<span class="sd">                excludes file I/O components like the spot_writer and logger.</span>
<span class="sd">                If set to any other value, the function will exclude the function, optimizer,</span>
<span class="sd">                surrogate, data_set, scaler, rng, and design components.</span>
<span class="sd">                Default is &quot;file_io&quot;.</span>
<span class="sd">            verbosity (int):</span>
<span class="sd">                The level of verbosity. Default is 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spot: A copy of the Spot instance with unpickleable components removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># List of attributes that can&#39;t be pickled</span>
        <span class="k">if</span> <span class="n">unpickleables</span> <span class="o">==</span> <span class="s2">&quot;file_io&quot;</span><span class="p">:</span>
            <span class="n">unpickleable_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spot_writer&quot;</span><span class="p">,</span> <span class="s2">&quot;logger&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unpickleable_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spot_writer&quot;</span><span class="p">,</span> <span class="s2">&quot;logger&quot;</span><span class="p">,</span> <span class="s2">&quot;fun&quot;</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">,</span> <span class="s2">&quot;surrogate&quot;</span><span class="p">,</span> <span class="s2">&quot;data_set&quot;</span><span class="p">,</span> <span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="s2">&quot;rng&quot;</span><span class="p">,</span> <span class="s2">&quot;design&quot;</span><span class="p">]</span>
        <span class="c1"># Prepare a dictionary to store picklable state</span>
        <span class="n">picklable_state</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Copy picklable attributes to the dictionary</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unpickleable_attrs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Test if the attribute can be pickled</span>
                    <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">picklable_state</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is picklable and will be included in the experiment file.&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not picklable and will be excluded from the experiment file.&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

        <span class="c1"># Use the dictionary to create a new instance</span>
        <span class="n">picklable_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">picklable_instance</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">picklable_state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Picklable instance created: </span><span class="si">{</span><span class="n">picklable_instance</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">picklable_instance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_spot_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the spot_writer for the current experiment if in fun_control</span>
<span class="sd">        the tensorboard_log is set to True</span>
<span class="sd">        and the spot_tensorboard_path is not None.</span>
<span class="sd">        Otherwise, the spot_writer is set to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;tensorboard_log&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;spot_tensorboard_path&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;spot_tensorboard_path&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_init_spot_writer(): Created spot_tensorboard_path: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s1">&#39;spot_tensorboard_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> for SummaryWriter()&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No tensorboard log created.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_continue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_start</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">timeout_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_random_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a random point in the design space.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple): tuple containing:</span>
<span class="sd">                X0 (numpy.ndarray): random point in the design space</span>
<span class="sd">                y0 (numpy.ndarray): function value at X</span>

<span class="sd">        Notes:</span>
<span class="sd">            If the evaluation fails, the function returns arrays of shape[0] == 0.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1])</span>
<span class="sd">                    )</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            )</span>
<span class="sd">                X0, y0 = S.generate_random_point()</span>
<span class="sd">                print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">                print(f&quot;y0: {y0}&quot;)</span>
<span class="sd">                assert X0.size == 2</span>
<span class="sd">                assert y0.size == 1</span>
<span class="sd">                assert np.all(X0 &gt;= S.lower)</span>
<span class="sd">                assert np.all(X0 &lt;= S.upper)</span>
<span class="sd">                assert y0 &gt;= 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
            <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X0</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() generate_random_point(), before calling self.fun: X_all: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_all</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() generate_random_point(), before calling self.fun: fun_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="c1"># Convert multi-objective values to single-objective values</span>
        <span class="c1"># TODO: Store y_mo in self.y_mo (append new values)</span>
        <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="c1"># Apply penalty for NA values works only on so values:</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_progress_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_start</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show progress bar if `show_progress` is `True`. If</span>
<span class="sd">        self.progress_file is not `None`, the progress bar is saved</span>
<span class="sd">        in the file with the name `self.progress_file`.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>
<span class="sd">            timeout_start (float): start time</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span><span class="p">):</span>
            <span class="n">progress_bar</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">progress_bar</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timeout_start</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">*</span> <span class="mi">60</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a design with `size` points in the interval [lower, upper].</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int): number of points</span>
<span class="sd">            repeats (int): number of repeats</span>
<span class="sd">            lower (numpy.ndarray): lower bound of the design space</span>
<span class="sd">            upper (numpy.ndarray): upper bound of the design space</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray): design points</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import design_control_init</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                design_control = design_control_init(init_size=3)</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1]),</span>
<span class="sd">                    fun_evals=fun_evals,</span>
<span class="sd">                    tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                    )</span>
<span class="sd">                S = spot.Spot(fun = analytical().fun_sphere,</span>
<span class="sd">                            fun_control = fun_control,</span>
<span class="sd">                            design_control = design_control)</span>
<span class="sd">                X = S.generate_design(size=3, repeats=1, lower=np.array([0, 0]), upper=np.array([100, 1]))</span>
<span class="sd">                assert X.shape[0] == 3</span>
<span class="sd">                assert X.shape[1] == 2</span>
<span class="sd">                print(X)</span>
<span class="sd">                    array([[77.25493789,  0.31539299],</span>
<span class="sd">                    [59.32133757,  0.93854273],</span>
<span class="sd">                    [27.4698033 ,  0.3959685 ]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">scipy_lhd</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="n">repeats</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get the last y value:</span>
            <span class="n">y_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">y_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">X_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># y_min: best y value so far</span>
                <span class="c1"># y_last: last y value, can be worse than y_min</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_y&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">y_min</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="n">y_last</span><span class="p">},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
                <span class="c1"># X_min: X value of the best y value so far</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_X&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;X_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">X_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get the last n y values:</span>
                <span class="n">y_last_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_repeats</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># y_min_mean: best mean y value so far</span>
                <span class="n">y_min_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># X_min_mean: X value of the best mean y value so far</span>
                <span class="n">X_min_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># y_min_var: variance of the min y value so far</span>
                <span class="n">y_min_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_var_y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_y_min_var&quot;</span><span class="p">,</span> <span class="n">y_min_var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
                <span class="c1"># y_min_mean: best mean y value so far (see above)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;spot_y&quot;</span><span class="p">,</span> <span class="n">y_min_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
                <span class="c1"># last n y values (noisy):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_y&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;y_last_n</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">y_last_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_repeats</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
                <span class="c1"># X_min_mean: X value of the best mean y value so far (see above)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_scalars</span><span class="p">(</span><span class="s2">&quot;spot_X_noise&quot;</span><span class="p">,</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;X_min_mean</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">X_min_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)},</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
            <span class="c1"># get last value of self.X and convert to dict. take the values from self.var_name as keys:</span>
            <span class="n">X_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">X_last</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)}</span>
            <span class="c1"># var_dict = assign_values(X, get_var_name(fun_control))</span>
            <span class="c1"># config = list(generate_one_config_from_var_dict(var_dict, fun_control))[0]</span>
            <span class="c1"># hyperparameters X and value y of the last configuration:</span>
            <span class="c1"># see: https://github.com/pytorch/pytorch/issues/32651</span>
            <span class="c1"># self.spot_writer.add_hparams(config, {&quot;spot_y&quot;: y_last}, run_name=self.spot_tensorboard_path)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;hp_metric&quot;</span><span class="p">:</span> <span class="n">y_last</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;update_writer(): Done.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No spot_writer available.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">suggest_new_X</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute `n_points` new infill points in natural units.</span>
<span class="sd">        These diffrent points are computed by the optimizer using increasing seed.</span>
<span class="sd">        The optimizer searches in the ranges from `lower_j` to `upper_j`.</span>
<span class="sd">        The method `infill()` is used as the objective function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray): `n_points` infill points in natural units, each of dim k</span>

<span class="sd">        Note:</span>
<span class="sd">            This is step (S-14a) in [bart21i].</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.spot import Spot</span>
<span class="sd">                from spotpython.fun import Analytical</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                nn = 3</span>
<span class="sd">                fun_sphere = Analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                        lower = np.array([-1, -1]),</span>
<span class="sd">                        upper = np.array([1, 1]),</span>
<span class="sd">                        n_points=nn,</span>
<span class="sd">                        )</span>
<span class="sd">                S = Spot(</span>
<span class="sd">                    fun=fun_sphere,</span>
<span class="sd">                    fun_control=fun_control,</span>
<span class="sd">                    )</span>
<span class="sd">                S.X = S.design.scipy_lhd(</span>
<span class="sd">                    S.design_control[&quot;init_size&quot;], lower=S.lower, upper=S.upper</span>
<span class="sd">                )</span>
<span class="sd">                print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                S.y = S.fun(S.X)</span>
<span class="sd">                print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                S.fit_surrogate()</span>
<span class="sd">                X0 = S.suggest_new_X()</span>
<span class="sd">                print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">                assert X0.size == S.n_points * S.k</span>
<span class="sd">                assert X0.ndim == 2</span>
<span class="sd">                assert X0.shape[0] == nn</span>
<span class="sd">                assert X0.shape[1] == 2</span>
<span class="sd">                spot_1.X: [[ 0.86352963  0.7892358 ]</span>
<span class="sd">                            [-0.24407197 -0.83687436]</span>
<span class="sd">                            [ 0.36481882  0.8375811 ]</span>
<span class="sd">                            [ 0.415331    0.54468512]</span>
<span class="sd">                            [-0.56395091 -0.77797854]</span>
<span class="sd">                            [-0.90259409 -0.04899292]</span>
<span class="sd">                            [-0.16484832  0.35724741]</span>
<span class="sd">                            [ 0.05170659  0.07401196]</span>
<span class="sd">                            [-0.78548145 -0.44638164]</span>
<span class="sd">                            [ 0.64017497 -0.30363301]]</span>
<span class="sd">                spot_1.y: [1.36857656 0.75992983 0.83463487 0.46918172 0.92329124 0.8170764</span>
<span class="sd">                0.15480068 0.00815134 0.81623768 0.502017  ]</span>
<span class="sd">                X0: [[0.00154544 0.003962  ]</span>
<span class="sd">                    [0.00165526 0.00410847]</span>
<span class="sd">                    [0.00165685 0.0039177 ]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># (S-14a) Optimization on the surrogate:</span>
        <span class="n">new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">optimizer_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">optimizers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;dual_annealing&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
            <span class="s2">&quot;differential_evolution&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span>
                <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span>
                <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
                <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;max_iter&quot;</span><span class="p">],</span>
                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
            <span class="p">),</span>
            <span class="s2">&quot;direct&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">),</span>
            <span class="s2">&quot;shgo&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
            <span class="s2">&quot;basinhopping&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;Nelder-Mead&quot;</span><span class="p">}),</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">optimizer_name</span><span class="p">,</span> <span class="n">optimizers</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])()</span>
            <span class="n">new_X</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">infill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infill (acquisition) function. Evaluates one point on the surrogate via `surrogate.predict(x.reshape(1,-1))`,</span>
<span class="sd">        if `sklearn` surrogates are used or `surrogate.predict(x.reshape(1,-1), return_val=self.infill_criterion)`</span>
<span class="sd">        if the internal surrogate `Kriging` is selected.</span>
<span class="sd">        This method is passed to the optimizer in `suggest_new_X`, i.e., the optimizer is called via</span>
<span class="sd">        `self.optimizer(func=self.infill)`.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (array): point in natural units with shape `(1, dim)`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray): value based on infill criterion, e.g., `&quot;ei&quot;`. Shape `(1,)`.</span>
<span class="sd">                The objective function value `y` that is used as a base value for the</span>
<span class="sd">                infill criterion is calculated in natural units.</span>

<span class="sd">        Note:</span>
<span class="sd">            This is step (S-12) in [bart21i].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Reshape x to have shape (1, -1) because the predict method expects a 2D array</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill_criterion</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_progress</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;plot.png&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;ro-&quot;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Objective function value over iterations&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the progress of the hyperparameter tuning (optimization).</span>

<span class="sd">        Args:</span>
<span class="sd">            show (bool):</span>
<span class="sd">                Show the plot.</span>
<span class="sd">            log_x (bool):</span>
<span class="sd">                Use logarithmic scale for x-axis.</span>
<span class="sd">            log_y (bool):</span>
<span class="sd">                Use logarithmic scale for y-axis.</span>
<span class="sd">            filename (str):</span>
<span class="sd">                Filename to save the plot.</span>
<span class="sd">            style (list):</span>
<span class="sd">                Style of the plot. Default: [&#39;k&#39;, &#39;ro-&#39;], i.e., the initial points are plotted as a black line</span>
<span class="sd">                and the subsequent points as red dots connected by a line.</span>
<span class="sd">            title (str):</span>
<span class="sd">                Title of the plot. Default: &quot;Objective function value over iterations&quot;.</span>
<span class="sd">            y_label (str):</span>
<span class="sd">                Label for the y-axis. Default: &quot;y&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 7</span>
<span class="sd">                # number of points</span>
<span class="sd">                fun_evals = 10</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1])</span>
<span class="sd">                    fun_evals=fun_evals,</span>
<span class="sd">                    tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                surrogate_control=surrogate_control_init()</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control</span>
<span class="sd">                            design_control=design_control,</span>
<span class="sd">                            surrogate_control=surrogate_control,)</span>
<span class="sd">                S.run()</span>
<span class="sd">                S.plot_progress(log_y=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tkagg</span><span class="p">:</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">s_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">s_c</span> <span class="o">=</span> <span class="n">s_y</span><span class="o">.</span><span class="n">cummin</span><span class="p">()</span>
        <span class="n">n_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">]</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_init</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_y</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">s_y</span><span class="p">[:</span><span class="n">n_init</span><span class="p">],</span>
                <span class="n">style</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">[</span><span class="n">s_c</span><span class="p">[:</span><span class="n">n_init</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">style</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">s_c</span><span class="p">[</span><span class="n">n_init</span><span class="p">:],</span>
                <span class="n">style</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># plot only s_y values:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_y</span><span class="p">,</span> <span class="n">style</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Less evaluations ({len(s_y)}) than initial design points (</span><span class="si">{n_init}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="c1"># add a grid</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the model fit for 1-dim objective functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                spot object</span>
<span class="sd">            y_min (float, optional):</span>
<span class="sd">                y range, lower bound.</span>
<span class="sd">            y_max (float, optional):</span>
<span class="sd">                y range, upper bound.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 3</span>
<span class="sd">                # number of points</span>
<span class="sd">                fun_evals = 7</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1]),</span>
<span class="sd">                    upper = np.array([1]),</span>
<span class="sd">                    fun_evals=fun_evals,</span>
<span class="sd">                    tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>

<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control</span>
<span class="sd">                S.run()</span>
<span class="sd">                S.plot_model()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
            <span class="c1"># convert multi-objective values to single-objective values</span>
            <span class="n">y_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
            <span class="c1"># Apply penalty for NA values works only on so values:</span>
            <span class="n">y_test</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;kriging&quot;</span><span class="p">:</span>
                <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">return_val</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True function&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Samples&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Last Sample&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Best Sample (mean)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Best Sample&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">y_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">y_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
            <span class="c1"># plt.title(self.surrogate.__class__.__name__ + &quot;. &quot; + str(self.counter) + &quot;: &quot; + str(self.min_y))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fun_evals: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. min_y (noise): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; min_mean_y: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fun_evals: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. min_y: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print results from the run:</span>
<span class="sd">            1. min y</span>
<span class="sd">            2. min X</span>
<span class="sd">            If `noise == True`, additionally the following values are printed:</span>
<span class="sd">            3. min mean y</span>
<span class="sd">            4. min mean X</span>

<span class="sd">        Args:</span>
<span class="sd">            print_screen (bool, optional):</span>
<span class="sd">                print results to screen</span>

<span class="sd">        Returns:</span>
<span class="sd">            output (list):</span>
<span class="sd">                list of results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;min y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;min mean y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">var_type</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span> <span class="ow">and</span> <span class="nb">dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">get_ith_hyperparameter_name_from_fun_control</span><span class="p">(</span><span class="n">fun_control</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">var_name</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_tuned_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tuned hyperparameter values from the run.</span>
<span class="sd">        If `noise == True`, the mean values are returned.</span>

<span class="sd">        Args:</span>
<span class="sd">            fun_control (dict, optional):</span>
<span class="sd">                fun_control dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): dictionary of tuned hyperparameters.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.utils.device import getDevice</span>
<span class="sd">                from math import inf</span>
<span class="sd">                from spotpython.utils.init import fun_control_init</span>
<span class="sd">                import numpy as np</span>
<span class="sd">                from spotpython.hyperparameters.values import set_control_key_value</span>
<span class="sd">                from spotpython.data.diabetes import Diabetes</span>
<span class="sd">                MAX_TIME = 1</span>
<span class="sd">                FUN_EVALS = 10</span>
<span class="sd">                INIT_SIZE = 5</span>
<span class="sd">                WORKERS = 0</span>
<span class="sd">                PREFIX=&quot;037&quot;</span>
<span class="sd">                DEVICE = getDevice()</span>
<span class="sd">                DEVICES = 1</span>
<span class="sd">                TEST_SIZE = 0.4</span>
<span class="sd">                TORCH_METRIC = &quot;mean_squared_error&quot;</span>
<span class="sd">                dataset = Diabetes()</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    _L_in=10,</span>
<span class="sd">                    _L_out=1,</span>
<span class="sd">                    _torchmetric=TORCH_METRIC,</span>
<span class="sd">                    PREFIX=PREFIX,</span>
<span class="sd">                    TENSORBOARD_CLEAN=True,</span>
<span class="sd">                    data_set=dataset,</span>
<span class="sd">                    device=DEVICE,</span>
<span class="sd">                    enable_progress_bar=False,</span>
<span class="sd">                    fun_evals=FUN_EVALS,</span>
<span class="sd">                    log_level=50,</span>
<span class="sd">                    max_time=MAX_TIME,</span>
<span class="sd">                    num_workers=WORKERS,</span>
<span class="sd">                    show_progress=True,</span>
<span class="sd">                    test_size=TEST_SIZE,</span>
<span class="sd">                    tolerance_x=np.sqrt(np.spacing(1)),</span>
<span class="sd">                    )</span>
<span class="sd">                from spotpython.light.regression.netlightregression import NetLightRegression</span>
<span class="sd">                from spotpython.hyperdict.light_hyper_dict import LightHyperDict</span>
<span class="sd">                from spotpython.hyperparameters.values import add_core_model_to_fun_control</span>
<span class="sd">                add_core_model_to_fun_control(fun_control=fun_control,</span>
<span class="sd">                                            core_model=NetLightRegression,</span>
<span class="sd">                                            hyper_dict=LightHyperDict)</span>
<span class="sd">                from spotpython.hyperparameters.values import set_control_hyperparameter_value</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;l1&quot;, [7, 8])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;epochs&quot;, [3, 5])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;batch_size&quot;, [4, 5])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;optimizer&quot;, [</span>
<span class="sd">                                &quot;Adam&quot;,</span>
<span class="sd">                                &quot;RAdam&quot;,</span>
<span class="sd">                            ])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;dropout_prob&quot;, [0.01, 0.1])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;lr_mult&quot;, [0.5, 5.0])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;patience&quot;, [2, 3])</span>
<span class="sd">                set_control_hyperparameter_value(fun_control, &quot;act_fn&quot;,[</span>
<span class="sd">                                &quot;ReLU&quot;,</span>
<span class="sd">                                &quot;LeakyReLU&quot;</span>
<span class="sd">                            ] )</span>
<span class="sd">                from spotpython.utils.init import design_control_init, surrogate_control_init</span>
<span class="sd">                design_control = design_control_init(init_size=INIT_SIZE)</span>
<span class="sd">                surrogate_control = surrogate_control_init(method=&quot;regression&quot;)</span>
<span class="sd">                from spotpython.fun.hyperlight import HyperLight</span>
<span class="sd">                fun = HyperLight(log_level=50).fun</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                spot_tuner = spot.Spot(fun=fun,</span>
<span class="sd">                                    fun_control=fun_control,</span>
<span class="sd">                                    design_control=design_control,</span>
<span class="sd">                                    surrogate_control=surrogate_control)</span>
<span class="sd">                spot_tuner.run()</span>
<span class="sd">                spot_tuner.get_tuned_hyperparameters()</span>
<span class="sd">                    {&#39;l1&#39;: 7.0,</span>
<span class="sd">                    &#39;epochs&#39;: 5.0,</span>
<span class="sd">                    &#39;batch_size&#39;: 4.0,</span>
<span class="sd">                    &#39;act_fn&#39;: 0.0,</span>
<span class="sd">                    &#39;optimizer&#39;: 0.0,</span>
<span class="sd">                    &#39;dropout_prob&#39;: 0.01,</span>
<span class="sd">                    &#39;lr_mult&#39;: 5.0,</span>
<span class="sd">                    &#39;patience&#39;: 3.0,</span>
<span class="sd">                    &#39;initialization&#39;: 1.0}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">var_type</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span> <span class="ow">and</span> <span class="n">fun_control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">get_ith_hyperparameter_name_from_fun_control</span><span class="p">(</span><span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">var_name</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
        <span class="c1"># convert list to a dictionary</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">chg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the values of elements at indices `i` and `j` in the array `z0` to `x` and `y`, respectively.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (int or float):</span>
<span class="sd">                The new value for the element at index `i`.</span>
<span class="sd">            y (int or float):</span>
<span class="sd">                The new value for the element at index `j`.</span>
<span class="sd">            z0 (list or numpy.ndarray):</span>
<span class="sd">                The array to be modified.</span>
<span class="sd">            i (int):</span>
<span class="sd">                The index of the element to be changed to `x`.</span>
<span class="sd">            j (int):</span>
<span class="sd">                The index of the element to be changed to `y`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (list) or (numpy.ndarray): The modified array.</span>

<span class="sd">        Examples:</span>
<span class="sd">                &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                    from spotpython.spot import spot</span>
<span class="sd">                    from spotpython.utils.init import (</span>
<span class="sd">                        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                    fun = analytical().fun_sphere</span>
<span class="sd">                    fun_control = fun_control_init(</span>
<span class="sd">                        lower = np.array([-1]),</span>
<span class="sd">                        upper = np.array([1]),</span>
<span class="sd">                    )</span>
<span class="sd">                    S = spot.Spot(fun=fun,</span>
<span class="sd">                                func_control=fun_control)</span>
<span class="sd">                    z0 = [1, 2, 3]</span>
<span class="sd">                    print(f&quot;Before: {z0}&quot;)</span>
<span class="sd">                    new_val_1 = 4</span>
<span class="sd">                    new_val_2 = 5</span>
<span class="sd">                    index_1 = 0</span>
<span class="sd">                    index_2 = 2</span>
<span class="sd">                    S.chg(x=new_val_1, y=new_val_2, z0=z0, i=index_1, j=index_2)</span>
<span class="sd">                    print(f&quot;After: {z0}&quot;)</span>
<span class="sd">                    Before: [1, 2, 3]</span>
<span class="sd">                    After: [4, 2, 5]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">z0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">return</span> <span class="n">z0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_z00</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process each entry in the `z00` array according to the corresponding type</span>
<span class="sd">        in the `self.var_type` list.</span>
<span class="sd">        Specifically, if the type is &quot;float&quot;, the function will calculate the mean of the two `z00` values.</span>
<span class="sd">        If the type is not &quot;float&quot;, the function will retrun the maximum of the two `z00` values.</span>

<span class="sd">        Args:</span>
<span class="sd">            z00 (numpy.ndarray):</span>
<span class="sd">                Array of values to process.</span>
<span class="sd">            use_min (bool):</span>
<span class="sd">                If `True`, the minimum value is returned. If `False`, the maximum value is returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (list): Processed values.</span>

<span class="sd">        Examples:</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            import random</span>
<span class="sd">            z00 = np.array([[1, 2, 3, 4], [5, 6, 7, 8]])</span>
<span class="sd">            spot.var_type = [&quot;float&quot;, &quot;int&quot;, &quot;int&quot;, &quot;float&quot;]</span>
<span class="sd">            spot.process_z00(z00)</span>
<span class="sd">            [3, 6, 7, 6]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
                <span class="n">mean_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># var_type[i] == &#39;int&#39;</span>
                <span class="k">if</span> <span class="n">use_min</span><span class="p">:</span>
                    <span class="n">min_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">n_grid</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare mesh grid and surrogate predictions for contour and 3D surface plotting.</span>

<span class="sd">        Args:</span>
<span class="sd">            i (int, optional): Index of the first dimension to plot. Default is 0.</span>
<span class="sd">            j (int, optional): Index of the second dimension to plot. Default is 1.</span>
<span class="sd">            n_grid (int, optional): Number of grid points per dimension. Default is 50.</span>
<span class="sd">            use_min (bool, optional): If True, fix hidden dimensions to their minimum values. Default is False.</span>
<span class="sd">            use_max (bool, optional): If True, fix hidden dimensions to their maximum values. Default is True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple): A tuple containing:</span>
<span class="sd">                - X (numpy.ndarray): Mesh grid for the first dimension.</span>
<span class="sd">                - Y (numpy.ndarray): Mesh grid for the second dimension.</span>
<span class="sd">                - Z (numpy.ndarray): Surrogate predictions over the grid.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; plot_data = S.prepare_plot(i=0, j=1)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh_grid</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">grid_points</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">grid_points</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">grid_points</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">validate_types</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dimensions of var_type, lower, and upper must be the same.&quot;</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0</span><span class="p">):</span>
            <span class="n">grid_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y</span><span class="p">)]</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">grid_points</span><span class="p">:</span>
                <span class="n">adjusted_z0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z0</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">adjusted_z0</span><span class="p">]))</span>
                <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Z</span>

        <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">generate_mesh_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">n_grid</span><span class="p">)</span>
        <span class="n">validate_types</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>

        <span class="n">z00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">])</span>
        <span class="n">Z_list</span><span class="p">,</span> <span class="n">X_list</span><span class="p">,</span> <span class="n">Y_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">use_min</span><span class="p">:</span>
            <span class="n">z0_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_z00</span><span class="p">(</span><span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Z_min</span> <span class="o">=</span> <span class="n">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0_min</span><span class="p">)</span>
            <span class="n">Z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z_min</span><span class="p">)</span>
            <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">Y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_max</span><span class="p">:</span>
            <span class="n">z0_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_z00</span><span class="p">(</span><span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">Z_max</span> <span class="o">=</span> <span class="n">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0_max</span><span class="p">)</span>
            <span class="n">Z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z_max</span><span class="p">)</span>
            <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">Y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">Z_list</span><span class="p">:</span>
            <span class="n">Z_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">Z_list</span><span class="p">)</span>
            <span class="n">X_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">X_list</span><span class="p">)</span>
            <span class="n">Y_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">Y_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data to plot.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">X_combined</span><span class="p">,</span> <span class="n">Y_combined</span><span class="p">,</span> <span class="n">Z_combined</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_contour</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">min_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">use_floor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
        <span class="n">grid_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
        <span class="n">max_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
        <span class="n">add_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a contour plot of the surrogate model for two hyperparameters.</span>
<span class="sd">        Args:</span>
<span class="sd">            i (int):</span>
<span class="sd">                index of the first hyperparameter to plot.</span>
<span class="sd">            j (int):</span>
<span class="sd">                index of the second hyperparameter to plot.</span>
<span class="sd">            min_z (float, optional):</span>
<span class="sd">                minimum value for the z-axis. If `None`, the minimum value is calculated from the surrogate predictions.</span>
<span class="sd">            max_z (float, optional):</span>
<span class="sd">                maximum value for the z-axis. If `None`, the maximum value is calculated from the surrogate predictions.</span>
<span class="sd">            show (bool):</span>
<span class="sd">                whether to show the plot. Default is `True`.</span>
<span class="sd">            title (str, optional):</span>
<span class="sd">                title of the plot. If `None`, a default title is used.</span>
<span class="sd">            filename (str, optional):</span>
<span class="sd">                filename to save the plot. If `None`, the plot is not saved.</span>
<span class="sd">            n_grid (int):</span>
<span class="sd">                number of grid points for the contour plot. Default is 100.</span>
<span class="sd">            contour_levels (int):</span>
<span class="sd">                number of contour levels. Default is 25.</span>
<span class="sd">            dpi (int):</span>
<span class="sd">                dots per inch for the saved plot. Default is 200.</span>
<span class="sd">            figsize (tuple):</span>
<span class="sd">                size of the figure for the plot. Default is (12, 5).</span>
<span class="sd">            use_floor (bool):</span>
<span class="sd">                If `True`, the floor values of the other hyperparameters are used for plotting. If `False`, the ceiling values are used. Default is `True`.</span>
<span class="sd">            tkagg (bool):</span>
<span class="sd">                If `True`, use the TkAgg backend for matplotlib. Default is `False`.</span>
<span class="sd">            cmap (str):</span>
<span class="sd">                Colormap to use for the contour plot. Default is &quot;jet&quot;.</span>
<span class="sd">            grid_visible (bool):</span>
<span class="sd">                If `True`, show the grid in the contour plot. Default is `True`.</span>
<span class="sd">            alpha (float):</span>
<span class="sd">                Transparency level for the contour lines. Default is 0.8.</span>
<span class="sd">            eps (float):</span>
<span class="sd">                Small value to avoid division by zero in the surrogate predictions. Default is 1e-4.</span>
<span class="sd">            max_error (float):</span>
<span class="sd">                Maximum error allowed in the surrogate predictions. Default is 1e-3.</span>
<span class="sd">            use_floor (bool):</span>
<span class="sd">                If `True`, use the minimum values of the other hyperparameters for plotting. If `False`, use the maximum values. Default is `True`.</span>
<span class="sd">            add_points (bool):</span>
<span class="sd">                If `True`, add the points from the surrogate model to the contour plot. Default is `True`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plotkd</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span>
            <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
            <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
            <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
            <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span><span class="p">,</span>
            <span class="n">var_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">,</span>
            <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span>
            <span class="n">grid_visible</span><span class="o">=</span><span class="n">grid_visible</span><span class="p">,</span>
            <span class="n">contour_levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span>
            <span class="n">max_error</span><span class="o">=</span><span class="n">max_error</span><span class="p">,</span>
            <span class="n">use_floor</span><span class="o">=</span><span class="n">use_floor</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">min_z</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">max_z</span><span class="p">,</span>
            <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
            <span class="n">add_points</span><span class="o">=</span><span class="n">add_points</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_important_hyperparameter_contour</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">max_imp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">scale_global</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the contour of important hyperparameters.</span>
<span class="sd">        Calls `plot_contour` for each pair of important hyperparameters.</span>
<span class="sd">        Importance can be specified by the threshold.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold (float):</span>
<span class="sd">                threshold for the importance. Not used any more in spotpython &gt;= 0.13.2.</span>
<span class="sd">            filename (str):</span>
<span class="sd">                filename of the plot</span>
<span class="sd">            show (bool):</span>
<span class="sd">                show the plot. Default is `True`.</span>
<span class="sd">            max_imp (int):</span>
<span class="sd">                maximum number of important hyperparameters. If there are more important hyperparameters</span>
<span class="sd">                than `max_imp`, only the max_imp important ones are selected.</span>
<span class="sd">            title (str):</span>
<span class="sd">                title of the plots</span>
<span class="sd">            scale_global (bool):</span>
<span class="sd">                scale the z-axis globally. Default is `False`.</span>
<span class="sd">            n_grid (int):</span>
<span class="sd">                number of grid points. Default is 50.</span>
<span class="sd">            contour_levels (int):</span>
<span class="sd">                number of contour levels. Default is 10.</span>
<span class="sd">            dpi (int):</span>
<span class="sd">                dpi of the plot. Default is 200.</span>
<span class="sd">            use_min (bool): Deprecated in 0.31.12.</span>
<span class="sd">            use_max (bool): Deprecated in 0.31.12.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 5</span>
<span class="sd">                # number of points</span>
<span class="sd">                fun_evals = 10</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1, 1]),</span>
<span class="sd">                    fun_evals=fun_evals,</span>
<span class="sd">                    tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                surrogate_control=surrogate_control_init)</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,</span>
<span class="sd">                            surrogate_control=surrogate_control,)</span>
<span class="sd">                S.run()</span>
<span class="sd">                S.plot_important_hyperparameter_contour()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">impo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_importance</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">sort_by_kth_and_return_indices</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">impo</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># take the first max_imp values from the indices array</span>
        <span class="k">if</span> <span class="n">max_imp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:</span><span class="n">max_imp</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scale_global</span><span class="p">:</span>
            <span class="n">min_z</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="n">max_z</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_z</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">max_z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">filename_full</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_contour_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">filename_full</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span>
                        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                        <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
                        <span class="n">min_z</span><span class="o">=</span><span class="n">min_z</span><span class="p">,</span>
                        <span class="n">max_z</span><span class="o">=</span><span class="n">max_z</span><span class="p">,</span>
                        <span class="n">filename</span><span class="o">=</span><span class="n">filename_full</span><span class="p">,</span>
                        <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                        <span class="n">n_grid</span><span class="o">=</span><span class="n">n_grid</span><span class="p">,</span>
                        <span class="n">contour_levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span>
                        <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
                        <span class="n">tkagg</span><span class="o">=</span><span class="n">tkagg</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get importance of each variable and return the results as a list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            output (list):</span>
<span class="sd">                list of results. If the surrogate has more than one theta values,</span>
<span class="sd">                the importance is calculated. Otherwise, an empty list is returned.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.spot import spot</span>
<span class="sd">            &gt;&gt;&gt; from spotpython.utils.init import (</span>
<span class="sd">            ...     fun_control_init,</span>
<span class="sd">            ...     surrogate_control_init,</span>
<span class="sd">            ...     design_control_init</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Create test function (3D sphere function)</span>
<span class="sd">            &gt;&gt;&gt; fun = Analytical().fun_sphere</span>
<span class="sd">            &gt;&gt;&gt; # Setup control parameters</span>
<span class="sd">            &gt;&gt;&gt; fun_control = fun_control_init(</span>
<span class="sd">            ...     lower=np.array([-1, -1, -1]),</span>
<span class="sd">            ...     upper=np.array([1, 1, 1]),</span>
<span class="sd">            ...     fun_evals=20,</span>
<span class="sd">            ...     var_name=[&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;],</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Setup design with initial size</span>
<span class="sd">            &gt;&gt;&gt; design_control = design_control_init(init_size=10)</span>
<span class="sd">            &gt;&gt;&gt; # Setup surrogate model with multiple theta values</span>
<span class="sd">            &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">            ...     method=&quot;interpolation&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Initialize and run spot</span>
<span class="sd">            &gt;&gt;&gt; S = spot.Spot(</span>
<span class="sd">            ...     fun=fun,</span>
<span class="sd">            ...     fun_control=fun_control,</span>
<span class="sd">            ...     design_control=design_control,</span>
<span class="sd">            ...     surrogate_control=surrogate_control</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; S.run()</span>
<span class="sd">            &gt;&gt;&gt; # Get importance values</span>
<span class="sd">            &gt;&gt;&gt; importance = S.get_importance()</span>
<span class="sd">            &gt;&gt;&gt; for var, imp in zip(S.all_var_name, importance):</span>
<span class="sd">            ...     print(f&quot;{var}: {imp:.2f}%&quot;)</span>
<span class="sd">            x1: 100.00%</span>
<span class="sd">            x2: 85.32%</span>
<span class="sd">            x3: 76.15%</span>
<span class="sd">            &gt;&gt;&gt; # Try with single theta (should return zeros)</span>
<span class="sd">            &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">            ...     isotropie=True,</span>
<span class="sd">            ...     method=&quot;interpolation&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; S2 = spot.Spot(</span>
<span class="sd">            ...     fun=fun,</span>
<span class="sd">            ...     fun_control=fun_control,</span>
<span class="sd">            ...     design_control=design_control,</span>
<span class="sd">            ...     surrogate_control=surrogate_control</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; S2.run()</span>
<span class="sd">            &gt;&gt;&gt; importance2 = S2.get_importance()</span>
<span class="sd">            &gt;&gt;&gt; print(importance2)</span>
<span class="sd">            []</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if surrogate exists and surrogate is not None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;surrogate&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No surrogate model available.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># check if surrogate name is &quot;Kriging&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Kriging&quot;</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance calculation is only available for Kriging surrogate models.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># Check if all required attributes exist for importance calculation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;all_var_name&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable names (all_var_name) not available.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">get_params</span><span class="p">()[</span><span class="s2">&quot;n_theta&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n_theta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of theta values (n_theta) not available. Check if surrogate is fitted.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;var_name&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">)</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
                <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">)</span>

                <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">:</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">imp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">output</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating importance values: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance requires more than one theta values (n_theta&gt;1) and valid variable names.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print importance of each variable and return the results as a list.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold (float):</span>
<span class="sd">                threshold for printing</span>
<span class="sd">            print_screen (boolean):</span>
<span class="sd">                if `True`, values are also printed on the screen. Default is `True`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            output (list):</span>
<span class="sd">                list of results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="c1"># imp = imp[imp &gt;= threshold]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">))]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance requires more than one theta value (n_theta&gt;1).&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the importance of each variable.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold (float):</span>
<span class="sd">                The threshold of the importance.</span>
<span class="sd">            filename (str):</span>
<span class="sd">                The filename of the plot.</span>
<span class="sd">            dpi (int):</span>
<span class="sd">                The dpi of the plot.</span>
<span class="sd">            show (bool):</span>
<span class="sd">                Show the plot. Default is `True`.</span>
<span class="sd">            tkagg (bool):</span>
<span class="sd">                Use TkAgg backend. Default is `False`.</span>
<span class="sd">            figsize (tuple):</span>
<span class="sd">                Figure size (width, height) in inches. Default is (9, 6).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tkagg</span><span class="p">:</span>
                <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>

            <span class="c1"># Create figure with specified size</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">imp</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">var_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parallel plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                Spot object</span>
<span class="sd">            show (bool):</span>
<span class="sd">                show the plot. Default is `False`.</span>

<span class="sd">        Returns:</span>
<span class="sd">                fig (plotly.graph_objects.Figure): figure object</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                    )</span>
<span class="sd">                # number of initial points:</span>
<span class="sd">                ni = 5</span>
<span class="sd">                # number of points</span>
<span class="sd">                fun_evals = 10</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1, 1]),</span>
<span class="sd">                    fun_evals=fun_evals,</span>
<span class="sd">                    tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                    )</span>
<span class="sd">                design_control=design_control_init(init_size=ni)</span>
<span class="sd">                surrogate_control=surrogate_control_init()</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            fun_control=fun_control,</span>
<span class="sd">                            design_control=design_control,</span>
<span class="sd">                            surrogate_control=surrogate_control,)</span>
<span class="sd">                S.run()</span>
<span class="sd">                S.parallel_plot()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">colorscale</span><span class="o">=</span><span class="s2">&quot;Jet&quot;</span><span class="p">,</span> <span class="n">showscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]),</span> <span class="n">cmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])),</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="nb">list</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])],</span> <span class="n">label</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_reattach_logger_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reattach handlers to the logger after unpickling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="c1"># configure the handler and formatter as needed</span>
        <span class="n">py_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.log&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">py_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(name)s</span><span class="s2"> </span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># add formatter to the handler</span>
        <span class="n">py_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">py_formatter</span><span class="p">)</span>
        <span class="c1"># add handler to the logger</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">py_handler</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_de_serialize_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deserialize the spot object and return the dictionaries.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object):</span>
<span class="sd">                Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple):</span>
<span class="sd">                tuple containing dictionaries of spot object:</span>
<span class="sd">                fun_control (dict): function control dictionary,</span>
<span class="sd">                design_control (dict): design control dictionary,</span>
<span class="sd">                optimizer_control (dict): optimizer control dictionary,</span>
<span class="sd">                spot_tuner_control (dict): spot tuner control dictionary, and</span>
<span class="sd">                surrogate_control (dict): surrogate control dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spot_tuner</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">spot_tuner</span><span class="p">)</span>

        <span class="n">fun_control</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s2">&quot;fun_control&quot;</span><span class="p">])</span>
        <span class="n">design_control</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s2">&quot;design_control&quot;</span><span class="p">])</span>
        <span class="n">optimizer_control</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s2">&quot;optimizer_control&quot;</span><span class="p">])</span>
        <span class="n">surrogate_control</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s2">&quot;surrogate_control&quot;</span><span class="p">])</span>

        <span class="c1"># remove keys from the dictionaries:</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fun_control&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;design_control&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;optimizer_control&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;surrogate_control&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;spot_writer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fun&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;optimizer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;rng&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spot_tuner_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;surrogate&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;core_model&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;metric_river&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;metric_sklearn&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;metric_torch&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;prep_model&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;spot_writer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">surrogate_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;model_optimizer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">surrogate_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;surrogate&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">design_control</span><span class="p">,</span> <span class="n">optimizer_control</span><span class="p">,</span> <span class="n">spot_tuner_control</span><span class="p">,</span> <span class="n">surrogate_control</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_write_db_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a dictionary with the experiment parameters to the json file spotpython_db.json.</span>

<span class="sd">        Args:</span>
<span class="sd">            self (object): Spot object</span>

<span class="sd">        Returns:</span>
<span class="sd">            (NoneType): None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the time in seconds from 1.1.1970 and convert the time to a string</span>
        <span class="n">t_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="n">ident</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">t_str</span>

        <span class="p">(</span>
            <span class="n">fun_control</span><span class="p">,</span>
            <span class="n">design_control</span><span class="p">,</span>
            <span class="n">optimizer_control</span><span class="p">,</span>
            <span class="n">spot_tuner_control</span><span class="p">,</span>
            <span class="n">surrogate_control</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_de_serialize_dicts</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">**&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The following dictionaries are written to the json file spotpython_db.json:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fun_control:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fun_control</span><span class="p">)</span>

        <span class="c1"># Iterate over a list of the keys to avoid modifying the dictionary during iteration</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">fun_control</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fun_control</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="c1"># remove the key from the dictionary</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing non-serializable key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">fun_control</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fun_control after removing non-serializabel keys:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;design_control:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">design_control</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimizer_control:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">optimizer_control</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spot_tuner_control:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">spot_tuner_control</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;surrogate_control:&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">surrogate_control</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Generate a description of the results:</span>
        <span class="c1"># if spot_tuner_control[&#39;min_y&#39;] exists:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                      Results for </span><span class="si">{</span><span class="n">ident</span><span class="si">}</span><span class="s2">: Finally, the best value is </span><span class="si">{</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s1">&#39;min_y&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">                      at </span><span class="si">{</span><span class="n">spot_tuner_control</span><span class="p">[</span><span class="s1">&#39;min_X&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;&quot;&quot;</span>
            <span class="c1">#</span>
            <span class="n">db_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ident</span><span class="p">),</span>
                    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
                    <span class="s2">&quot;fun_control&quot;</span><span class="p">:</span> <span class="n">fun_control</span><span class="p">,</span>
                    <span class="s2">&quot;design_control&quot;</span><span class="p">:</span> <span class="n">design_control</span><span class="p">,</span>
                    <span class="s2">&quot;surrogate_control&quot;</span><span class="p">:</span> <span class="n">surrogate_control</span><span class="p">,</span>
                    <span class="s2">&quot;optimizer_control&quot;</span><span class="p">:</span> <span class="n">optimizer_control</span><span class="p">,</span>
                    <span class="s2">&quot;spot_tuner_control&quot;</span><span class="p">:</span> <span class="n">spot_tuner_control</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="c1"># Check if the directory &quot;db_dicts&quot; exists.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;db_dicts&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;db_dicts&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating directory: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;db_dicts&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Open the file in append mode to add each new dict as a new line</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;db_dicts/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;db_dict_name&quot;</span><span class="p">],</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="c1"># Using json.dumps to convert the dict to a JSON formatted string</span>
                        <span class="c1"># We then write this string to the file followed by a newline character</span>
                        <span class="c1"># This ensures that each dict is on its own line, conforming to the JSON Lines format</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">db_dict</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyEncoder</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error writing to file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No results to write.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.chg" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.chg" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Change the values of elements at indices <code>i</code> and <code>j</code> in the array <code>z0</code> to <code>x</code> and <code>y</code>, respectively.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="int">int</span> or <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new value for the element at index <code>i</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="int">int</span> or <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new value for the element at index <code>j</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z0</code>
            </td>
            <td>
                  <code><span title="list">list</span> or <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the element to be changed to <code>x</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the element to be changed to <code>y</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list) or (numpy.ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">    )</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1]),</span>
<span class="go">        upper = np.array([1]),</span>
<span class="go">    )</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                func_control=fun_control)</span>
<span class="go">    z0 = [1, 2, 3]</span>
<span class="go">    print(f&quot;Before: {z0}&quot;)</span>
<span class="go">    new_val_1 = 4</span>
<span class="go">    new_val_2 = 5</span>
<span class="go">    index_1 = 0</span>
<span class="go">    index_2 = 2</span>
<span class="go">    S.chg(x=new_val_1, y=new_val_2, z0=z0, i=index_1, j=index_2)</span>
<span class="go">    print(f&quot;After: {z0}&quot;)</span>
<span class="go">    Before: [1, 2, 3]</span>
<span class="go">    After: [4, 2, 5]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">chg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change the values of elements at indices `i` and `j` in the array `z0` to `x` and `y`, respectively.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (int or float):</span>
<span class="sd">            The new value for the element at index `i`.</span>
<span class="sd">        y (int or float):</span>
<span class="sd">            The new value for the element at index `j`.</span>
<span class="sd">        z0 (list or numpy.ndarray):</span>
<span class="sd">            The array to be modified.</span>
<span class="sd">        i (int):</span>
<span class="sd">            The index of the element to be changed to `x`.</span>
<span class="sd">        j (int):</span>
<span class="sd">            The index of the element to be changed to `y`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list) or (numpy.ndarray): The modified array.</span>

<span class="sd">    Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">                from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">                from spotpython.spot import spot</span>
<span class="sd">                from spotpython.utils.init import (</span>
<span class="sd">                    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">                fun = analytical().fun_sphere</span>
<span class="sd">                fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1]),</span>
<span class="sd">                    upper = np.array([1]),</span>
<span class="sd">                )</span>
<span class="sd">                S = spot.Spot(fun=fun,</span>
<span class="sd">                            func_control=fun_control)</span>
<span class="sd">                z0 = [1, 2, 3]</span>
<span class="sd">                print(f&quot;Before: {z0}&quot;)</span>
<span class="sd">                new_val_1 = 4</span>
<span class="sd">                new_val_2 = 5</span>
<span class="sd">                index_1 = 0</span>
<span class="sd">                index_2 = 2</span>
<span class="sd">                S.chg(x=new_val_1, y=new_val_2, z0=z0, i=index_1, j=index_2)</span>
<span class="sd">                print(f&quot;After: {z0}&quot;)</span>
<span class="sd">                Before: [1, 2, 3]</span>
<span class="sd">                After: [4, 2, 5]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">z0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">z0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">z0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.evaluate_initial_design" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_initial_design</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.evaluate_initial_design" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluate the initial design.</p>
<p>This method evaluates the initial design matrix <code>X0</code> by applying the objective function
and handling NaN values. The results are stored in <code>self.X</code> and <code>self.y</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the resulting design matrix has zero rows after removing NaN values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower=np.array([-1, -1]),</span>
<span class="go">        upper=np.array([1, 1])</span>
<span class="go">    )</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    S = Spot(fun=fun, fun_control=fun_control)</span>
<span class="go">    X0 = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="go">    S.initialize_design_matrix(X_start=X0)</span>
<span class="go">    S.evaluate_initial_design()</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">        S.X: [[ 0.          0.        ]</span>
<span class="go">        [ 0.          1.        ]</span>
<span class="go">        [ 1.          0.        ]</span>
<span class="go">        [ 1.          1.        ]</span>
<span class="go">        [ 0.86352963  0.7892358 ]</span>
<span class="go">        [-0.24407197 -0.83687436]</span>
<span class="go">        [ 0.36481882  0.8375811 ]</span>
<span class="go">        [ 0.415331    0.54468512]</span>
<span class="go">        [-0.56395091 -0.77797854]</span>
<span class="go">        [-0.90259409 -0.04899292]</span>
<span class="go">        [-0.16484832  0.35724741]</span>
<span class="go">        [ 0.05170659  0.07401196]</span>
<span class="go">        [-0.78548145 -0.44638164]</span>
<span class="go">        [ 0.64017497 -0.30363301]]</span>
<span class="go">        S.y: [0.         1.         1.         2.         1.36857656 0.75992983</span>
<span class="go">        0.83463487 0.46918172 0.92329124 0.8170764  0.15480068 0.00815134</span>
<span class="go">        0.81623768 0.502017  ]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_initial_design</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the initial design.</span>

<span class="sd">    This method evaluates the initial design matrix `X0` by applying the objective function</span>
<span class="sd">    and handling NaN values. The results are stored in `self.X` and `self.y`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the resulting design matrix has zero rows after removing NaN values.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower=np.array([-1, -1]),</span>
<span class="sd">                upper=np.array([1, 1])</span>
<span class="sd">            )</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            S = Spot(fun=fun, fun_control=fun_control)</span>
<span class="sd">            X0 = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">            S.initialize_design_matrix(X_start=X0)</span>
<span class="sd">            S.evaluate_initial_design()</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                S.X: [[ 0.          0.        ]</span>
<span class="sd">                [ 0.          1.        ]</span>
<span class="sd">                [ 1.          0.        ]</span>
<span class="sd">                [ 1.          1.        ]</span>
<span class="sd">                [ 0.86352963  0.7892358 ]</span>
<span class="sd">                [-0.24407197 -0.83687436]</span>
<span class="sd">                [ 0.36481882  0.8375811 ]</span>
<span class="sd">                [ 0.415331    0.54468512]</span>
<span class="sd">                [-0.56395091 -0.77797854]</span>
<span class="sd">                [-0.90259409 -0.04899292]</span>
<span class="sd">                [-0.16484832  0.35724741]</span>
<span class="sd">                [ 0.05170659  0.07401196]</span>
<span class="sd">                [-0.78548145 -0.44638164]</span>
<span class="sd">                [ 0.64017497 -0.30363301]]</span>
<span class="sd">                S.y: [0.         1.         1.         2.         1.36857656 0.75992983</span>
<span class="sd">                0.83463487 0.46918172 0.92329124 0.8170764  0.15480068 0.00815134</span>
<span class="sd">                0.81623768 0.502017  ]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check that self.X has at leat one row and is not None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The design matrix has zero rows. Check design_control[&#39;init_size&#39;] or X_start.&quot;</span><span class="p">)</span>

    <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), before calling self.fun: X_all: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_all</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), before calling self.fun: fun_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>

    <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_mo as returned from fun(): </span><span class="si">{</span><span class="n">y_mo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_mo shape: </span><span class="si">{</span><span class="n">y_mo</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">#  Convert multi-objective values to single-objective values</span>
    <span class="c1"># TODO: Store y_mo in self.y_mo (append new values)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), after calling self.fun: self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># TODO: Error if only nan values are returned</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;New y value: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The resulting design matrix has zero rows after removing NaN values.&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), final X val, after remove nan: self.X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() evaluate_initial_design(), final y val, after remove nan: self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.fit_surrogate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_surrogate</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.fit_surrogate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fit surrogate model. The surrogate model
is fitted to the data stored in <code>self.X</code> and <code>self.y</code>.
It uses the generic <code>fit()</code> method of the
surrogate model <code>surrogate</code>. The default surrogate model is
an instance from spotpython&rsquo;s <code>Kriging</code> class.
If <code>show_models</code> is <code>True</code>, the model is plotted.
If the number of points is greater than <code>max_surrogate_points</code>,
the surrogate model is fitted to a subset of the data points.
The subset is selected using the <code>select_distant_points()</code> function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.fit_surrogate.self.surrogate">self.surrogate</span></code></td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>surrogate model</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.fit_surrogate.self.X">self.X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>design points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.fit_surrogate.self.y">self.y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>function values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.fit_surrogate.self.max_surrogate_points">self.max_surrogate_points</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum number of points to fit the surrogate model</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.fit_surrogate.self.show_models">self.show_models</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, the model is plotted</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>As shown in https://sequential-parameter-optimization.github.io/Hyperparameter-Tuning-Cookbook/
other surrogate models can be used as well.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">    fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">    )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 0</span>
<span class="go">    X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1])</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.initialize_design(X_start=X_start)</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.surrogate.predict(np.array([[0, 0]]))</span>
<span class="go">        array([1.49011612e-08])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit_surrogate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit surrogate model. The surrogate model</span>
<span class="sd">    is fitted to the data stored in `self.X` and `self.y`.</span>
<span class="sd">    It uses the generic `fit()` method of the</span>
<span class="sd">    surrogate model `surrogate`. The default surrogate model is</span>
<span class="sd">    an instance from spotpython&#39;s `Kriging` class.</span>
<span class="sd">    If `show_models` is `True`, the model is plotted.</span>
<span class="sd">    If the number of points is greater than `max_surrogate_points`,</span>
<span class="sd">    the surrogate model is fitted to a subset of the data points.</span>
<span class="sd">    The subset is selected using the `select_distant_points()` function.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): Spot object</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.surrogate (object):</span>
<span class="sd">            surrogate model</span>
<span class="sd">        self.X (numpy.ndarray):</span>
<span class="sd">            design points</span>
<span class="sd">        self.y (numpy.ndarray):</span>
<span class="sd">            function values</span>
<span class="sd">        self.max_surrogate_points (int):</span>
<span class="sd">            maximum number of points to fit the surrogate model</span>
<span class="sd">        self.show_models (bool):</span>
<span class="sd">            if True, the model is plotted</span>

<span class="sd">    Note:</span>
<span class="sd">        * As shown in https://sequential-parameter-optimization.github.io/Hyperparameter-Tuning-Cookbook/</span>
<span class="sd">        other surrogate models can be used as well.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">            fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">            )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 0</span>
<span class="sd">            X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.initialize_design(X_start=X_start)</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.surrogate.predict(np.array([[0, 0]]))</span>
<span class="sd">                array([1.49011612e-08])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.X.shape: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In fit_surrogate(): self.y.shape: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">X_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">X_points</span> <span class="o">==</span> <span class="n">y_points</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">X_points</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_surrogate_points</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting distant points for surrogate fitting.&quot;</span><span class="p">)</span>
            <span class="n">X_S</span><span class="p">,</span> <span class="n">y_S</span> <span class="o">=</span> <span class="n">select_distant_points</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_surrogate_points</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
            <span class="n">y_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_S</span><span class="p">,</span> <span class="n">y_S</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;X and y have different sizes. Surrogate not fitted.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_models</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.generate_design" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_design</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.generate_design" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a design with <code>size</code> points in the interval [lower, upper].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>repeats</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of repeats</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lower bound of the design space</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>upper bound of the design space</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>design points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import design_control_init</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    design_control = design_control_init(init_size=3)</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1]),</span>
<span class="go">        fun_evals=fun_evals,</span>
<span class="go">        tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="go">        )</span>
<span class="go">    S = spot.Spot(fun = analytical().fun_sphere,</span>
<span class="go">                fun_control = fun_control,</span>
<span class="go">                design_control = design_control)</span>
<span class="go">    X = S.generate_design(size=3, repeats=1, lower=np.array([0, 0]), upper=np.array([100, 1]))</span>
<span class="go">    assert X.shape[0] == 3</span>
<span class="go">    assert X.shape[1] == 2</span>
<span class="go">    print(X)</span>
<span class="go">        array([[77.25493789,  0.31539299],</span>
<span class="go">        [59.32133757,  0.93854273],</span>
<span class="go">        [27.4698033 ,  0.3959685 ]])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a design with `size` points in the interval [lower, upper].</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int): number of points</span>
<span class="sd">        repeats (int): number of repeats</span>
<span class="sd">        lower (numpy.ndarray): lower bound of the design space</span>
<span class="sd">        upper (numpy.ndarray): upper bound of the design space</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): design points</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import design_control_init</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            design_control = design_control_init(init_size=3)</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1]),</span>
<span class="sd">                fun_evals=fun_evals,</span>
<span class="sd">                tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                )</span>
<span class="sd">            S = spot.Spot(fun = analytical().fun_sphere,</span>
<span class="sd">                        fun_control = fun_control,</span>
<span class="sd">                        design_control = design_control)</span>
<span class="sd">            X = S.generate_design(size=3, repeats=1, lower=np.array([0, 0]), upper=np.array([100, 1]))</span>
<span class="sd">            assert X.shape[0] == 3</span>
<span class="sd">            assert X.shape[1] == 2</span>
<span class="sd">            print(X)</span>
<span class="sd">                array([[77.25493789,  0.31539299],</span>
<span class="sd">                [59.32133757,  0.93854273],</span>
<span class="sd">                [27.4698033 ,  0.3959685 ]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">scipy_lhd</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="n">repeats</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.generate_random_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_random_point</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.generate_random_point" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a random point in the design space.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple containing:
X0 (numpy.ndarray): random point in the design space
y0 (numpy.ndarray): function value at X</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>If the evaluation fails, the function returns arrays of shape[0] == 0.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1])</span>
<span class="go">        )</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                )</span>
<span class="go">    X0, y0 = S.generate_random_point()</span>
<span class="go">    print(f&quot;X0: {X0}&quot;)</span>
<span class="go">    print(f&quot;y0: {y0}&quot;)</span>
<span class="go">    assert X0.size == 2</span>
<span class="go">    assert y0.size == 1</span>
<span class="go">    assert np.all(X0 &gt;= S.lower)</span>
<span class="go">    assert np.all(X0 &lt;= S.upper)</span>
<span class="go">    assert y0 &gt;= 0</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_random_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a random point in the design space.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): tuple containing:</span>
<span class="sd">            X0 (numpy.ndarray): random point in the design space</span>
<span class="sd">            y0 (numpy.ndarray): function value at X</span>

<span class="sd">    Notes:</span>
<span class="sd">        If the evaluation fails, the function returns arrays of shape[0] == 0.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        )</span>
<span class="sd">            X0, y0 = S.generate_random_point()</span>
<span class="sd">            print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">            print(f&quot;y0: {y0}&quot;)</span>
<span class="sd">            assert X0.size == 2</span>
<span class="sd">            assert y0.size == 1</span>
<span class="sd">            assert np.all(X0 &gt;= S.lower)</span>
<span class="sd">            assert np.all(X0 &lt;= S.upper)</span>
<span class="sd">            assert y0 &gt;= 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">repeats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
        <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X0</span><span class="p">,</span> <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
    <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() generate_random_point(), before calling self.fun: X_all: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_all</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In Spot() generate_random_point(), before calling self.fun: fun_control: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
    <span class="c1"># Convert multi-objective values to single-objective values</span>
    <span class="c1"># TODO: Store y_mo in self.y_mo (append new values)</span>
    <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
    <span class="c1"># Apply penalty for NA values works only on so values:</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.get_importance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_importance</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.get_importance" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get importance of each variable and return the results as a list.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>output</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of results. If the surrogate has more than one theta values,
the importance is calculated. Otherwise, an empty list is returned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.fun.objectivefunctions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Analytical</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.spot</span><span class="w"> </span><span class="kn">import</span> <span class="n">spot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.utils.init</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun_control_init</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate_control_init</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">design_control_init</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create test function (3D sphere function)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fun</span> <span class="o">=</span> <span class="n">Analytical</span><span class="p">()</span><span class="o">.</span><span class="n">fun_sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup control parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fun_control</span> <span class="o">=</span> <span class="n">fun_control_init</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">lower</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">fun_evals</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">var_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup design with initial size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">design_control</span> <span class="o">=</span> <span class="n">design_control_init</span><span class="p">(</span><span class="n">init_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup surrogate model with multiple theta values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_control</span> <span class="o">=</span> <span class="n">surrogate_control_init</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize and run spot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">spot</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun</span><span class="o">=</span><span class="n">fun</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">design_control</span><span class="o">=</span><span class="n">design_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate_control</span><span class="o">=</span><span class="n">surrogate_control</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get importance values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">importance</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">get_importance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">imp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">,</span> <span class="n">importance</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">imp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="go">x1: 100.00%</span>
<span class="go">x2: 85.32%</span>
<span class="go">x3: 76.15%</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Try with single theta (should return zeros)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_control</span> <span class="o">=</span> <span class="n">surrogate_control_init</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">isotropie</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span> <span class="o">=</span> <span class="n">spot</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun</span><span class="o">=</span><span class="n">fun</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">design_control</span><span class="o">=</span><span class="n">design_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate_control</span><span class="o">=</span><span class="n">surrogate_control</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">importance2</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">get_importance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">importance2</span><span class="p">)</span>
<span class="go">[]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get importance of each variable and return the results as a list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        output (list):</span>
<span class="sd">            list of results. If the surrogate has more than one theta values,</span>
<span class="sd">            the importance is calculated. Otherwise, an empty list is returned.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.spot import spot</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.utils.init import (</span>
<span class="sd">        ...     fun_control_init,</span>
<span class="sd">        ...     surrogate_control_init,</span>
<span class="sd">        ...     design_control_init</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; # Create test function (3D sphere function)</span>
<span class="sd">        &gt;&gt;&gt; fun = Analytical().fun_sphere</span>
<span class="sd">        &gt;&gt;&gt; # Setup control parameters</span>
<span class="sd">        &gt;&gt;&gt; fun_control = fun_control_init(</span>
<span class="sd">        ...     lower=np.array([-1, -1, -1]),</span>
<span class="sd">        ...     upper=np.array([1, 1, 1]),</span>
<span class="sd">        ...     fun_evals=20,</span>
<span class="sd">        ...     var_name=[&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;],</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; # Setup design with initial size</span>
<span class="sd">        &gt;&gt;&gt; design_control = design_control_init(init_size=10)</span>
<span class="sd">        &gt;&gt;&gt; # Setup surrogate model with multiple theta values</span>
<span class="sd">        &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">        ...     method=&quot;interpolation&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; # Initialize and run spot</span>
<span class="sd">        &gt;&gt;&gt; S = spot.Spot(</span>
<span class="sd">        ...     fun=fun,</span>
<span class="sd">        ...     fun_control=fun_control,</span>
<span class="sd">        ...     design_control=design_control,</span>
<span class="sd">        ...     surrogate_control=surrogate_control</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; S.run()</span>
<span class="sd">        &gt;&gt;&gt; # Get importance values</span>
<span class="sd">        &gt;&gt;&gt; importance = S.get_importance()</span>
<span class="sd">        &gt;&gt;&gt; for var, imp in zip(S.all_var_name, importance):</span>
<span class="sd">        ...     print(f&quot;{var}: {imp:.2f}%&quot;)</span>
<span class="sd">        x1: 100.00%</span>
<span class="sd">        x2: 85.32%</span>
<span class="sd">        x3: 76.15%</span>
<span class="sd">        &gt;&gt;&gt; # Try with single theta (should return zeros)</span>
<span class="sd">        &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">        ...     isotropie=True,</span>
<span class="sd">        ...     method=&quot;interpolation&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; S2 = spot.Spot(</span>
<span class="sd">        ...     fun=fun,</span>
<span class="sd">        ...     fun_control=fun_control,</span>
<span class="sd">        ...     design_control=design_control,</span>
<span class="sd">        ...     surrogate_control=surrogate_control</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; S2.run()</span>
<span class="sd">        &gt;&gt;&gt; importance2 = S2.get_importance()</span>
<span class="sd">        &gt;&gt;&gt; print(importance2)</span>
<span class="sd">        []</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if surrogate exists and surrogate is not None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;surrogate&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No surrogate model available.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># check if surrogate name is &quot;Kriging&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Kriging&quot;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance calculation is only available for Kriging surrogate models.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Check if all required attributes exist for importance calculation</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;all_var_name&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable names (all_var_name) not available.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">n_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">get_params</span><span class="p">()[</span><span class="s2">&quot;n_theta&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n_theta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of theta values (n_theta) not available. Check if surrogate is fitted.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;var_name&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">imp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">output</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating importance values: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance requires more than one theta values (n_theta&gt;1) and valid variable names.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.get_new_X0" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_new_X0</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.get_new_X0" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate new design points for the optimization process.
This method attempts to suggest and repair new design points using the surrogate model
and experimental design techniques. If no valid new points are found within the specified
tolerance, a new experimental design is generated.</p>
<p>Calls <code>suggest_new_X()</code> and repairs the new design points, e.g.,
by <code>repair_non_numeric()</code> and <code>selectNew()</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: New design points, possibly repeated according to <code>self.fun_repeats</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.design">self.design</span></code></td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An experimental design object used to generate new points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.n_points">self.n_points</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expected number of new points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.fun_repeats">self.fun_repeats</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of times to repeat new points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.tolerance_x">self.tolerance_x</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum distance required between new and existing solutions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.var_type">self.var_type</span></code></td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable types for the design points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.X">self.X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing solution points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.k">self.k</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.fun_control">self.fun_control</span></code></td>
            <td>
                  <code><span title="Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameters for the function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.get_new_X0.self.counter">self.counter</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iteration counter</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If no new valid design points are suggested, the function resorts
  to a space-filling design technique to generate the required points.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init,  design_control_init</span>
<span class="go">        )</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 3</span>
<span class="go">    X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">                n_points=10,</span>
<span class="go">                ocba_delta=0,</span>
<span class="go">                lower = np.array([-1, -1]),</span>
<span class="go">                upper = np.array([1, 1])</span>
<span class="go">    )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,</span>
<span class="go">    )</span>
<span class="go">    S.initialize_design(X_start=X_start)</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    X0 = S.get_new_X0()</span>
<span class="go">    assert X0.shape[0] == S.n_points</span>
<span class="go">    assert X0.shape[1] == S.lower.size</span>
<span class="go">    # assert new points are in the interval [lower, upper]</span>
<span class="go">    assert np.all(X0 &gt;= S.lower)</span>
<span class="go">    assert np.all(X0 &lt;= S.upper)</span>
<span class="go">    # print using 20 digits precision</span>
<span class="go">    np.set_printoptions(precision=20)</span>
<span class="go">    print(f&quot;X0: {X0}&quot;)</span>
<span class="go">    X0: [[-0.43905273463270317 -0.20947824142606025]</span>
<span class="go">        [-0.4390526520612617  -0.20947735118625146]</span>
<span class="go">        [-0.4390526516559971  -0.20947735345727678]</span>
<span class="go">        [-0.4390526491133424  -0.20947735153559494]</span>
<span class="go">        [-0.43905264887606393 -0.209477347335596  ]</span>
<span class="go">        [-0.43905264815296263 -0.20947734884431773]</span>
<span class="go">        [-0.4390526481478378  -0.2094773501907511 ]</span>
<span class="go">        [-0.43905264791185933 -0.20947734931732975]</span>
<span class="go">        [-0.43905264783691894 -0.20947734910961185]</span>
<span class="go">        [-0.4390526473921517  -0.2094773511154602 ]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_new_X0</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate new design points for the optimization process.</span>
<span class="sd">    This method attempts to suggest and repair new design points using the surrogate model</span>
<span class="sd">    and experimental design techniques. If no valid new points are found within the specified</span>
<span class="sd">    tolerance, a new experimental design is generated.</span>

<span class="sd">    Calls `suggest_new_X()` and repairs the new design points, e.g.,</span>
<span class="sd">    by `repair_non_numeric()` and `selectNew()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: New design points, possibly repeated according to `self.fun_repeats`.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.design (object): An experimental design object used to generate new points</span>
<span class="sd">        self.n_points (int): The expected number of new points</span>
<span class="sd">        self.fun_repeats (int): The number of times to repeat new points</span>
<span class="sd">        self.tolerance_x (float): Minimum distance required between new and existing solutions</span>
<span class="sd">        self.var_type (List[str]): Variable types for the design points</span>
<span class="sd">        self.X (np.ndarray): Existing solution points</span>
<span class="sd">        self.k (int): Number of dimensions</span>
<span class="sd">        self.fun_control (Dict): Control parameters for the function</span>
<span class="sd">        self.counter (int): Iteration counter</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If no new valid design points are suggested, the function resorts</span>
<span class="sd">          to a space-filling design technique to generate the required points.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init,  design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 3</span>
<span class="sd">            X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                        n_points=10,</span>
<span class="sd">                        ocba_delta=0,</span>
<span class="sd">                        lower = np.array([-1, -1]),</span>
<span class="sd">                        upper = np.array([1, 1])</span>
<span class="sd">            )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">            )</span>
<span class="sd">            S.initialize_design(X_start=X_start)</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            X0 = S.get_new_X0()</span>
<span class="sd">            assert X0.shape[0] == S.n_points</span>
<span class="sd">            assert X0.shape[1] == S.lower.size</span>
<span class="sd">            # assert new points are in the interval [lower, upper]</span>
<span class="sd">            assert np.all(X0 &gt;= S.lower)</span>
<span class="sd">            assert np.all(X0 &lt;= S.upper)</span>
<span class="sd">            # print using 20 digits precision</span>
<span class="sd">            np.set_printoptions(precision=20)</span>
<span class="sd">            print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">            X0: [[-0.43905273463270317 -0.20947824142606025]</span>
<span class="sd">                [-0.4390526520612617  -0.20947735118625146]</span>
<span class="sd">                [-0.4390526516559971  -0.20947735345727678]</span>
<span class="sd">                [-0.4390526491133424  -0.20947735153559494]</span>
<span class="sd">                [-0.43905264887606393 -0.209477347335596  ]</span>
<span class="sd">                [-0.43905264815296263 -0.20947734884431773]</span>
<span class="sd">                [-0.4390526481478378  -0.2094773501907511 ]</span>
<span class="sd">                [-0.43905264791185933 -0.20947734931732975]</span>
<span class="sd">                [-0.43905264783691894 -0.20947734910961185]</span>
<span class="sd">                [-0.4390526473921517  -0.2094773511154602 ]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Try to generate self.fun_repeats new X0 points:</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggest_new_X</span><span class="p">()</span>
    <span class="c1"># Repair non-numeric variables based on their types</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
    <span class="c1"># Condition: select only X0 that have min distance self.tolerance_x</span>
    <span class="c1"># to existing solutions</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X0_ind</span> <span class="o">=</span> <span class="n">selectNew</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">X0</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance_x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># If valid new points are found, repeat them as specified</span>
        <span class="c1"># There are X0 that fullfil the condition.</span>
        <span class="c1"># Note: The number of new X0 can be smaller than self.n_points!</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;XO values are new: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X0_ind</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">repeat</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_repeats</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># If no X0 found, then generate self.n_points new solutions:</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">design</span> <span class="o">=</span> <span class="n">SpaceFilling</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">],</span> <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No new XO found on surrogate. Generate new solution </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">X0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.get_spot_attributes_as_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_spot_attributes_as_df</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.get_spot_attributes_as_df" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get all attributes of the spot object as a pandas dataframe.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe with all attributes of the spot object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from math import inf</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 7</span>
<span class="go">    # number of points</span>
<span class="go">    n = 10</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1]),</span>
<span class="go">        upper = np.array([1]),</span>
<span class="go">        fun_evals=n)</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    spot_1 = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    spot_1.run()</span>
<span class="go">    df = spot_1.get_spot_attributes_as_df()</span>
<span class="go">df</span>
<span class="go">    df</span>
<span class="go">        Attribute Name                                    Attribute Value</span>
<span class="go">    0                   X  [[-0.3378148180708981], [0.698908280342222], [...</span>
<span class="go">    1           all_lower                                               [-1]</span>
<span class="go">    2           all_upper                                                [1]</span>
<span class="go">    3        all_var_name                                               [x0]</span>
<span class="go">    4        all_var_type                                              [num]</span>
<span class="go">    5             counter                                                 10</span>
<span class="go">    6           de_bounds                                          [[-1, 1]]</span>
<span class="go">    7              design  &lt;spotpython.design.spacefilling.SpaceFilling o...</span>
<span class="go">    8      design_control                     {&#39;init_size&#39;: 7, &#39;repeats&#39;: 1}</span>
<span class="go">    9                 eps                                                0.0</span>
<span class="go">    10        fun_control                         {&#39;sigma&#39;: 0, &#39;seed&#39;: None}</span>
<span class="go">    11          fun_evals                                                 10</span>
<span class="go">    12        fun_repeats                                                  1</span>
<span class="go">    13              ident                                            [False]</span>
<span class="go">    14   infill_criterion                                                  y</span>
<span class="go">    15                  k                                                  1</span>
<span class="go">    16          log_level                                                 50</span>
<span class="go">    17              lower                                               [-1]</span>
<span class="go">    18           max_time                                                inf</span>
<span class="go">    19             mean_X                                               None</span>
<span class="go">    20             mean_y                                               None</span>
<span class="go">    21              min_X                           [1.5392206722432657e-05]</span>
<span class="go">    22         min_mean_X                                               None</span>
<span class="go">    23         min_mean_y                                               None</span>
<span class="go">    24              min_y                                                0.0</span>
<span class="go">    25           n_points                                                  1</span>
<span class="go">    26              noise                                               True</span>
<span class="go">    27         ocba_delta                                                  0</span>
<span class="go">    28  optimizer_control                    {&#39;max_iter&#39;: 1000, &#39;seed&#39;: 125}</span>
<span class="go">    29            red_dim                                              False</span>
<span class="go">    30                rng                                   Generator(PCG64)</span>
<span class="go">    31               seed                                                123</span>
<span class="go">    32        show_models                                              False</span>
<span class="go">    33      show_progress                                               True</span>
<span class="go">    34        spot_writer                                               None</span>
<span class="go">    35          surrogate  &lt;spotpython.surrogate.kriging.Kriging object at 0x...</span>
<span class="go">    36  surrogate_control  {&#39;method&#39;: &quot;regession&quot;, &#39;model_optimizer&#39;: &lt;function ...</span>
<span class="go">    37        tolerance_x                                                  0</span>
<span class="go">    38              upper                                                [1]</span>
<span class="go">    39           var_name                                               [x0]</span>
<span class="go">    40           var_type                                              [num]</span>
<span class="go">    41              var_y                                               None</span>
<span class="go">    42                  y  [0.11411885130827397, 0.48847278433092195, 0.0...</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_spot_attributes_as_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all attributes of the spot object as a pandas dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (pandas.DataFrame): dataframe with all attributes of the spot object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from math import inf</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 7</span>
<span class="sd">            # number of points</span>
<span class="sd">            n = 10</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1]),</span>
<span class="sd">                upper = np.array([1]),</span>
<span class="sd">                fun_evals=n)</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            spot_1 = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            spot_1.run()</span>
<span class="sd">            df = spot_1.get_spot_attributes_as_df()</span>
<span class="sd">        df</span>
<span class="sd">            df</span>
<span class="sd">                Attribute Name                                    Attribute Value</span>
<span class="sd">            0                   X  [[-0.3378148180708981], [0.698908280342222], [...</span>
<span class="sd">            1           all_lower                                               [-1]</span>
<span class="sd">            2           all_upper                                                [1]</span>
<span class="sd">            3        all_var_name                                               [x0]</span>
<span class="sd">            4        all_var_type                                              [num]</span>
<span class="sd">            5             counter                                                 10</span>
<span class="sd">            6           de_bounds                                          [[-1, 1]]</span>
<span class="sd">            7              design  &lt;spotpython.design.spacefilling.SpaceFilling o...</span>
<span class="sd">            8      design_control                     {&#39;init_size&#39;: 7, &#39;repeats&#39;: 1}</span>
<span class="sd">            9                 eps                                                0.0</span>
<span class="sd">            10        fun_control                         {&#39;sigma&#39;: 0, &#39;seed&#39;: None}</span>
<span class="sd">            11          fun_evals                                                 10</span>
<span class="sd">            12        fun_repeats                                                  1</span>
<span class="sd">            13              ident                                            [False]</span>
<span class="sd">            14   infill_criterion                                                  y</span>
<span class="sd">            15                  k                                                  1</span>
<span class="sd">            16          log_level                                                 50</span>
<span class="sd">            17              lower                                               [-1]</span>
<span class="sd">            18           max_time                                                inf</span>
<span class="sd">            19             mean_X                                               None</span>
<span class="sd">            20             mean_y                                               None</span>
<span class="sd">            21              min_X                           [1.5392206722432657e-05]</span>
<span class="sd">            22         min_mean_X                                               None</span>
<span class="sd">            23         min_mean_y                                               None</span>
<span class="sd">            24              min_y                                                0.0</span>
<span class="sd">            25           n_points                                                  1</span>
<span class="sd">            26              noise                                               True</span>
<span class="sd">            27         ocba_delta                                                  0</span>
<span class="sd">            28  optimizer_control                    {&#39;max_iter&#39;: 1000, &#39;seed&#39;: 125}</span>
<span class="sd">            29            red_dim                                              False</span>
<span class="sd">            30                rng                                   Generator(PCG64)</span>
<span class="sd">            31               seed                                                123</span>
<span class="sd">            32        show_models                                              False</span>
<span class="sd">            33      show_progress                                               True</span>
<span class="sd">            34        spot_writer                                               None</span>
<span class="sd">            35          surrogate  &lt;spotpython.surrogate.kriging.Kriging object at 0x...</span>
<span class="sd">            36  surrogate_control  {&#39;method&#39;: &quot;regession&quot;, &#39;model_optimizer&#39;: &lt;function ...</span>
<span class="sd">            37        tolerance_x                                                  0</span>
<span class="sd">            38              upper                                                [1]</span>
<span class="sd">            39           var_name                                               [x0]</span>
<span class="sd">            40           var_type                                              [num]</span>
<span class="sd">            41              var_y                                               None</span>
<span class="sd">            42                  y  [0.11411885130827397, 0.48847278433092195, 0.0...</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Attribute Name&quot;</span><span class="p">:</span> <span class="n">attributes</span><span class="p">,</span> <span class="s2">&quot;Attribute Value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.get_tuned_hyperparameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tuned_hyperparameters</span><span class="p">(</span><span class="n">fun_control</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.get_tuned_hyperparameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the tuned hyperparameter values from the run.
If <code>noise == True</code>, the mean values are returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun_control</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fun_control dictionary</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary of tuned hyperparameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.utils.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">getDevice</span>
<span class="go">    from math import inf</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    import numpy as np</span>
<span class="go">    from spotpython.hyperparameters.values import set_control_key_value</span>
<span class="go">    from spotpython.data.diabetes import Diabetes</span>
<span class="go">    MAX_TIME = 1</span>
<span class="go">    FUN_EVALS = 10</span>
<span class="go">    INIT_SIZE = 5</span>
<span class="go">    WORKERS = 0</span>
<span class="go">    PREFIX=&quot;037&quot;</span>
<span class="go">    DEVICE = getDevice()</span>
<span class="go">    DEVICES = 1</span>
<span class="go">    TEST_SIZE = 0.4</span>
<span class="go">    TORCH_METRIC = &quot;mean_squared_error&quot;</span>
<span class="go">    dataset = Diabetes()</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        _L_in=10,</span>
<span class="go">        _L_out=1,</span>
<span class="go">        _torchmetric=TORCH_METRIC,</span>
<span class="go">        PREFIX=PREFIX,</span>
<span class="go">        TENSORBOARD_CLEAN=True,</span>
<span class="go">        data_set=dataset,</span>
<span class="go">        device=DEVICE,</span>
<span class="go">        enable_progress_bar=False,</span>
<span class="go">        fun_evals=FUN_EVALS,</span>
<span class="go">        log_level=50,</span>
<span class="go">        max_time=MAX_TIME,</span>
<span class="go">        num_workers=WORKERS,</span>
<span class="go">        show_progress=True,</span>
<span class="go">        test_size=TEST_SIZE,</span>
<span class="go">        tolerance_x=np.sqrt(np.spacing(1)),</span>
<span class="go">        )</span>
<span class="go">    from spotpython.light.regression.netlightregression import NetLightRegression</span>
<span class="go">    from spotpython.hyperdict.light_hyper_dict import LightHyperDict</span>
<span class="go">    from spotpython.hyperparameters.values import add_core_model_to_fun_control</span>
<span class="go">    add_core_model_to_fun_control(fun_control=fun_control,</span>
<span class="go">                                core_model=NetLightRegression,</span>
<span class="go">                                hyper_dict=LightHyperDict)</span>
<span class="go">    from spotpython.hyperparameters.values import set_control_hyperparameter_value</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;l1&quot;, [7, 8])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;epochs&quot;, [3, 5])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;batch_size&quot;, [4, 5])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;optimizer&quot;, [</span>
<span class="go">                    &quot;Adam&quot;,</span>
<span class="go">                    &quot;RAdam&quot;,</span>
<span class="go">                ])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;dropout_prob&quot;, [0.01, 0.1])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;lr_mult&quot;, [0.5, 5.0])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;patience&quot;, [2, 3])</span>
<span class="go">    set_control_hyperparameter_value(fun_control, &quot;act_fn&quot;,[</span>
<span class="go">                    &quot;ReLU&quot;,</span>
<span class="go">                    &quot;LeakyReLU&quot;</span>
<span class="go">                ] )</span>
<span class="go">    from spotpython.utils.init import design_control_init, surrogate_control_init</span>
<span class="go">    design_control = design_control_init(init_size=INIT_SIZE)</span>
<span class="go">    surrogate_control = surrogate_control_init(method=&quot;regression&quot;)</span>
<span class="go">    from spotpython.fun.hyperlight import HyperLight</span>
<span class="go">    fun = HyperLight(log_level=50).fun</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    spot_tuner = spot.Spot(fun=fun,</span>
<span class="go">                        fun_control=fun_control,</span>
<span class="go">                        design_control=design_control,</span>
<span class="go">                        surrogate_control=surrogate_control)</span>
<span class="go">    spot_tuner.run()</span>
<span class="go">    spot_tuner.get_tuned_hyperparameters()</span>
<span class="go">        {&#39;l1&#39;: 7.0,</span>
<span class="go">        &#39;epochs&#39;: 5.0,</span>
<span class="go">        &#39;batch_size&#39;: 4.0,</span>
<span class="go">        &#39;act_fn&#39;: 0.0,</span>
<span class="go">        &#39;optimizer&#39;: 0.0,</span>
<span class="go">        &#39;dropout_prob&#39;: 0.01,</span>
<span class="go">        &#39;lr_mult&#39;: 5.0,</span>
<span class="go">        &#39;patience&#39;: 3.0,</span>
<span class="go">        &#39;initialization&#39;: 1.0}</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_tuned_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the tuned hyperparameter values from the run.</span>
<span class="sd">    If `noise == True`, the mean values are returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun_control (dict, optional):</span>
<span class="sd">            fun_control dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): dictionary of tuned hyperparameters.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.utils.device import getDevice</span>
<span class="sd">            from math import inf</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            from spotpython.hyperparameters.values import set_control_key_value</span>
<span class="sd">            from spotpython.data.diabetes import Diabetes</span>
<span class="sd">            MAX_TIME = 1</span>
<span class="sd">            FUN_EVALS = 10</span>
<span class="sd">            INIT_SIZE = 5</span>
<span class="sd">            WORKERS = 0</span>
<span class="sd">            PREFIX=&quot;037&quot;</span>
<span class="sd">            DEVICE = getDevice()</span>
<span class="sd">            DEVICES = 1</span>
<span class="sd">            TEST_SIZE = 0.4</span>
<span class="sd">            TORCH_METRIC = &quot;mean_squared_error&quot;</span>
<span class="sd">            dataset = Diabetes()</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                _L_in=10,</span>
<span class="sd">                _L_out=1,</span>
<span class="sd">                _torchmetric=TORCH_METRIC,</span>
<span class="sd">                PREFIX=PREFIX,</span>
<span class="sd">                TENSORBOARD_CLEAN=True,</span>
<span class="sd">                data_set=dataset,</span>
<span class="sd">                device=DEVICE,</span>
<span class="sd">                enable_progress_bar=False,</span>
<span class="sd">                fun_evals=FUN_EVALS,</span>
<span class="sd">                log_level=50,</span>
<span class="sd">                max_time=MAX_TIME,</span>
<span class="sd">                num_workers=WORKERS,</span>
<span class="sd">                show_progress=True,</span>
<span class="sd">                test_size=TEST_SIZE,</span>
<span class="sd">                tolerance_x=np.sqrt(np.spacing(1)),</span>
<span class="sd">                )</span>
<span class="sd">            from spotpython.light.regression.netlightregression import NetLightRegression</span>
<span class="sd">            from spotpython.hyperdict.light_hyper_dict import LightHyperDict</span>
<span class="sd">            from spotpython.hyperparameters.values import add_core_model_to_fun_control</span>
<span class="sd">            add_core_model_to_fun_control(fun_control=fun_control,</span>
<span class="sd">                                        core_model=NetLightRegression,</span>
<span class="sd">                                        hyper_dict=LightHyperDict)</span>
<span class="sd">            from spotpython.hyperparameters.values import set_control_hyperparameter_value</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;l1&quot;, [7, 8])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;epochs&quot;, [3, 5])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;batch_size&quot;, [4, 5])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;optimizer&quot;, [</span>
<span class="sd">                            &quot;Adam&quot;,</span>
<span class="sd">                            &quot;RAdam&quot;,</span>
<span class="sd">                        ])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;dropout_prob&quot;, [0.01, 0.1])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;lr_mult&quot;, [0.5, 5.0])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;patience&quot;, [2, 3])</span>
<span class="sd">            set_control_hyperparameter_value(fun_control, &quot;act_fn&quot;,[</span>
<span class="sd">                            &quot;ReLU&quot;,</span>
<span class="sd">                            &quot;LeakyReLU&quot;</span>
<span class="sd">                        ] )</span>
<span class="sd">            from spotpython.utils.init import design_control_init, surrogate_control_init</span>
<span class="sd">            design_control = design_control_init(init_size=INIT_SIZE)</span>
<span class="sd">            surrogate_control = surrogate_control_init(method=&quot;regression&quot;)</span>
<span class="sd">            from spotpython.fun.hyperlight import HyperLight</span>
<span class="sd">            fun = HyperLight(log_level=50).fun</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            spot_tuner = spot.Spot(fun=fun,</span>
<span class="sd">                                fun_control=fun_control,</span>
<span class="sd">                                design_control=design_control,</span>
<span class="sd">                                surrogate_control=surrogate_control)</span>
<span class="sd">            spot_tuner.run()</span>
<span class="sd">            spot_tuner.get_tuned_hyperparameters()</span>
<span class="sd">                {&#39;l1&#39;: 7.0,</span>
<span class="sd">                &#39;epochs&#39;: 5.0,</span>
<span class="sd">                &#39;batch_size&#39;: 4.0,</span>
<span class="sd">                &#39;act_fn&#39;: 0.0,</span>
<span class="sd">                &#39;optimizer&#39;: 0.0,</span>
<span class="sd">                &#39;dropout_prob&#39;: 0.01,</span>
<span class="sd">                &#39;lr_mult&#39;: 5.0,</span>
<span class="sd">                &#39;patience&#39;: 3.0,</span>
<span class="sd">                &#39;initialization&#39;: 1.0}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">var_type</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span> <span class="ow">and</span> <span class="n">fun_control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">get_ith_hyperparameter_name_from_fun_control</span><span class="p">(</span><span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">var_name</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
    <span class="c1"># convert list to a dictionary</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.infill" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">infill</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.infill" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Infill (acquisition) function. Evaluates one point on the surrogate via <code>surrogate.predict(x.reshape(1,-1))</code>,
if <code>sklearn</code> surrogates are used or <code>surrogate.predict(x.reshape(1,-1), return_val=self.infill_criterion)</code>
if the internal surrogate <code>Kriging</code> is selected.
This method is passed to the optimizer in <code>suggest_new_X</code>, i.e., the optimizer is called via
<code>self.optimizer(func=self.infill)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>point in natural units with shape <code>(1, dim)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>value based on infill criterion, e.g., <code>"ei"</code>. Shape <code>(1,)</code>.
The objective function value <code>y</code> that is used as a base value for the
infill criterion is calculated in natural units.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This is step (S-12) in [bart21i].</p>
</details>

            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">infill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Infill (acquisition) function. Evaluates one point on the surrogate via `surrogate.predict(x.reshape(1,-1))`,</span>
<span class="sd">    if `sklearn` surrogates are used or `surrogate.predict(x.reshape(1,-1), return_val=self.infill_criterion)`</span>
<span class="sd">    if the internal surrogate `Kriging` is selected.</span>
<span class="sd">    This method is passed to the optimizer in `suggest_new_X`, i.e., the optimizer is called via</span>
<span class="sd">    `self.optimizer(func=self.infill)`.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array): point in natural units with shape `(1, dim)`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): value based on infill criterion, e.g., `&quot;ei&quot;`. Shape `(1,)`.</span>
<span class="sd">            The objective function value `y` that is used as a base value for the</span>
<span class="sd">            infill criterion is calculated in natural units.</span>

<span class="sd">    Note:</span>
<span class="sd">        This is step (S-12) in [bart21i].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reshape x to have shape (1, -1) because the predict method expects a 2D array</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Kriging&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill_criterion</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.initialize_design" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_design</span><span class="p">(</span><span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.initialize_design" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize design. Generate and evaluate initial design.
If <code>X_start</code> is not <code>None</code>, append it to the initial design.
Therefore, the design size is <code>init_size</code> + <code>X_start.shape[0]</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_start</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial design. Must be of shape (n, k), where n is the number
of points and k is the number of dimensions. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.initialize_design.self.X">self.X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial design</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.initialize_design.self.y">self.y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial design values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>If <code>X_start</code> is has the wrong shape, it is ignored.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init,  design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 7</span>
<span class="go">    # start point X_0</span>
<span class="go">    X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1]))</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.initialize_design(X_start=X_start)</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">        S.X: [[ 0.          0.        ]</span>
<span class="go">            [ 0.          1.        ]</span>
<span class="go">            [ 1.          0.        ]</span>
<span class="go">            [ 1.          1.        ]</span>
<span class="go">            [-0.90924339 -0.15823458]</span>
<span class="go">            [-0.20581711 -0.48124909]</span>
<span class="go">            [ 0.94974117 -0.94631272]</span>
<span class="go">            [-0.12095571  0.06383589]</span>
<span class="go">            [-0.66278702  0.17431637]</span>
<span class="go">            [ 0.28200844  0.93001011]</span>
<span class="go">            [ 0.47878812  0.65321058]]</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">            S.y: [0.         1.         1.         2.         0.85176172 0.27396137</span>
<span class="go">                1.79751605 0.01870531 0.46967283 0.94444757 0.65592212]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize design. Generate and evaluate initial design.</span>
<span class="sd">    If `X_start` is not `None`, append it to the initial design.</span>
<span class="sd">    Therefore, the design size is `init_size` + `X_start.shape[0]`.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_start (numpy.ndarray, optional):</span>
<span class="sd">            initial design. Must be of shape (n, k), where n is the number</span>
<span class="sd">            of points and k is the number of dimensions. Defaults to None.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.X (numpy.ndarray): initial design</span>
<span class="sd">        self.y (numpy.ndarray): initial design values</span>

<span class="sd">    Note:</span>
<span class="sd">        * If `X_start` is has the wrong shape, it is ignored.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init,  design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 7</span>
<span class="sd">            # start point X_0</span>
<span class="sd">            X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1]))</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.initialize_design(X_start=X_start)</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">                S.X: [[ 0.          0.        ]</span>
<span class="sd">                    [ 0.          1.        ]</span>
<span class="sd">                    [ 1.          0.        ]</span>
<span class="sd">                    [ 1.          1.        ]</span>
<span class="sd">                    [-0.90924339 -0.15823458]</span>
<span class="sd">                    [-0.20581711 -0.48124909]</span>
<span class="sd">                    [ 0.94974117 -0.94631272]</span>
<span class="sd">                    [-0.12095571  0.06383589]</span>
<span class="sd">                    [-0.66278702  0.17431637]</span>
<span class="sd">                    [ 0.28200844  0.93001011]</span>
<span class="sd">                    [ 0.47878812  0.65321058]]</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">                    S.y: [0.         1.         1.         2.         0.85176172 0.27396137</span>
<span class="sd">                        1.79751605 0.01870531 0.46967283 0.94444757 0.65592212]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialize_design_matrix</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_initial_design</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">write_initial_tensorboard_log</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.initialize_design_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_design_matrix</span><span class="p">(</span><span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.initialize_design_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the design matrix for the optimization process.
This method generates an initial design matrix, optionally
appending any provided starting points (<code>X_start</code>). The resulting
design matrix is sanitized for non-numeric values and stored in <code>self.X</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_start</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>User-provided starting points
for the design. Shape should be (n=n_samples, k=n_features).
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy.ndarray: The design matrix that combines the generated design
        with the provided starting points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the resulting design matrix has zero rows.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>X_start</code> is not in the expected shape, it is ignored.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun import Analytical</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        tensorboard_log=True,</span>
<span class="go">        TENSORBOARD_CLEAN=True,</span>
<span class="go">        lower = np.array([-1]),</span>
<span class="go">        upper = np.array([1])</span>
<span class="go">        )</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    S = Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                )</span>
<span class="go">    X_start = np.array([[0.5, 0.5], [0.4, 0.4]])</span>
<span class="go">    design_matrix = S.initialize_design_matrix(X_start)</span>
<span class="go">    print(f&quot;Design matrix: {design_matrix}&quot;)</span>
<span class="go">        Design matrix: [[ 0.1         0.2       ]</span>
<span class="go">        [ 0.3         0.4       ]</span>
<span class="go">        [ 0.86352963  0.7892358 ]</span>
<span class="go">        [-0.24407197 -0.83687436]</span>
<span class="go">        [ 0.36481882  0.8375811 ]</span>
<span class="go">        [ 0.415331    0.54468512]</span>
<span class="go">        [-0.56395091 -0.77797854]</span>
<span class="go">        [-0.90259409 -0.04899292]</span>
<span class="go">        [-0.16484832  0.35724741]</span>
<span class="go">        [ 0.05170659  0.07401196]</span>
<span class="go">        [-0.78548145 -0.44638164]</span>
<span class="go">        [ 0.64017497 -0.30363301]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_design_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the design matrix for the optimization process.</span>
<span class="sd">    This method generates an initial design matrix, optionally</span>
<span class="sd">    appending any provided starting points (`X_start`). The resulting</span>
<span class="sd">    design matrix is sanitized for non-numeric values and stored in `self.X`.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_start (numpy.ndarray, optional): User-provided starting points</span>
<span class="sd">            for the design. Shape should be (n=n_samples, k=n_features).</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: The design matrix that combines the generated design</span>
<span class="sd">                    with the provided starting points.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the resulting design matrix has zero rows.</span>

<span class="sd">    Notes:</span>
<span class="sd">        * If `X_start` is not in the expected shape, it is ignored.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun import Analytical</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                tensorboard_log=True,</span>
<span class="sd">                TENSORBOARD_CLEAN=True,</span>
<span class="sd">                lower = np.array([-1]),</span>
<span class="sd">                upper = np.array([1])</span>
<span class="sd">                )</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            S = Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        )</span>
<span class="sd">            X_start = np.array([[0.5, 0.5], [0.4, 0.4]])</span>
<span class="sd">            design_matrix = S.initialize_design_matrix(X_start)</span>
<span class="sd">            print(f&quot;Design matrix: {design_matrix}&quot;)</span>
<span class="sd">                Design matrix: [[ 0.1         0.2       ]</span>
<span class="sd">                [ 0.3         0.4       ]</span>
<span class="sd">                [ 0.86352963  0.7892358 ]</span>
<span class="sd">                [-0.24407197 -0.83687436]</span>
<span class="sd">                [ 0.36481882  0.8375811 ]</span>
<span class="sd">                [ 0.415331    0.54468512]</span>
<span class="sd">                [-0.56395091 -0.77797854]</span>
<span class="sd">                [-0.90259409 -0.04899292]</span>
<span class="sd">                [-0.16484832  0.35724741]</span>
<span class="sd">                [ 0.05170659  0.07401196]</span>
<span class="sd">                [-0.78548145 -0.44638164]</span>
<span class="sd">                [ 0.64017497 -0.30363301]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_design</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">],</span>
            <span class="n">repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">],</span>
            <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
            <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">X_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">X_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
        <span class="n">X_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">X0</span> <span class="o">=</span> <span class="n">X_start</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;X_start has wrong shape. Ignoring it.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;X0 has zero rows. Check design_control[&#39;init_size&#39;] or X_start.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">repair_non_numeric</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.parallel_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parallel_plot</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.parallel_plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Parallel plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>show the plot. Default is <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fig</code></td>            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 5</span>
<span class="go">    # number of points</span>
<span class="go">    fun_evals = 10</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1, -1]),</span>
<span class="go">        upper = np.array([1, 1, 1]),</span>
<span class="go">        fun_evals=fun_evals,</span>
<span class="go">        tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    surrogate_control=surrogate_control_init()</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,</span>
<span class="go">                surrogate_control=surrogate_control,)</span>
<span class="go">    S.run()</span>
<span class="go">    S.parallel_plot()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parallel_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parallel plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            Spot object</span>
<span class="sd">        show (bool):</span>
<span class="sd">            show the plot. Default is `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">            fig (plotly.graph_objects.Figure): figure object</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 5</span>
<span class="sd">            # number of points</span>
<span class="sd">            fun_evals = 10</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1, -1]),</span>
<span class="sd">                upper = np.array([1, 1, 1]),</span>
<span class="sd">                fun_evals=fun_evals,</span>
<span class="sd">                tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            surrogate_control=surrogate_control_init()</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">                        surrogate_control=surrogate_control,)</span>
<span class="sd">            S.run()</span>
<span class="sd">            S.parallel_plot()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">colorscale</span><span class="o">=</span><span class="s2">&quot;Jet&quot;</span><span class="p">,</span> <span class="n">showscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]),</span> <span class="n">cmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])),</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="nb">list</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])],</span> <span class="n">label</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]),</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.plot_contour" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_contour</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">use_floor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">grid_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">add_points</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.plot_contour" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot a contour plot of the surrogate model for two hyperparameters.
Args:
    i (int):
        index of the first hyperparameter to plot.
    j (int):
        index of the second hyperparameter to plot.
    min_z (float, optional):
        minimum value for the z-axis. If <code>None</code>, the minimum value is calculated from the surrogate predictions.
    max_z (float, optional):
        maximum value for the z-axis. If <code>None</code>, the maximum value is calculated from the surrogate predictions.
    show (bool):
        whether to show the plot. Default is <code>True</code>.
    title (str, optional):
        title of the plot. If <code>None</code>, a default title is used.
    filename (str, optional):
        filename to save the plot. If <code>None</code>, the plot is not saved.
    n_grid (int):
        number of grid points for the contour plot. Default is 100.
    contour_levels (int):
        number of contour levels. Default is 25.
    dpi (int):
        dots per inch for the saved plot. Default is 200.
    figsize (tuple):
        size of the figure for the plot. Default is (12, 5).
    use_floor (bool):
        If <code>True</code>, the floor values of the other hyperparameters are used for plotting. If <code>False</code>, the ceiling values are used. Default is <code>True</code>.
    tkagg (bool):
        If <code>True</code>, use the TkAgg backend for matplotlib. Default is <code>False</code>.
    cmap (str):
        Colormap to use for the contour plot. Default is &ldquo;jet&rdquo;.
    grid_visible (bool):
        If <code>True</code>, show the grid in the contour plot. Default is <code>True</code>.
    alpha (float):
        Transparency level for the contour lines. Default is 0.8.
    eps (float):
        Small value to avoid division by zero in the surrogate predictions. Default is 1e-4.
    max_error (float):
        Maximum error allowed in the surrogate predictions. Default is 1e-3.
    use_floor (bool):
        If <code>True</code>, use the minimum values of the other hyperparameters for plotting. If <code>False</code>, use the maximum values. Default is <code>True</code>.
    add_points (bool):
        If <code>True</code>, add the points from the surrogate model to the contour plot. Default is <code>True</code>.</p>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_contour</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">min_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">use_floor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
    <span class="n">grid_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
    <span class="n">max_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">add_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a contour plot of the surrogate model for two hyperparameters.</span>
<span class="sd">    Args:</span>
<span class="sd">        i (int):</span>
<span class="sd">            index of the first hyperparameter to plot.</span>
<span class="sd">        j (int):</span>
<span class="sd">            index of the second hyperparameter to plot.</span>
<span class="sd">        min_z (float, optional):</span>
<span class="sd">            minimum value for the z-axis. If `None`, the minimum value is calculated from the surrogate predictions.</span>
<span class="sd">        max_z (float, optional):</span>
<span class="sd">            maximum value for the z-axis. If `None`, the maximum value is calculated from the surrogate predictions.</span>
<span class="sd">        show (bool):</span>
<span class="sd">            whether to show the plot. Default is `True`.</span>
<span class="sd">        title (str, optional):</span>
<span class="sd">            title of the plot. If `None`, a default title is used.</span>
<span class="sd">        filename (str, optional):</span>
<span class="sd">            filename to save the plot. If `None`, the plot is not saved.</span>
<span class="sd">        n_grid (int):</span>
<span class="sd">            number of grid points for the contour plot. Default is 100.</span>
<span class="sd">        contour_levels (int):</span>
<span class="sd">            number of contour levels. Default is 25.</span>
<span class="sd">        dpi (int):</span>
<span class="sd">            dots per inch for the saved plot. Default is 200.</span>
<span class="sd">        figsize (tuple):</span>
<span class="sd">            size of the figure for the plot. Default is (12, 5).</span>
<span class="sd">        use_floor (bool):</span>
<span class="sd">            If `True`, the floor values of the other hyperparameters are used for plotting. If `False`, the ceiling values are used. Default is `True`.</span>
<span class="sd">        tkagg (bool):</span>
<span class="sd">            If `True`, use the TkAgg backend for matplotlib. Default is `False`.</span>
<span class="sd">        cmap (str):</span>
<span class="sd">            Colormap to use for the contour plot. Default is &quot;jet&quot;.</span>
<span class="sd">        grid_visible (bool):</span>
<span class="sd">            If `True`, show the grid in the contour plot. Default is `True`.</span>
<span class="sd">        alpha (float):</span>
<span class="sd">            Transparency level for the contour lines. Default is 0.8.</span>
<span class="sd">        eps (float):</span>
<span class="sd">            Small value to avoid division by zero in the surrogate predictions. Default is 1e-4.</span>
<span class="sd">        max_error (float):</span>
<span class="sd">            Maximum error allowed in the surrogate predictions. Default is 1e-3.</span>
<span class="sd">        use_floor (bool):</span>
<span class="sd">            If `True`, use the minimum values of the other hyperparameters for plotting. If `False`, use the maximum values. Default is `True`.</span>
<span class="sd">        add_points (bool):</span>
<span class="sd">            If `True`, add the points from the surrogate model to the contour plot. Default is `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plotkd</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
        <span class="n">num</span><span class="o">=</span><span class="n">n_grid</span><span class="p">,</span>
        <span class="n">var_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">,</span>
        <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span>
        <span class="n">grid_visible</span><span class="o">=</span><span class="n">grid_visible</span><span class="p">,</span>
        <span class="n">contour_levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span>
        <span class="n">max_error</span><span class="o">=</span><span class="n">max_error</span><span class="p">,</span>
        <span class="n">use_floor</span><span class="o">=</span><span class="n">use_floor</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">min_z</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">max_z</span><span class="p">,</span>
        <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
        <span class="n">add_points</span><span class="o">=</span><span class="n">add_points</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.plot_importance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_importance</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></code>

<a href="#spotpython.spot.spot.Spot.plot_importance" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the importance of each variable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold of the importance.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the plot.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dpi</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dpi of the plot.</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show the plot. Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tkagg</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use TkAgg backend. Default is <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figsize</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size (width, height) in inches. Default is (9, 6).</p>
              </div>
            </td>
            <td>
                  <code>(9, 6)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the importance of each variable.</span>

<span class="sd">    Args:</span>
<span class="sd">        threshold (float):</span>
<span class="sd">            The threshold of the importance.</span>
<span class="sd">        filename (str):</span>
<span class="sd">            The filename of the plot.</span>
<span class="sd">        dpi (int):</span>
<span class="sd">            The dpi of the plot.</span>
<span class="sd">        show (bool):</span>
<span class="sd">            Show the plot. Default is `True`.</span>
<span class="sd">        tkagg (bool):</span>
<span class="sd">            Use TkAgg backend. Default is `False`.</span>
<span class="sd">        figsize (tuple):</span>
<span class="sd">            Figure size (width, height) in inches. Default is (9, 6).</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tkagg</span><span class="p">:</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>

        <span class="c1"># Create figure with specified size</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">imp</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">idx</span><span class="p">])),</span> <span class="n">var_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.plot_important_hyperparameter_contour" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_important_hyperparameter_contour</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_imp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">scale_global</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.plot_important_hyperparameter_contour" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the contour of important hyperparameters.
Calls <code>plot_contour</code> for each pair of important hyperparameters.
Importance can be specified by the threshold.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>threshold for the importance. Not used any more in spotpython &gt;= 0.13.2.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename of the plot</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>show the plot. Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_imp</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum number of important hyperparameters. If there are more important hyperparameters
than <code>max_imp</code>, only the max_imp important ones are selected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>title of the plots</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scale_global</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale the z-axis globally. Default is <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_grid</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of grid points. Default is 50.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour_levels</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of contour levels. Default is 10.</p>
              </div>
            </td>
            <td>
                  <code>25</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dpi</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dpi of the plot. Default is 200.</p>
              </div>
            </td>
            <td>
                  <code>200</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_min</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deprecated in 0.31.12.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_max</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deprecated in 0.31.12.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 5</span>
<span class="go">    # number of points</span>
<span class="go">    fun_evals = 10</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1, -1]),</span>
<span class="go">        upper = np.array([1, 1, 1]),</span>
<span class="go">        fun_evals=fun_evals,</span>
<span class="go">        tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    surrogate_control=surrogate_control_init)</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,</span>
<span class="go">                surrogate_control=surrogate_control,)</span>
<span class="go">    S.run()</span>
<span class="go">    S.plot_important_hyperparameter_contour()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_important_hyperparameter_contour</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">max_imp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">scale_global</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_grid</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">contour_levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the contour of important hyperparameters.</span>
<span class="sd">    Calls `plot_contour` for each pair of important hyperparameters.</span>
<span class="sd">    Importance can be specified by the threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        threshold (float):</span>
<span class="sd">            threshold for the importance. Not used any more in spotpython &gt;= 0.13.2.</span>
<span class="sd">        filename (str):</span>
<span class="sd">            filename of the plot</span>
<span class="sd">        show (bool):</span>
<span class="sd">            show the plot. Default is `True`.</span>
<span class="sd">        max_imp (int):</span>
<span class="sd">            maximum number of important hyperparameters. If there are more important hyperparameters</span>
<span class="sd">            than `max_imp`, only the max_imp important ones are selected.</span>
<span class="sd">        title (str):</span>
<span class="sd">            title of the plots</span>
<span class="sd">        scale_global (bool):</span>
<span class="sd">            scale the z-axis globally. Default is `False`.</span>
<span class="sd">        n_grid (int):</span>
<span class="sd">            number of grid points. Default is 50.</span>
<span class="sd">        contour_levels (int):</span>
<span class="sd">            number of contour levels. Default is 10.</span>
<span class="sd">        dpi (int):</span>
<span class="sd">            dpi of the plot. Default is 200.</span>
<span class="sd">        use_min (bool): Deprecated in 0.31.12.</span>
<span class="sd">        use_max (bool): Deprecated in 0.31.12.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 5</span>
<span class="sd">            # number of points</span>
<span class="sd">            fun_evals = 10</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1, -1]),</span>
<span class="sd">                upper = np.array([1, 1, 1]),</span>
<span class="sd">                fun_evals=fun_evals,</span>
<span class="sd">                tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            surrogate_control=surrogate_control_init)</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">                        surrogate_control=surrogate_control,)</span>
<span class="sd">            S.run()</span>
<span class="sd">            S.plot_important_hyperparameter_contour()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">impo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_importance</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">sort_by_kth_and_return_indices</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">impo</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># take the first max_imp values from the indices array</span>
    <span class="k">if</span> <span class="n">max_imp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:</span><span class="n">max_imp</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">scale_global</span><span class="p">:</span>
        <span class="n">min_z</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">max_z</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">max_z</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">filename_full</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_contour_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filename_full</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span>
                    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                    <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
                    <span class="n">min_z</span><span class="o">=</span><span class="n">min_z</span><span class="p">,</span>
                    <span class="n">max_z</span><span class="o">=</span><span class="n">max_z</span><span class="p">,</span>
                    <span class="n">filename</span><span class="o">=</span><span class="n">filename_full</span><span class="p">,</span>
                    <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">n_grid</span><span class="o">=</span><span class="n">n_grid</span><span class="p">,</span>
                    <span class="n">contour_levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span>
                    <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
                    <span class="n">tkagg</span><span class="o">=</span><span class="n">tkagg</span><span class="p">,</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.plot_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_model</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.plot_model" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the model fit for 1-dim objective functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y range, lower bound.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y range, upper bound.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 3</span>
<span class="go">    # number of points</span>
<span class="go">    fun_evals = 7</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1]),</span>
<span class="go">        upper = np.array([1]),</span>
<span class="go">        fun_evals=fun_evals,</span>
<span class="go">        tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
</code></pre></div>
    <pre><code>S = spot.Spot(fun=fun,
            fun_control=fun_control,
            design_control=design_control
S.run()
S.plot_model()
</code></pre>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the model fit for 1-dim objective functions.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object):</span>
<span class="sd">            spot object</span>
<span class="sd">        y_min (float, optional):</span>
<span class="sd">            y range, lower bound.</span>
<span class="sd">        y_max (float, optional):</span>
<span class="sd">            y range, upper bound.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 3</span>
<span class="sd">            # number of points</span>
<span class="sd">            fun_evals = 7</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1]),</span>
<span class="sd">                upper = np.array([1]),</span>
<span class="sd">                fun_evals=fun_evals,</span>
<span class="sd">                tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>

<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control</span>
<span class="sd">            S.run()</span>
<span class="sd">            S.plot_model()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
        <span class="c1"># convert multi-objective values to single-objective values</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
        <span class="c1"># Apply penalty for NA values works only on so values:</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">Kriging</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;kriging&quot;</span><span class="p">:</span>
            <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">return_val</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True function&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Samples&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Last Sample&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Best Sample (mean)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Best Sample&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">y_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">y_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
        <span class="c1"># plt.title(self.surrogate.__class__.__name__ + &quot;. &quot; + str(self.counter) + &quot;: &quot; + str(self.min_y))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fun_evals: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. min_y (noise): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; min_mean_y: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fun_evals: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. min_y: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.plot_progress" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_progress</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;plot.png&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Objective function value over iterations&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.plot_progress" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the progress of the hyperparameter tuning (optimization).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show the plot.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_x</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use logarithmic scale for x-axis.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_y</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use logarithmic scale for y-axis.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename to save the plot.</p>
              </div>
            </td>
            <td>
                  <code>&#39;plot.png&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>style</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Style of the plot. Default: [&lsquo;k&rsquo;, &lsquo;ro-&lsquo;], i.e., the initial points are plotted as a black line
and the subsequent points as red dots connected by a line.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;ko&#39;, &#39;k&#39;, &#39;ro-&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot. Default: &ldquo;Objective function value over iterations&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Objective function value over iterations&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis. Default: &ldquo;y&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 7</span>
<span class="go">    # number of points</span>
<span class="go">    fun_evals = 10</span>
<span class="go">    fun = analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1])</span>
<span class="go">        fun_evals=fun_evals,</span>
<span class="go">        tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    surrogate_control=surrogate_control_init()</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control</span>
<span class="go">                design_control=design_control,</span>
<span class="go">                surrogate_control=surrogate_control,)</span>
<span class="go">    S.run()</span>
<span class="go">    S.plot_progress(log_y=True)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_progress</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;plot.png&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;ro-&quot;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tkagg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Objective function value over iterations&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the progress of the hyperparameter tuning (optimization).</span>

<span class="sd">    Args:</span>
<span class="sd">        show (bool):</span>
<span class="sd">            Show the plot.</span>
<span class="sd">        log_x (bool):</span>
<span class="sd">            Use logarithmic scale for x-axis.</span>
<span class="sd">        log_y (bool):</span>
<span class="sd">            Use logarithmic scale for y-axis.</span>
<span class="sd">        filename (str):</span>
<span class="sd">            Filename to save the plot.</span>
<span class="sd">        style (list):</span>
<span class="sd">            Style of the plot. Default: [&#39;k&#39;, &#39;ro-&#39;], i.e., the initial points are plotted as a black line</span>
<span class="sd">            and the subsequent points as red dots connected by a line.</span>
<span class="sd">        title (str):</span>
<span class="sd">            Title of the plot. Default: &quot;Objective function value over iterations&quot;.</span>
<span class="sd">        y_label (str):</span>
<span class="sd">            Label for the y-axis. Default: &quot;y&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 7</span>
<span class="sd">            # number of points</span>
<span class="sd">            fun_evals = 10</span>
<span class="sd">            fun = analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1])</span>
<span class="sd">                fun_evals=fun_evals,</span>
<span class="sd">                tolerance_x = np.sqrt(np.spacing(1))</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            surrogate_control=surrogate_control_init()</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">                        surrogate_control=surrogate_control,)</span>
<span class="sd">            S.run()</span>
<span class="sd">            S.plot_progress(log_y=True)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tkagg</span><span class="p">:</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">s_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">s_c</span> <span class="o">=</span> <span class="n">s_y</span><span class="o">.</span><span class="n">cummin</span><span class="p">()</span>
    <span class="n">n_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">]</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_init</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_y</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">s_y</span><span class="p">[:</span><span class="n">n_init</span><span class="p">],</span>
            <span class="n">style</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">[</span><span class="n">s_c</span><span class="p">[:</span><span class="n">n_init</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">style</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="nb">range</span><span class="p">(</span><span class="n">n_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">s_c</span><span class="p">[</span><span class="n">n_init</span><span class="p">:],</span>
            <span class="n">style</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># plot only s_y values:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_y</span><span class="p">,</span> <span class="n">style</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Less evaluations ({len(s_y)}) than initial design points (</span><span class="si">{n_init}</span><span class="s2">).&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="c1"># add a grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.prepare_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_plot</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_grid</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.prepare_plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Prepare mesh grid and surrogate predictions for contour and 3D surface plotting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the first dimension to plot. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the second dimension to plot. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_grid</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of grid points per dimension. Default is 50.</p>
              </div>
            </td>
            <td>
                  <code>50</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_min</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, fix hidden dimensions to their minimum values. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_max</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, fix hidden dimensions to their maximum values. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- X (numpy.ndarray): Mesh grid for the first dimension.
- Y (numpy.ndarray): Mesh grid for the second dimension.
- Z (numpy.ndarray): Surrogate predictions over the grid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">prepare_plot</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">n_grid</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">use_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare mesh grid and surrogate predictions for contour and 3D surface plotting.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (int, optional): Index of the first dimension to plot. Default is 0.</span>
<span class="sd">        j (int, optional): Index of the second dimension to plot. Default is 1.</span>
<span class="sd">        n_grid (int, optional): Number of grid points per dimension. Default is 50.</span>
<span class="sd">        use_min (bool, optional): If True, fix hidden dimensions to their minimum values. Default is False.</span>
<span class="sd">        use_max (bool, optional): If True, fix hidden dimensions to their maximum values. Default is True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): A tuple containing:</span>
<span class="sd">            - X (numpy.ndarray): Mesh grid for the first dimension.</span>
<span class="sd">            - Y (numpy.ndarray): Mesh grid for the second dimension.</span>
<span class="sd">            - Z (numpy.ndarray): Surrogate predictions over the grid.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; plot_data = S.prepare_plot(i=0, j=1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh_grid</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">grid_points</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">grid_points</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">grid_points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_types</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dimensions of var_type, lower, and upper must be the same.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0</span><span class="p">):</span>
        <span class="n">grid_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y</span><span class="p">)]</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">grid_points</span><span class="p">:</span>
            <span class="n">adjusted_z0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z0</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">adjusted_z0</span><span class="p">]))</span>
            <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Z</span>

    <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">generate_mesh_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">n_grid</span><span class="p">)</span>
    <span class="n">validate_types</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>

    <span class="n">z00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">])</span>
    <span class="n">Z_list</span><span class="p">,</span> <span class="n">X_list</span><span class="p">,</span> <span class="n">Y_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">use_min</span><span class="p">:</span>
        <span class="n">z0_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_z00</span><span class="p">(</span><span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Z_min</span> <span class="o">=</span> <span class="n">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0_min</span><span class="p">)</span>
        <span class="n">Z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z_min</span><span class="p">)</span>
        <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">Y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_max</span><span class="p">:</span>
        <span class="n">z0_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_z00</span><span class="p">(</span><span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Z_max</span> <span class="o">=</span> <span class="n">predict_contour_values</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z0_max</span><span class="p">)</span>
        <span class="n">Z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z_max</span><span class="p">)</span>
        <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">Y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Z_list</span><span class="p">:</span>
        <span class="n">Z_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">Z_list</span><span class="p">)</span>
        <span class="n">X_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">X_list</span><span class="p">)</span>
        <span class="n">Y_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">Y_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data to plot.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_combined</span><span class="p">,</span> <span class="n">Y_combined</span><span class="p">,</span> <span class="n">Z_combined</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.print_importance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_importance</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.print_importance" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print importance of each variable and return the results as a list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>threshold for printing</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_screen</code>
            </td>
            <td>
                  <code><span title="boolean">boolean</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>True</code>, values are also printed on the screen. Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>output</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print importance of each variable and return the results as a list.</span>

<span class="sd">    Args:</span>
<span class="sd">        threshold (float):</span>
<span class="sd">            threshold for printing</span>
<span class="sd">        print_screen (boolean):</span>
<span class="sd">            if `True`, values are also printed on the screen. Default is `True`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        output (list):</span>
<span class="sd">            list of results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">n_theta</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="c1"># imp = imp[imp &gt;= threshold]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">))]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imp</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Importance requires more than one theta value (n_theta&gt;1).&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.print_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_results</span><span class="p">(</span><span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.print_results" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



<details class="print-results-from-the-run" open>
  <summary>Print results from the run</summary>
  <ol>
<li>min y</li>
<li>min X
If <code>noise == True</code>, additionally the following values are printed:</li>
<li>min mean y</li>
<li>min mean X</li>
</ol>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_screen</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print results to screen</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>output</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print results from the run:</span>
<span class="sd">        1. min y</span>
<span class="sd">        2. min X</span>
<span class="sd">        If `noise == True`, additionally the following values are printed:</span>
<span class="sd">        3. min mean y</span>
<span class="sd">        4. min mean X</span>

<span class="sd">    Args:</span>
<span class="sd">        print_screen (bool, optional):</span>
<span class="sd">            print results to screen</span>

<span class="sd">    Returns:</span>
<span class="sd">        output (list):</span>
<span class="sd">            list of results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;min y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;min mean y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">var_type</span> <span class="o">==</span> <span class="s2">&quot;factor&quot;</span> <span class="ow">and</span> <span class="nb">dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">get_ith_hyperparameter_name_from_fun_control</span><span class="p">(</span><span class="n">fun_control</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">var_name</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">print_screen</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">var_name</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.process_z00" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_z00</span><span class="p">(</span><span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.process_z00" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Process each entry in the <code>z00</code> array according to the corresponding type
in the <code>self.var_type</code> list.
Specifically, if the type is &ldquo;float&rdquo;, the function will calculate the mean of the two <code>z00</code> values.
If the type is not &ldquo;float&rdquo;, the function will retrun the maximum of the two <code>z00</code> values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>z00</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of values to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_min</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the minimum value is returned. If <code>False</code>, the maximum value is returned.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotpython.spot import spot
import numpy as np
import random
z00 = np.array([[1, 2, 3, 4], [5, 6, 7, 8]])
spot.var_type = [&ldquo;float&rdquo;, &ldquo;int&rdquo;, &ldquo;int&rdquo;, &ldquo;float&rdquo;]
spot.process_z00(z00)
[3, 6, 7, 6]</p>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_z00</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z00</span><span class="p">,</span> <span class="n">use_min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process each entry in the `z00` array according to the corresponding type</span>
<span class="sd">    in the `self.var_type` list.</span>
<span class="sd">    Specifically, if the type is &quot;float&quot;, the function will calculate the mean of the two `z00` values.</span>
<span class="sd">    If the type is not &quot;float&quot;, the function will retrun the maximum of the two `z00` values.</span>

<span class="sd">    Args:</span>
<span class="sd">        z00 (numpy.ndarray):</span>
<span class="sd">            Array of values to process.</span>
<span class="sd">        use_min (bool):</span>
<span class="sd">            If `True`, the minimum value is returned. If `False`, the maximum value is returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Processed values.</span>

<span class="sd">    Examples:</span>
<span class="sd">        from spotpython.spot import spot</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        import random</span>
<span class="sd">        z00 = np.array([[1, 2, 3, 4], [5, 6, 7, 8]])</span>
<span class="sd">        spot.var_type = [&quot;float&quot;, &quot;int&quot;, &quot;int&quot;, &quot;float&quot;]</span>
<span class="sd">        spot.process_z00(z00)</span>
<span class="sd">        [3, 6, 7, 6]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">)):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
            <span class="n">mean_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># var_type[i] == &#39;int&#39;</span>
            <span class="k">if</span> <span class="n">use_min</span><span class="p">:</span>
                <span class="n">min_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">z00</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">X_start</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.run" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run the surrogate based optimization.
The optimization process is controlled by the following steps:
    1. Initialize design
    2. Update stats
    3. Fit surrogate
    4. Update design
    5. Update stats
    6. Update writer
    7. Fit surrogate
    8. Show progress if needed</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_start</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial design. The initial design must have shape (n, k), where n is the number of points and k is the number of dimensions. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Spot</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Spot (spotpython.spot.spot.Spot)" href="#spotpython.spot.spot.Spot">Spot</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>Spot</code> instance configured and updated based on the optimization process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 7</span>
<span class="go">    # start point X_0</span>
<span class="go">    X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1]))</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    S = Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.run(X_start=X_start)</span>
<span class="go">        spotpython tuning: 0.0 [########--] 80.00%</span>
<span class="go">        spotpython tuning: 0.0 [#########-] 86.67%</span>
<span class="go">        spotpython tuning: 0.0 [#########-] 93.33%</span>
<span class="go">        spotpython tuning: 0.0 [##########] 100.00% Done...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
<span class="go">    min y: 0.0</span>
<span class="go">    x0: 0.0</span>
<span class="go">    x1: 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">X</span>
<span class="go">    array([[ 0.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="go">    [ 0.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="go">    [ 1.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="go">    [ 1.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="go">    [-9.0924338949946959e-01, -1.5823457680063502e-01],</span>
<span class="go">    [-2.0581710650646035e-01, -4.8124908877104844e-01],</span>
<span class="go">    [ 9.4974117111856260e-01, -9.4631271618736390e-01],</span>
<span class="go">    [-1.2095571372201608e-01,  6.3835886343683867e-02],</span>
<span class="go">    [-6.6278701759800063e-01,  1.7431637339680406e-01],</span>
<span class="go">    [ 2.8200844136299108e-01,  9.3001011398034406e-01],</span>
<span class="go">    [ 4.7878811540073962e-01,  6.5321058189282999e-01],</span>
<span class="go">    [ 1.5404061268479530e-04,  4.1895410759355553e-03],</span>
<span class="go">    [-1.7027205448129213e-04,  4.7698567182254507e-03],</span>
<span class="go">    [-4.4080972128058849e-04,  5.2785168039883147e-03],</span>
<span class="go">    [ 3.7700880321788425e-03,  1.8909833144458731e-02]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">y</span>
<span class="go">    array([0.0000000000000000e+00, 1.0000000000000000e+00,</span>
<span class="go">    1.0000000000000000e+00, 2.0000000000000000e+00,</span>
<span class="go">    8.5176172264376016e-01, 2.7396136677365612e-01,</span>
<span class="go">    1.7975160489355650e+00, 1.8705305067286033e-02,</span>
<span class="go">    4.6967282873066640e-01, 9.4444757310571603e-01,</span>
<span class="go">    6.5592212374576153e-01, 1.7575982937307560e-05,</span>
<span class="go">    2.2780525684937748e-05, 2.8057052860362483e-05,</span>
<span class="go">    3.7179535332164810e-04])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_start</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Spot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the surrogate based optimization.</span>
<span class="sd">    The optimization process is controlled by the following steps:</span>
<span class="sd">        1. Initialize design</span>
<span class="sd">        2. Update stats</span>
<span class="sd">        3. Fit surrogate</span>
<span class="sd">        4. Update design</span>
<span class="sd">        5. Update stats</span>
<span class="sd">        6. Update writer</span>
<span class="sd">        7. Fit surrogate</span>
<span class="sd">        8. Show progress if needed</span>

<span class="sd">    Args:</span>
<span class="sd">        X_start (numpy.ndarray, optional):</span>
<span class="sd">            initial design. The initial design must have shape (n, k), where n is the number of points and k is the number of dimensions. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spot: The `Spot` instance configured and updated based on the optimization process.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 7</span>
<span class="sd">            # start point X_0</span>
<span class="sd">            X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1]])</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1]))</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            S = Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.run(X_start=X_start)</span>
<span class="sd">                spotpython tuning: 0.0 [########--] 80.00%</span>
<span class="sd">                spotpython tuning: 0.0 [#########-] 86.67%</span>
<span class="sd">                spotpython tuning: 0.0 [#########-] 93.33%</span>
<span class="sd">                spotpython tuning: 0.0 [##########] 100.00% Done...</span>
<span class="sd">        &gt;&gt;&gt; S.print_results()</span>
<span class="sd">            min y: 0.0</span>
<span class="sd">            x0: 0.0</span>
<span class="sd">            x1: 0.0</span>
<span class="sd">        &gt;&gt;&gt; S.X</span>
<span class="sd">            array([[ 0.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="sd">            [ 0.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="sd">            [ 1.0000000000000000e+00,  0.0000000000000000e+00],</span>
<span class="sd">            [ 1.0000000000000000e+00,  1.0000000000000000e+00],</span>
<span class="sd">            [-9.0924338949946959e-01, -1.5823457680063502e-01],</span>
<span class="sd">            [-2.0581710650646035e-01, -4.8124908877104844e-01],</span>
<span class="sd">            [ 9.4974117111856260e-01, -9.4631271618736390e-01],</span>
<span class="sd">            [-1.2095571372201608e-01,  6.3835886343683867e-02],</span>
<span class="sd">            [-6.6278701759800063e-01,  1.7431637339680406e-01],</span>
<span class="sd">            [ 2.8200844136299108e-01,  9.3001011398034406e-01],</span>
<span class="sd">            [ 4.7878811540073962e-01,  6.5321058189282999e-01],</span>
<span class="sd">            [ 1.5404061268479530e-04,  4.1895410759355553e-03],</span>
<span class="sd">            [-1.7027205448129213e-04,  4.7698567182254507e-03],</span>
<span class="sd">            [-4.4080972128058849e-04,  5.2785168039883147e-03],</span>
<span class="sd">            [ 3.7700880321788425e-03,  1.8909833144458731e-02]])</span>
<span class="sd">        &gt;&gt;&gt; S.y</span>
<span class="sd">            array([0.0000000000000000e+00, 1.0000000000000000e+00,</span>
<span class="sd">            1.0000000000000000e+00, 2.0000000000000000e+00,</span>
<span class="sd">            8.5176172264376016e-01, 2.7396136677365612e-01,</span>
<span class="sd">            1.7975160489355650e+00, 1.8705305067286033e-02,</span>
<span class="sd">            4.6967282873066640e-01, 9.4444757310571603e-01,</span>
<span class="sd">            6.5592212374576153e-01, 1.7575982937307560e-05,</span>
<span class="sd">            2.2780525684937748e-05, 2.8057052860362483e-05,</span>
<span class="sd">            3.7179535332164810e-04])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">get_result_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;force_run&quot;</span><span class="p">):</span>
        <span class="c1"># print a warning and load the result</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result file </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> exists. Loading the result.&quot;</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">load_result</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_copy_from</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_design</span><span class="p">(</span><span class="n">X_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_stats</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_surrogate</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">------ Starting optimization on the Surrogate for the given Budget ------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">timeout_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_continue</span><span class="p">(</span><span class="n">timeout_start</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_design</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_stats</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_writer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_surrogate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_progress_if_needed</span><span class="p">(</span><span class="n">timeout_start</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;db_dict_name&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_db_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;save_result&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.save_experiment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_experiment</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s1">&#39;file_io&#39;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.save_experiment" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save the experiment to a file.
If no filename is provided, the filename is generated based on the PREFIX using the
<code>get_experiment_filename()</code> function. The experiment file is saved in the current working directory
unless a path is provided. The file is saved in pickle format using the highest protocol.
If no arguments are provided, the file is saved with the default name PREFIX + &ldquo;_exp.pkl&rdquo;.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the experiment file. If not provided,
the filename is generated based on the PREFIX using the
<code>get_experiment_filename()</code> function. Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the experiment file. If not provided, the file
is saved in the current working directory. Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the file will be overwritten if it already exists.
Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unpickleables</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of unpickleable components to exclude. Default is &ldquo;file_io&rdquo;, which
excludes file I/O components like the spot_writer and logger.
If set to any other value, the function will exclude the function, optimizer,
surrogate, data_set, scaler, rng, and design components.
Default is &ldquo;file_io&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;file_io&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbosity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The level of verbosity. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s2">&quot;file_io&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the experiment to a file.</span>
<span class="sd">    If no filename is provided, the filename is generated based on the PREFIX using the</span>
<span class="sd">    `get_experiment_filename()` function. The experiment file is saved in the current working directory</span>
<span class="sd">    unless a path is provided. The file is saved in pickle format using the highest protocol.</span>
<span class="sd">    If no arguments are provided, the file is saved with the default name PREFIX + &quot;_exp.pkl&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str):</span>
<span class="sd">            The filename of the experiment file. If not provided,</span>
<span class="sd">            the filename is generated based on the PREFIX using the</span>
<span class="sd">            `get_experiment_filename()` function. Default is `None`.</span>
<span class="sd">        path (str):</span>
<span class="sd">            The path to the experiment file. If not provided, the file</span>
<span class="sd">            is saved in the current working directory. Default is `None`.</span>
<span class="sd">        overwrite (bool):</span>
<span class="sd">            If `True`, the file will be overwritten if it already exists.</span>
<span class="sd">            Default is `True`.</span>
<span class="sd">        unpickleables (str):</span>
<span class="sd">            The type of unpickleable components to exclude. Default is &quot;file_io&quot;, which</span>
<span class="sd">            excludes file I/O components like the spot_writer and logger.</span>
<span class="sd">            If set to any other value, the function will exclude the function, optimizer,</span>
<span class="sd">            surrogate, data_set, scaler, rng, and design components.</span>
<span class="sd">            Default is &quot;file_io&quot;.</span>
<span class="sd">        verbosity (int):</span>
<span class="sd">            The level of verbosity. Default is 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure we don&#39;t accidentally try to pickle unpicklable components</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_close_and_del_spot_writer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_remove_logger_handlers</span><span class="p">()</span>

    <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pickle_safe_spot_tuner</span><span class="p">(</span><span class="n">unpickleables</span><span class="o">=</span><span class="n">unpickleables</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>

    <span class="c1"># Determine the filename based on PREFIX if not provided</span>
    <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">,</span> <span class="s2">&quot;experiment&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">get_experiment_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># Check if the file already exists</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> already exists. Use overwrite=True to overwrite the file.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Serialize the experiment dictionary to the pickle file</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during pickling: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experiment saved to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.save_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_result</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.save_result" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save the results to a file.
If filename is not provided, the filename is generated based on the PREFIX using the
<code>get_result_filename()</code> function. The results file is saved in the current working directory
unless a path is provided. The file is saved in pickle format using the highest protocol.
If no arguments are provided, the file is saved with the default name PREFIX + &ldquo;_res.pkl&rdquo;.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the results file. If not provided,
the filename is generated based on the PREFIX using the
<code>get_result_filename()</code> function. Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the results file. If not provided, the file
is saved in the current working directory. Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the file will be overwritten if it already exists.
Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbosity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The level of verbosity. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the results to a file.</span>
<span class="sd">    If filename is not provided, the filename is generated based on the PREFIX using the</span>
<span class="sd">    `get_result_filename()` function. The results file is saved in the current working directory</span>
<span class="sd">    unless a path is provided. The file is saved in pickle format using the highest protocol.</span>
<span class="sd">    If no arguments are provided, the file is saved with the default name PREFIX + &quot;_res.pkl&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str):</span>
<span class="sd">            The filename of the results file. If not provided,</span>
<span class="sd">            the filename is generated based on the PREFIX using the</span>
<span class="sd">            `get_result_filename()` function. Default is `None`.</span>
<span class="sd">        path (str):</span>
<span class="sd">            The path to the results file. If not provided, the file</span>
<span class="sd">            is saved in the current working directory. Default is `None`.</span>
<span class="sd">        overwrite (bool):</span>
<span class="sd">            If `True`, the file will be overwritten if it already exists.</span>
<span class="sd">            Default is `True`.</span>
<span class="sd">        verbosity (int):</span>
<span class="sd">            The level of verbosity. Default is 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">get_result_filename</span><span class="p">(</span><span class="n">PREFIX</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_experiment</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span> <span class="n">unpickleables</span><span class="o">=</span><span class="s2">&quot;file_io&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.set_de_bounds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_de_bounds</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.set_de_bounds" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the bounds for the differential evolution optimizer.
The bounds are internal, because they are functions of self.lower and self.upper
and used by the optimizer. They are stored in self.de_bounds as a list of lists,
where each inner list contains the lower and upper bound for one dimension.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower=np.array([-1, -1]),</span>
<span class="go">        upper=np.array([1, 1])</span>
<span class="go">    )</span>
<span class="go">    S = spot.Spot(fun=lambda x: x, fun_control=fun_control)</span>
<span class="go">    S.set_de_bounds()</span>
<span class="go">    print(S.de_bounds)</span>
<span class="go">    [[-1, 1], [-1, 1]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_de_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the bounds for the differential evolution optimizer.</span>
<span class="sd">    The bounds are internal, because they are functions of self.lower and self.upper</span>
<span class="sd">    and used by the optimizer. They are stored in self.de_bounds as a list of lists,</span>
<span class="sd">    where each inner list contains the lower and upper bound for one dimension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower=np.array([-1, -1]),</span>
<span class="sd">                upper=np.array([1, 1])</span>
<span class="sd">            )</span>
<span class="sd">            S = spot.Spot(fun=lambda x: x, fun_control=fun_control)</span>
<span class="sd">            S.set_de_bounds()</span>
<span class="sd">            print(S.de_bounds)</span>
<span class="sd">            [[-1, 1], [-1, 1]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">de_bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">de_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_bounds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.show_progress_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_progress_if_needed</span><span class="p">(</span><span class="n">timeout_start</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.show_progress_if_needed" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Show progress bar if <code>show_progress</code> is <code>True</code>. If
self.progress_file is not <code>None</code>, the progress bar is saved
in the file with the name <code>self.progress_file</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout_start</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>start time</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show_progress_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_start</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show progress bar if `show_progress` is `True`. If</span>
<span class="sd">    self.progress_file is not `None`, the progress bar is saved</span>
<span class="sd">    in the file with the name `self.progress_file`.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): Spot object</span>
<span class="sd">        timeout_start (float): start time</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span><span class="p">):</span>
        <span class="n">progress_bar</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_evals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">progress_bar</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timeout_start</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">*</span> <span class="mi">60</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_y</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.suggest_new_X" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">suggest_new_X</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.suggest_new_X" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute <code>n_points</code> new infill points in natural units.
These diffrent points are computed by the optimizer using increasing seed.
The optimizer searches in the ranges from <code>lower_j</code> to <code>upper_j</code>.
The method <code>infill()</code> is used as the objective function.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>n_points</code> infill points in natural units, each of dim k</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This is step (S-14a) in [bart21i].</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    from spotpython.fun import Analytical</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    nn = 3</span>
<span class="go">    fun_sphere = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">            lower = np.array([-1, -1]),</span>
<span class="go">            upper = np.array([1, 1]),</span>
<span class="go">            n_points=nn,</span>
<span class="go">            )</span>
<span class="go">    S = Spot(</span>
<span class="go">        fun=fun_sphere,</span>
<span class="go">        fun_control=fun_control,</span>
<span class="go">        )</span>
<span class="go">    S.X = S.design.scipy_lhd(</span>
<span class="go">        S.design_control[&quot;init_size&quot;], lower=S.lower, upper=S.upper</span>
<span class="go">    )</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    S.y = S.fun(S.X)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    X0 = S.suggest_new_X()</span>
<span class="go">    print(f&quot;X0: {X0}&quot;)</span>
<span class="go">    assert X0.size == S.n_points * S.k</span>
<span class="go">    assert X0.ndim == 2</span>
<span class="go">    assert X0.shape[0] == nn</span>
<span class="go">    assert X0.shape[1] == 2</span>
<span class="go">    spot_1.X: [[ 0.86352963  0.7892358 ]</span>
<span class="go">                [-0.24407197 -0.83687436]</span>
<span class="go">                [ 0.36481882  0.8375811 ]</span>
<span class="go">                [ 0.415331    0.54468512]</span>
<span class="go">                [-0.56395091 -0.77797854]</span>
<span class="go">                [-0.90259409 -0.04899292]</span>
<span class="go">                [-0.16484832  0.35724741]</span>
<span class="go">                [ 0.05170659  0.07401196]</span>
<span class="go">                [-0.78548145 -0.44638164]</span>
<span class="go">                [ 0.64017497 -0.30363301]]</span>
<span class="go">    spot_1.y: [1.36857656 0.75992983 0.83463487 0.46918172 0.92329124 0.8170764</span>
<span class="go">    0.15480068 0.00815134 0.81623768 0.502017  ]</span>
<span class="go">    X0: [[0.00154544 0.003962  ]</span>
<span class="go">        [0.00165526 0.00410847]</span>
<span class="go">        [0.00165685 0.0039177 ]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">suggest_new_X</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute `n_points` new infill points in natural units.</span>
<span class="sd">    These diffrent points are computed by the optimizer using increasing seed.</span>
<span class="sd">    The optimizer searches in the ranges from `lower_j` to `upper_j`.</span>
<span class="sd">    The method `infill()` is used as the objective function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): `n_points` infill points in natural units, each of dim k</span>

<span class="sd">    Note:</span>
<span class="sd">        This is step (S-14a) in [bart21i].</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            from spotpython.fun import Analytical</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            nn = 3</span>
<span class="sd">            fun_sphere = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1]),</span>
<span class="sd">                    n_points=nn,</span>
<span class="sd">                    )</span>
<span class="sd">            S = Spot(</span>
<span class="sd">                fun=fun_sphere,</span>
<span class="sd">                fun_control=fun_control,</span>
<span class="sd">                )</span>
<span class="sd">            S.X = S.design.scipy_lhd(</span>
<span class="sd">                S.design_control[&quot;init_size&quot;], lower=S.lower, upper=S.upper</span>
<span class="sd">            )</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            S.y = S.fun(S.X)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            X0 = S.suggest_new_X()</span>
<span class="sd">            print(f&quot;X0: {X0}&quot;)</span>
<span class="sd">            assert X0.size == S.n_points * S.k</span>
<span class="sd">            assert X0.ndim == 2</span>
<span class="sd">            assert X0.shape[0] == nn</span>
<span class="sd">            assert X0.shape[1] == 2</span>
<span class="sd">            spot_1.X: [[ 0.86352963  0.7892358 ]</span>
<span class="sd">                        [-0.24407197 -0.83687436]</span>
<span class="sd">                        [ 0.36481882  0.8375811 ]</span>
<span class="sd">                        [ 0.415331    0.54468512]</span>
<span class="sd">                        [-0.56395091 -0.77797854]</span>
<span class="sd">                        [-0.90259409 -0.04899292]</span>
<span class="sd">                        [-0.16484832  0.35724741]</span>
<span class="sd">                        [ 0.05170659  0.07401196]</span>
<span class="sd">                        [-0.78548145 -0.44638164]</span>
<span class="sd">                        [ 0.64017497 -0.30363301]]</span>
<span class="sd">            spot_1.y: [1.36857656 0.75992983 0.83463487 0.46918172 0.92329124 0.8170764</span>
<span class="sd">            0.15480068 0.00815134 0.81623768 0.502017  ]</span>
<span class="sd">            X0: [[0.00154544 0.003962  ]</span>
<span class="sd">                [0.00165526 0.00410847]</span>
<span class="sd">                [0.00165685 0.0039177 ]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># (S-14a) Optimization on the surrogate:</span>
    <span class="n">new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">optimizer_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="n">optimizers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;dual_annealing&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
        <span class="s2">&quot;differential_evolution&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span>
            <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;max_iter&quot;</span><span class="p">],</span>
            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="s2">&quot;direct&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">),</span>
        <span class="s2">&quot;shgo&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
        <span class="s2">&quot;basinhopping&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_X</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;Nelder-Mead&quot;</span><span class="p">}),</span>
        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infill</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">de_bounds</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">optimizer_name</span><span class="p">,</span> <span class="n">optimizers</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])()</span>
        <span class="n">new_X</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.surrogate_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">surrogate_setup</span><span class="p">(</span><span class="n">surrogate</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.surrogate_setup" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set up the surrogate model for the optimization process.
This method initializes the surrogate model. If no surrogate model is provided,
it creates an internal Kriging surrogate with parameters specified in surrogate_control.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>surrogate</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A surrogate model object. If None, an internal Kriging model is created.
Defaults to None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>If no surrogate is provided, a Kriging model is initialized with the following parameters
from surrogate_control:
    - method: The Kriging method (e.g., &ldquo;interpolation&rdquo; or &ldquo;regression&rdquo;)
    - var_type: Variable types for each dimension
    - seed: Random seed for reproducibility
    - model_optimizer: Optimizer for model parameter tuning
    - model_fun_evals: Number of function evaluations for model optimization
    - min/max_theta: Bounds for theta parameters
    - theta_init_zero: Whether to initialize theta at zero
    - p_val: Power parameter p value
    - n_p: Number of p parameters
    - optim_p: Whether to optimize p parameters
    - min/max_Lambda: Bounds for lambda parameters
    - metric_factorial: Metric for factorial parameters</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.fun.objectivefunctions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Analytical</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.spot</span><span class="w"> </span><span class="kn">import</span> <span class="n">spot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotpython.utils.init</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun_control_init</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate_control_init</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">design_control_init</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup with default Kriging surrogate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fun_control</span> <span class="o">=</span> <span class="n">fun_control_init</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">lower</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate_control</span> <span class="o">=</span> <span class="n">surrogate_control_init</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">spot</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun</span><span class="o">=</span><span class="n">Analytical</span><span class="p">()</span><span class="o">.</span><span class="n">fun_sphere</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate_control</span><span class="o">=</span><span class="n">surrogate_control</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">surrogate</span><span class="o">.</span><span class="n">isotropic</span><span class="p">)</span>
<span class="go">False</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setup with custom surrogate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.gaussian_process</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianProcessRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_surrogate</span> <span class="o">=</span> <span class="n">GaussianProcessRegressor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span> <span class="o">=</span> <span class="n">spot</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">fun</span><span class="o">=</span><span class="n">Analytical</span><span class="p">()</span><span class="o">.</span><span class="n">fun_sphere</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fun_control</span><span class="o">=</span><span class="n">fun_control</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surrogate</span><span class="o">=</span><span class="n">custom_surrogate</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">surrogate</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="go">&#39;GaussianProcessRegressor&#39;</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">surrogate_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surrogate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up the surrogate model for the optimization process.</span>
<span class="sd">    This method initializes the surrogate model. If no surrogate model is provided,</span>
<span class="sd">    it creates an internal Kriging surrogate with parameters specified in surrogate_control.</span>

<span class="sd">    Args:</span>
<span class="sd">        surrogate (object, optional):</span>
<span class="sd">            A surrogate model object. If None, an internal Kriging model is created.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Note:</span>
<span class="sd">        If no surrogate is provided, a Kriging model is initialized with the following parameters</span>
<span class="sd">        from surrogate_control:</span>
<span class="sd">            - method: The Kriging method (e.g., &quot;interpolation&quot; or &quot;regression&quot;)</span>
<span class="sd">            - var_type: Variable types for each dimension</span>
<span class="sd">            - seed: Random seed for reproducibility</span>
<span class="sd">            - model_optimizer: Optimizer for model parameter tuning</span>
<span class="sd">            - model_fun_evals: Number of function evaluations for model optimization</span>
<span class="sd">            - min/max_theta: Bounds for theta parameters</span>
<span class="sd">            - theta_init_zero: Whether to initialize theta at zero</span>
<span class="sd">            - p_val: Power parameter p value</span>
<span class="sd">            - n_p: Number of p parameters</span>
<span class="sd">            - optim_p: Whether to optimize p parameters</span>
<span class="sd">            - min/max_Lambda: Bounds for lambda parameters</span>
<span class="sd">            - metric_factorial: Metric for factorial parameters</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.spot import spot</span>
<span class="sd">        &gt;&gt;&gt; from spotpython.utils.init import (</span>
<span class="sd">        ...     fun_control_init,</span>
<span class="sd">        ...     surrogate_control_init,</span>
<span class="sd">        ...     design_control_init</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; # Setup with default Kriging surrogate</span>
<span class="sd">        &gt;&gt;&gt; fun_control = fun_control_init(</span>
<span class="sd">        ...     lower=np.array([-1, -1]),</span>
<span class="sd">        ...     upper=np.array([1, 1])</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; surrogate_control = surrogate_control_init(</span>
<span class="sd">        ...     method=&quot;interpolation&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; S = spot.Spot(</span>
<span class="sd">        ...     fun=Analytical().fun_sphere,</span>
<span class="sd">        ...     fun_control=fun_control,</span>
<span class="sd">        ...     surrogate_control=surrogate_control</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; print(S.surrogate.isotropic)</span>
<span class="sd">        False</span>

<span class="sd">        &gt;&gt;&gt; # Setup with custom surrogate</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.gaussian_process import GaussianProcessRegressor</span>
<span class="sd">        &gt;&gt;&gt; custom_surrogate = GaussianProcessRegressor()</span>
<span class="sd">        &gt;&gt;&gt; S2 = spot.Spot(</span>
<span class="sd">        ...     fun=Analytical().fun_sphere,</span>
<span class="sd">        ...     fun_control=fun_control,</span>
<span class="sd">        ...     surrogate=custom_surrogate</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; print(type(S2.surrogate).__name__)</span>
<span class="sd">        &#39;GaussianProcessRegressor&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Surrogate related information:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="o">=</span> <span class="n">surrogate</span>
    <span class="c1"># If no surrogate model is specified, use the internal</span>
    <span class="c1"># spotpython Kriging surrogate:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Call kriging with surrogate_control parameters:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surrogate</span> <span class="o">=</span> <span class="n">Kriging</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span>
            <span class="n">var_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;var_type&quot;</span><span class="p">],</span>
            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
            <span class="n">model_optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_optimizer&quot;</span><span class="p">],</span>
            <span class="n">model_fun_evals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;model_fun_evals&quot;</span><span class="p">],</span>
            <span class="n">min_theta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;min_theta&quot;</span><span class="p">],</span>
            <span class="n">max_theta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;max_theta&quot;</span><span class="p">],</span>
            <span class="n">isotropic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;isotropic&quot;</span><span class="p">],</span>
            <span class="n">theta_init_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;theta_init_zero&quot;</span><span class="p">],</span>
            <span class="n">p_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;p_val&quot;</span><span class="p">],</span>
            <span class="n">n_p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;n_p&quot;</span><span class="p">],</span>
            <span class="n">optim_p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;optim_p&quot;</span><span class="p">],</span>
            <span class="n">min_Lambda</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;min_Lambda&quot;</span><span class="p">],</span>
            <span class="n">max_Lambda</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;max_Lambda&quot;</span><span class="p">],</span>
            <span class="n">log_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">,</span>
            <span class="n">spot_writer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="p">,</span>
            <span class="n">counter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;init_size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_control</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">metric_factorial</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">surrogate_control</span><span class="p">[</span><span class="s2">&quot;metric_factorial&quot;</span><span class="p">],</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.to_all_dim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_all_dim</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.to_all_dim" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Expands reduced-dimensional design points back to their full-dimensional representation
by reinserting fixed values for dimensions that were removed during the dimensionality
reduction process.
When <code>to_red_dim()</code> is called, dimensions where the lower and upper bounds are equal are
removed from the design points. <code>to_all_dim()</code> reverses this process by adding back these fixed
dimensions with their respective fixed values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X0</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reduced dimension design points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>full dimension design points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="atributes" open>
  <summary>Atributes</summary>
  <p>self.ident (numpy.ndarray):
    array of boolean values indicating fixed dimensions
self.all_lower (numpy.ndarray):
    backup of the original lower bounds.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="go">    lower = np.array([-1, -1, 0, 0])</span>
<span class="go">    upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="go">    fun_evals = 10</span>
<span class="go">    var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="go">    var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="go">    spot_instance = spot.Spot(</span>
<span class="go">        fun = Analytical().fun_sphere,</span>
<span class="go">        fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals)</span>
<span class="go">    )</span>
<span class="go">    X0 = np.array([[2.5, 3.5], [4.5, 5.5]])</span>
<span class="go">    X_full_dim = spot_instance.to_all_dim(X0)</span>
<span class="go">    print(X_full_dim)</span>
<span class="go">        [[ 2.5 -1.   0.   3.5]</span>
<span class="go">        [ 4.5 -1.   0.   5.5]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_all_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X0</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands reduced-dimensional design points back to their full-dimensional representation</span>
<span class="sd">    by reinserting fixed values for dimensions that were removed during the dimensionality</span>
<span class="sd">    reduction process.</span>
<span class="sd">    When `to_red_dim()` is called, dimensions where the lower and upper bounds are equal are</span>
<span class="sd">    removed from the design points. `to_all_dim()` reverses this process by adding back these fixed</span>
<span class="sd">    dimensions with their respective fixed values.</span>

<span class="sd">    Args:</span>
<span class="sd">        X0 (numpy.ndarray): reduced dimension design points</span>

<span class="sd">    Returns:</span>
<span class="sd">        (numpy.ndarray): full dimension design points</span>

<span class="sd">    Atributes:</span>
<span class="sd">        self.ident (numpy.ndarray):</span>
<span class="sd">            array of boolean values indicating fixed dimensions</span>
<span class="sd">        self.all_lower (numpy.ndarray):</span>
<span class="sd">            backup of the original lower bounds.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">            lower = np.array([-1, -1, 0, 0])</span>
<span class="sd">            upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="sd">            fun_evals = 10</span>
<span class="sd">            var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">            var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="sd">            spot_instance = spot.Spot(</span>
<span class="sd">                fun = Analytical().fun_sphere,</span>
<span class="sd">                fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals)</span>
<span class="sd">            )</span>
<span class="sd">            X0 = np.array([[2.5, 3.5], [4.5, 5.5]])</span>
<span class="sd">            X_full_dim = spot_instance.to_all_dim(X0)</span>
<span class="sd">            print(X_full_dim)</span>
<span class="sd">                [[ 2.5 -1.   0.   3.5]</span>
<span class="sd">                [ 4.5 -1.   0.   5.5]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of design points (samples):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Number of dimensions:</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
    <span class="c1"># Initialize full dimension design points:</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="c1"># The following code was modified in 0.20.5:</span>
    <span class="c1"># Index for navigating X0&#39;s compressed dimension</span>
    <span class="n">reduced_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Iterate through each dimension, reconstructing full dimensionality</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="c1"># Assign fixed dimension values using stored lower bounds</span>
            <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_lower</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Assign variable dimension values from the reduced array</span>
            <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X0</span><span class="p">[:,</span> <span class="n">reduced_index</span><span class="p">]</span>
            <span class="c1"># Move to the next variable dimension in the compact X0 array</span>
            <span class="n">reduced_index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.to_all_dim_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#spotpython.spot.spot.Spot.to_all_dim_if_needed" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Conditionally expand reduced-dimensional design points back to their full-dimensional representation,
if dimensionality reduction was performed.
This method checks whether dimensionality reduction occurred (i.e., whether some dimensions were
fixed and thus removed). If so, it uses <code>to_all_dim()</code> to restore the full-dimensional representation
by reinserting the fixed dimensions. Otherwise, it returns the input design points unaltered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D numpy array of shape (n, m), where <code>n</code> is the number of samples, and <code>m</code>
            corresponds to the reduced or full number of dimensions depending on the
            <code>red_dim</code> status.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: A 2D numpy array of shape (n, k). If <code>red_dim</code> is True, <code>k</code> will be the full number
        of dimensions (including both fixed and variable). If <code>red_dim</code> is False, <code>k</code> is
        identical to <code>m</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_all_dim_if_needed.self.red_dim">self.red_dim</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean attribute indicating if dimensionality was reduced
                (True if dimensions were reduced, False otherwise).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_all_dim_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conditionally expand reduced-dimensional design points back to their full-dimensional representation,</span>
<span class="sd">    if dimensionality reduction was performed.</span>
<span class="sd">    This method checks whether dimensionality reduction occurred (i.e., whether some dimensions were</span>
<span class="sd">    fixed and thus removed). If so, it uses `to_all_dim()` to restore the full-dimensional representation</span>
<span class="sd">    by reinserting the fixed dimensions. Otherwise, it returns the input design points unaltered.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray): A 2D numpy array of shape (n, m), where `n` is the number of samples, and `m`</span>
<span class="sd">                        corresponds to the reduced or full number of dimensions depending on the</span>
<span class="sd">                        `red_dim` status.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: A 2D numpy array of shape (n, k). If `red_dim` is True, `k` will be the full number</span>
<span class="sd">                    of dimensions (including both fixed and variable). If `red_dim` is False, `k` is</span>
<span class="sd">                    identical to `m`.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.red_dim (bool): A boolean attribute indicating if dimensionality was reduced</span>
<span class="sd">                            (True if dimensions were reduced, False otherwise).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">red_dim</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.to_red_dim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_red_dim</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.to_red_dim" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reduces the dimensionality of the optimization problem by removing dimensions
where lower and upper bounds are equal, indicating that those variables are fixed.
This function modifies the lower bounds, upper bounds, variable types, and variable names
by filtering out the non-varying dimensions. If any dimension is reduced, the <code>red_dim</code> attribute
is set to True, and the count of dimensions (<code>k</code>) is updated accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.lower">self.lower</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lower bound</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.upper">self.upper</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>upper bound</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.var_type">self.var_type</span></code></td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of variable types</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.ident">self.ident</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>array of boolean values indicating fixed dimensions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.red_dim">self.red_dim</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if dimensions are reduced, False otherwise. Checks if any dimension is fixed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.all_lower">self.all_lower</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>backup of the original lower bounds</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.to_red_dim.self.all_upper">self.all_upper</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>backup of the original upper bounds</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="go">    lower = np.array([-1, -1, 0, 0])</span>
<span class="go">    upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="go">    fun_evals = 10</span>
<span class="go">    var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="go">    var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="go">    spot_instance = spot.Spot(</span>
<span class="go">        # Assuming Spot takes fun, fun_control, design_control as arguments</span>
<span class="go">        fun = Analytical().fun_sphere,  # Replace with appropriate function</span>
<span class="go">        fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals, show_progress=True, log_level=50),</span>
<span class="go">    )</span>
<span class="go">    spot_instance.var_type = var_type</span>
<span class="go">    spot_instance.var_name = var_name</span>
<span class="go">    spot_instance.to_red_dim()</span>
<span class="go">    # Assert: Check if dimensions were reduced correctly</span>
<span class="go">    assert spot_instance.lower.size == 2, &quot;Expected size of lower to be 2 after reduction&quot;</span>
<span class="go">    assert spot_instance.upper.size == 2, &quot;Expected size of upper to be 2 after reduction&quot;</span>
<span class="go">    assert len(spot_instance.var_type) == 2, &quot;Expected size of var_type to be 2 after reduction&quot;</span>
<span class="go">    assert spot_instance.k == 2, &quot;Expected k to reflect the reduced dimensions&quot;</span>
<span class="go">    # Check remaining values</span>
<span class="go">    expected_lower = np.array([-1, 0])</span>
<span class="go">    expected_upper = np.array([1, 5])</span>
<span class="go">    expected_var_type = [&#39;float&#39;, &#39;int&#39;]</span>
<span class="go">    # there are two remaining variables, they are named x1 and x2</span>
<span class="go">    expected_var_name = [&#39;x1&#39;, &#39;x2&#39;]</span>
<span class="go">    np.testing.assert_array_equal(spot_instance.lower, expected_lower)</span>
<span class="go">    np.testing.assert_array_equal(spot_instance.upper, expected_upper)</span>
<span class="go">    assert spot_instance.var_type == expected_var_type</span>
<span class="go">    assert spot_instance.var_name == expected_var_name</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_red_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduces the dimensionality of the optimization problem by removing dimensions</span>
<span class="sd">    where lower and upper bounds are equal, indicating that those variables are fixed.</span>
<span class="sd">    This function modifies the lower bounds, upper bounds, variable types, and variable names</span>
<span class="sd">    by filtering out the non-varying dimensions. If any dimension is reduced, the `red_dim` attribute</span>
<span class="sd">    is set to True, and the count of dimensions (`k`) is updated accordingly.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): Spot object</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.lower (numpy.ndarray):</span>
<span class="sd">            lower bound</span>
<span class="sd">        self.upper (numpy.ndarray):</span>
<span class="sd">            upper bound</span>
<span class="sd">        self.var_type (List[str]):</span>
<span class="sd">            list of variable types</span>
<span class="sd">        self.ident (numpy.ndarray):</span>
<span class="sd">            array of boolean values indicating fixed dimensions</span>
<span class="sd">        self.red_dim (bool):</span>
<span class="sd">            True if dimensions are reduced, False otherwise. Checks if any dimension is fixed.</span>
<span class="sd">        self.all_lower (numpy.ndarray):</span>
<span class="sd">            backup of the original lower bounds</span>
<span class="sd">        self.all_upper (numpy.ndarray):</span>
<span class="sd">            backup of the original upper bounds</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">            lower = np.array([-1, -1, 0, 0])</span>
<span class="sd">            upper = np.array([1, -1, 0, 5])  # Second and third dimensions are fixed</span>
<span class="sd">            fun_evals = 10</span>
<span class="sd">            var_type = [&#39;float&#39;, &#39;int&#39;, &#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">            var_name = [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]</span>
<span class="sd">            spot_instance = spot.Spot(</span>
<span class="sd">                # Assuming Spot takes fun, fun_control, design_control as arguments</span>
<span class="sd">                fun = Analytical().fun_sphere,  # Replace with appropriate function</span>
<span class="sd">                fun_control=fun_control_init(lower=lower, upper=upper, fun_evals=fun_evals, show_progress=True, log_level=50),</span>
<span class="sd">            )</span>
<span class="sd">            spot_instance.var_type = var_type</span>
<span class="sd">            spot_instance.var_name = var_name</span>
<span class="sd">            spot_instance.to_red_dim()</span>
<span class="sd">            # Assert: Check if dimensions were reduced correctly</span>
<span class="sd">            assert spot_instance.lower.size == 2, &quot;Expected size of lower to be 2 after reduction&quot;</span>
<span class="sd">            assert spot_instance.upper.size == 2, &quot;Expected size of upper to be 2 after reduction&quot;</span>
<span class="sd">            assert len(spot_instance.var_type) == 2, &quot;Expected size of var_type to be 2 after reduction&quot;</span>
<span class="sd">            assert spot_instance.k == 2, &quot;Expected k to reflect the reduced dimensions&quot;</span>
<span class="sd">            # Check remaining values</span>
<span class="sd">            expected_lower = np.array([-1, 0])</span>
<span class="sd">            expected_upper = np.array([1, 5])</span>
<span class="sd">            expected_var_type = [&#39;float&#39;, &#39;int&#39;]</span>
<span class="sd">            # there are two remaining variables, they are named x1 and x2</span>
<span class="sd">            expected_var_name = [&#39;x1&#39;, &#39;x2&#39;]</span>
<span class="sd">            np.testing.assert_array_equal(spot_instance.lower, expected_lower)</span>
<span class="sd">            np.testing.assert_array_equal(spot_instance.upper, expected_upper)</span>
<span class="sd">            assert spot_instance.var_type == expected_var_type</span>
<span class="sd">            assert spot_instance.var_name == expected_var_name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Backup of the original values:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span>
    <span class="c1"># Select only lower != upper:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="c1"># Determine if dimension is reduced:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">red_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
    <span class="c1"># Modifications:</span>
    <span class="c1"># Modify lower and upper:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span>
    <span class="c1"># Modify k (number of dim):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="o">.</span><span class="n">size</span>
    <span class="c1"># Filter out types and names corresponding to non-varying dimensions</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">vtype</span> <span class="k">for</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">fixed</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">vname</span> <span class="k">for</span> <span class="n">vname</span><span class="p">,</span> <span class="n">fixed</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_var_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.update_design" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_design</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.update_design" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update design. Generate and evaluate new design points.
It is basically a call to the method <code>get_new_X0()</code>.
If <code>noise</code> is <code>True</code>, additionally the following steps
(from <code>get_X_ocba()</code>) are performed:
1. Compute OCBA points.
2. Evaluate OCBA points.
3. Append OCBA points to the new design points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_design.self.X">self.X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>updated design</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_design.self.y">self.y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>updated design values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Without OCBA points:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.utils.init import (</span>
<span class="go">        fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="go">        )</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 0</span>
<span class="go">    X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1, -1]),</span>
<span class="go">        upper = np.array([1, 1])</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni)</span>
<span class="go">    S = Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                design_control=design_control,)</span>
<span class="go">    S.initialize_design(X_start=X_start)</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">    X_shape_before = S.X.shape</span>
<span class="go">    print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="go">    print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="go">    y_size_before = S.y.size</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.update_design()</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">    print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="go">    print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="go">    print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Using the OCBA points:</span>
<span class="go">    import numpy as np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import Spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="go">    # number of initial points:</span>
<span class="go">    ni = 3</span>
<span class="go">    X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">            sigma=0.02,</span>
<span class="go">            lower = np.array([-1, -1]),</span>
<span class="go">            upper = np.array([1, 1]),</span>
<span class="go">            noise=True,</span>
<span class="go">            ocba_delta=1,</span>
<span class="go">        )</span>
<span class="go">    design_control=design_control_init(init_size=ni, repeats=2)</span>
<span class="go">    S = Spot(fun=fun,</span>
<span class="go">                design_control=design_control,</span>
<span class="go">                fun_control=fun_control</span>
<span class="go">    )</span>
<span class="go">    S.initialize_design(X_start=X_start)</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">    X_shape_before = S.X.shape</span>
<span class="go">    print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="go">    print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="go">    y_size_before = S.y.size</span>
<span class="go">    S.update_stats()</span>
<span class="go">    S.fit_surrogate()</span>
<span class="go">    S.update_design()</span>
<span class="go">    print(f&quot;S.X: {S.X}&quot;)</span>
<span class="go">    print(f&quot;S.y: {S.y}&quot;)</span>
<span class="go">    print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="go">    print(f&quot;S.ocba_delta: {S.ocba_delta}&quot;)</span>
<span class="go">    print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="go">    print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="go">    # compare the shapes of the X and y values before and after the update_design method</span>
<span class="go">    assert X_shape_before[0] + S.ocba_delta == S.X.shape[0]</span>
<span class="go">    assert X_shape_before[1] == S.X.shape[1]</span>
<span class="go">    assert y_size_before + S.ocba_delta == S.y.size</span>
<span class="go">    Experiment saved to 000_exp.pkl</span>
<span class="go">        S.X: [[ 0.          1.        ]</span>
<span class="go">        [ 1.          0.        ]</span>
<span class="go">        [ 1.          1.        ]</span>
<span class="go">        [ 1.          1.        ]</span>
<span class="go">        [ 0.54509876 -0.36921401]</span>
<span class="go">        [ 0.54509876 -0.36921401]</span>
<span class="go">        [ 0.18642675  0.87708546]</span>
<span class="go">        [ 0.18642675  0.87708546]</span>
<span class="go">        [-0.45060393 -0.208063  ]</span>
<span class="go">        [-0.45060393 -0.208063  ]]</span>
<span class="go">        S.y: [0.98021757 0.99264427 2.02575851 2.00387949 0.45185626 0.44499372</span>
<span class="go">        0.79130456 0.81487288 0.24000221 0.23988634]</span>
<span class="go">        X_shape_before: (10, 2)</span>
<span class="go">        y_size_before: 10</span>
<span class="go">        S.X: [[ 0.          1.        ]</span>
<span class="go">        [ 1.          0.        ]</span>
<span class="go">        [ 1.          1.        ]</span>
<span class="go">        [ 1.          1.        ]</span>
<span class="go">        [ 0.54509876 -0.36921401]</span>
<span class="go">        [ 0.54509876 -0.36921401]</span>
<span class="go">        [ 0.18642675  0.87708546]</span>
<span class="go">        [ 0.18642675  0.87708546]</span>
<span class="go">        [-0.45060393 -0.208063  ]</span>
<span class="go">        [-0.45060393 -0.208063  ]</span>
<span class="go">        [-0.02292587  0.0145145 ]]</span>
<span class="go">        S.y: [ 0.98021757  0.99264427  2.02575851  2.00387949  0.45185626  0.44499372</span>
<span class="go">        0.79130456  0.81487288  0.24000221  0.23988634 -0.01904616]</span>
<span class="go">        S.n_points: 1</span>
<span class="go">        S.ocba_delta: 1</span>
<span class="go">        X_shape_after: (11, 2)</span>
<span class="go">        y_size_after: 11</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_design</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update design. Generate and evaluate new design points.</span>
<span class="sd">    It is basically a call to the method `get_new_X0()`.</span>
<span class="sd">    If `noise` is `True`, additionally the following steps</span>
<span class="sd">    (from `get_X_ocba()`) are performed:</span>
<span class="sd">    1. Compute OCBA points.</span>
<span class="sd">    2. Evaluate OCBA points.</span>
<span class="sd">    3. Append OCBA points to the new design points.</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): Spot object</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.X (numpy.ndarray): updated design</span>
<span class="sd">        self.y (numpy.ndarray): updated design values</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # 1. Without OCBA points:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.utils.init import (</span>
<span class="sd">                fun_control_init, optimizer_control_init, surrogate_control_init, design_control_init</span>
<span class="sd">                )</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 0</span>
<span class="sd">            X_start = np.array([[0, 0], [0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1, -1]),</span>
<span class="sd">                upper = np.array([1, 1])</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni)</span>
<span class="sd">            S = Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        design_control=design_control,)</span>
<span class="sd">            S.initialize_design(X_start=X_start)</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">            X_shape_before = S.X.shape</span>
<span class="sd">            print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="sd">            print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="sd">            y_size_before = S.y.size</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.update_design()</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">            print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="sd">            print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="sd">            print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="sd">        &gt;&gt;&gt; #</span>
<span class="sd">        &gt;&gt;&gt; # 2. Using the OCBA points:</span>
<span class="sd">            import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import Spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init, design_control_init</span>
<span class="sd">            # number of initial points:</span>
<span class="sd">            ni = 3</span>
<span class="sd">            X_start = np.array([[0, 1], [1, 0], [1, 1], [1, 1]])</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                    sigma=0.02,</span>
<span class="sd">                    lower = np.array([-1, -1]),</span>
<span class="sd">                    upper = np.array([1, 1]),</span>
<span class="sd">                    noise=True,</span>
<span class="sd">                    ocba_delta=1,</span>
<span class="sd">                )</span>
<span class="sd">            design_control=design_control_init(init_size=ni, repeats=2)</span>
<span class="sd">            S = Spot(fun=fun,</span>
<span class="sd">                        design_control=design_control,</span>
<span class="sd">                        fun_control=fun_control</span>
<span class="sd">            )</span>
<span class="sd">            S.initialize_design(X_start=X_start)</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">            X_shape_before = S.X.shape</span>
<span class="sd">            print(f&quot;X_shape_before: {X_shape_before}&quot;)</span>
<span class="sd">            print(f&quot;y_size_before: {S.y.size}&quot;)</span>
<span class="sd">            y_size_before = S.y.size</span>
<span class="sd">            S.update_stats()</span>
<span class="sd">            S.fit_surrogate()</span>
<span class="sd">            S.update_design()</span>
<span class="sd">            print(f&quot;S.X: {S.X}&quot;)</span>
<span class="sd">            print(f&quot;S.y: {S.y}&quot;)</span>
<span class="sd">            print(f&quot;S.n_points: {S.n_points}&quot;)</span>
<span class="sd">            print(f&quot;S.ocba_delta: {S.ocba_delta}&quot;)</span>
<span class="sd">            print(f&quot;X_shape_after: {S.X.shape}&quot;)</span>
<span class="sd">            print(f&quot;y_size_after: {S.y.size}&quot;)</span>
<span class="sd">            # compare the shapes of the X and y values before and after the update_design method</span>
<span class="sd">            assert X_shape_before[0] + S.ocba_delta == S.X.shape[0]</span>
<span class="sd">            assert X_shape_before[1] == S.X.shape[1]</span>
<span class="sd">            assert y_size_before + S.ocba_delta == S.y.size</span>
<span class="sd">            Experiment saved to 000_exp.pkl</span>
<span class="sd">                S.X: [[ 0.          1.        ]</span>
<span class="sd">                [ 1.          0.        ]</span>
<span class="sd">                [ 1.          1.        ]</span>
<span class="sd">                [ 1.          1.        ]</span>
<span class="sd">                [ 0.54509876 -0.36921401]</span>
<span class="sd">                [ 0.54509876 -0.36921401]</span>
<span class="sd">                [ 0.18642675  0.87708546]</span>
<span class="sd">                [ 0.18642675  0.87708546]</span>
<span class="sd">                [-0.45060393 -0.208063  ]</span>
<span class="sd">                [-0.45060393 -0.208063  ]]</span>
<span class="sd">                S.y: [0.98021757 0.99264427 2.02575851 2.00387949 0.45185626 0.44499372</span>
<span class="sd">                0.79130456 0.81487288 0.24000221 0.23988634]</span>
<span class="sd">                X_shape_before: (10, 2)</span>
<span class="sd">                y_size_before: 10</span>
<span class="sd">                S.X: [[ 0.          1.        ]</span>
<span class="sd">                [ 1.          0.        ]</span>
<span class="sd">                [ 1.          1.        ]</span>
<span class="sd">                [ 1.          1.        ]</span>
<span class="sd">                [ 0.54509876 -0.36921401]</span>
<span class="sd">                [ 0.54509876 -0.36921401]</span>
<span class="sd">                [ 0.18642675  0.87708546]</span>
<span class="sd">                [ 0.18642675  0.87708546]</span>
<span class="sd">                [-0.45060393 -0.208063  ]</span>
<span class="sd">                [-0.45060393 -0.208063  ]</span>
<span class="sd">                [-0.02292587  0.0145145 ]]</span>
<span class="sd">                S.y: [ 0.98021757  0.99264427  2.02575851  2.00387949  0.45185626  0.44499372</span>
<span class="sd">                0.79130456  0.81487288  0.24000221  0.23988634 -0.01904616]</span>
<span class="sd">                S.n_points: 1</span>
<span class="sd">                S.ocba_delta: 1</span>
<span class="sd">                X_shape_after: (11, 2)</span>
<span class="sd">                y_size_after: 11</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># OCBA (only if noise). Determination of the OCBA points depends on the</span>
    <span class="c1"># old X and y values.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;self.var_y &lt;= 0. OCBA points are not generated:&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;There are less than 3 points or points with no variance information.&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In update_design(): self.mean_X: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;In update_design(): self.var_y: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">X_ocba</span> <span class="o">=</span> <span class="n">get_ocba_X</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_ocba</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Determine the new X0 values based on the old X and y values:</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_new_X0</span><span class="p">()</span>
    <span class="c1"># Append OCBA points to the new design points:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocba_delta</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">X0</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="n">X_ocba</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">X_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_all_dim_if_needed</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;In update_design(): self.fun_control sigma and seed passed to fun(): </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="c1"># (S-18): Evaluating New Solutions:</span>
    <span class="n">y_mo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_all</span><span class="p">,</span> <span class="n">fun_control</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">)</span>
    <span class="c1"># Convert multi-objective values to single-objective values:</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mo2so</span><span class="p">(</span><span class="n">y_mo</span><span class="p">)</span>
    <span class="c1"># Apply penalty for NA values works only on so values:</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_penalty_NA</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="p">[</span><span class="s2">&quot;penalty_NA&quot;</span><span class="p">],</span> <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">stop_on_zero_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Append New Solutions (only if they are not nan):</span>
    <span class="k">if</span> <span class="n">y0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, generate a random point and append it to the design</span>
        <span class="n">Xr</span><span class="p">,</span> <span class="n">yr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_random_point</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">Xr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.update_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_stats</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.update_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the following stats:
1. <code>min_y</code>, 2. <code>min_X</code>, and 3. <code>counter</code>
If <code>noise</code> is <code>True</code>, additionally the following stats are computed:
1. <code>mean_X</code>,  2. <code>mean_y</code>,  3. <code>var_y</code>, 4. <code>min_mean_X</code>(X value of the best mean y value so far),
5. <code>min_mean_y</code> (best mean y value so far), and 6. <code>min_var_y</code> (ariance of the best mean y value so far).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>self</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spot object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NoneType">NoneType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.min_y">self.min_y</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>minimum y value</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.min_X">self.min_X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X value of the minimum y value</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.counter">self.counter</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of function evaluations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.mean_X">self.mean_X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mean X values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.mean_y">self.mean_y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mean y values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.var_y">self.var_y</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>variance of y values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.min_mean_y">self.min_mean_y</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>minimum mean y value</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotpython.spot.spot.Spot.update_stats.self.min_mean_X">self.min_mean_X</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X value of the minimum mean y value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the following stats:</span>
<span class="sd">    1. `min_y`, 2. `min_X`, and 3. `counter`</span>
<span class="sd">    If `noise` is `True`, additionally the following stats are computed:</span>
<span class="sd">    1. `mean_X`,  2. `mean_y`,  3. `var_y`, 4. `min_mean_X`(X value of the best mean y value so far),</span>
<span class="sd">    5. `min_mean_y` (best mean y value so far), and 6. `min_var_y` (ariance of the best mean y value so far).</span>

<span class="sd">    Args:</span>
<span class="sd">        self (object): Spot object</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): None</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.min_y (float): minimum y value</span>
<span class="sd">        self.min_X (numpy.ndarray): X value of the minimum y value</span>
<span class="sd">        self.counter (int): number of function evaluations</span>
<span class="sd">        self.mean_X (numpy.ndarray): mean X values</span>
<span class="sd">        self.mean_y (numpy.ndarray): mean y values</span>
<span class="sd">        self.var_y (numpy.ndarray): variance of y values</span>
<span class="sd">        self.min_mean_y (float): minimum mean y value</span>
<span class="sd">        self.min_mean_X (numpy.ndarray): X value of the minimum mean y value</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fun_control</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;counter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">})</span>
    <span class="c1"># Update aggregated x and y values (if noise):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">aggregate_mean_var</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># X value of the best mean y value so far:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_X</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>
        <span class="c1"># best mean y value so far:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_mean_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>
        <span class="c1"># variance of the best mean y value so far:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_var_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_y</span><span class="p">[</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_y</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotpython.spot.spot.Spot.write_initial_tensorboard_log" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_initial_tensorboard_log</span><span class="p">()</span></code>

<a href="#spotpython.spot.spot.Spot.write_initial_tensorboard_log" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Writes initial design data using the spot_writer. The spot_writer
is a tensorboard writer that writes the data to a tensorboard file.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotpython.fun.objectivefunctions import Analytical</span>
<span class="go">    from spotpython.spot import spot</span>
<span class="go">    from spotpython.utils.init import fun_control_init</span>
<span class="go">    fun = Analytical().fun_sphere</span>
<span class="go">    fun_control = fun_control_init(</span>
<span class="go">        lower = np.array([-1]),</span>
<span class="go">        upper = np.array([1])</span>
<span class="go">        )</span>
<span class="go">    S = spot.Spot(fun=fun,</span>
<span class="go">                fun_control=fun_control,</span>
<span class="go">                )</span>
<span class="go">    S.initialize_design()</span>
<span class="go">    S.write_initial_tensorboard_log()</span>
<span class="go">        Moving TENSORBOARD_PATH: runs/ to TENSORBOARD_PATH_OLD: runs_OLD/runs_2025_01_12_09_24_15</span>
<span class="go">        Created spot_tensorboard_path: runs/spot_logs/00_p040025_2025-01-12_09-24-15 for SummaryWriter()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>spotpython/spot/spot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_initial_tensorboard_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes initial design data using the spot_writer. The spot_writer</span>
<span class="sd">    is a tensorboard writer that writes the data to a tensorboard file.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotpython.fun.objectivefunctions import Analytical</span>
<span class="sd">            from spotpython.spot import spot</span>
<span class="sd">            from spotpython.utils.init import fun_control_init</span>
<span class="sd">            fun = Analytical().fun_sphere</span>
<span class="sd">            fun_control = fun_control_init(</span>
<span class="sd">                lower = np.array([-1]),</span>
<span class="sd">                upper = np.array([1])</span>
<span class="sd">                )</span>
<span class="sd">            S = spot.Spot(fun=fun,</span>
<span class="sd">                        fun_control=fun_control,</span>
<span class="sd">                        )</span>
<span class="sd">            S.initialize_design()</span>
<span class="sd">            S.write_initial_tensorboard_log()</span>
<span class="sd">                Moving TENSORBOARD_PATH: runs/ to TENSORBOARD_PATH_OLD: runs_OLD/runs_2025_01_12_09_24_15</span>
<span class="sd">                Created spot_tensorboard_path: runs/spot_logs/00_p040025_2025-01-12_09-24-15 for SummaryWriter()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spot_writer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># range goes to init_size -1 because the last value is added by update_stats(),</span>
        <span class="c1"># which always adds the last value.</span>
        <span class="c1"># Changed in 0.5.9:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)):</span>
            <span class="n">X_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">y_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">X_j</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)}</span>
            <span class="c1"># var_dict = assign_values(X, get_var_name(fun_control))</span>
            <span class="c1"># config = list(generate_one_config_from_var_dict(var_dict, fun_control))[0]</span>
            <span class="c1"># see: https://github.com/pytorch/pytorch/issues/32651</span>
            <span class="c1"># self.spot_writer.add_hparams(config, {&quot;spot_y&quot;: y_j}, run_name=self.spot_tensorboard_path)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;hp_metric&quot;</span><span class="p">:</span> <span class="n">y_j</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spot_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2004 - 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bartzbeielstein" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomas-bartz-beielstein-3157b541/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>