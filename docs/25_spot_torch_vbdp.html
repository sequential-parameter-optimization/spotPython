<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hyperparameter Tuning Cookbook - 20&nbsp; HPT: PyTorch With VBDP</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./99_spot_doc.html" rel="next">
<link href="./24_spot_torch_regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>



<meta name="twitter:title" content="Hyperparameter Tuning Cookbook - 20&nbsp; HPT: PyTorch With VBDP">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="25_spot_torch_vbdp_files/figure-html/cell-27-output-1.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./25_spot_torch_vbdp.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">HPT: PyTorch With VBDP</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hyperparameter Tuning Cookbook</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sequential-parameter-optimization/spotPython" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Hyperparameter-Tuning-Cookbook.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_spot_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction: Hyperparameter Tuning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_spot_multidim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Multi-dimensional Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_spot_anisotropic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Isotropic and Anisotropic Kriging</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_spot_sklearn_surrogate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Using <code>sklearn</code> Surrogates in <code>spotPython</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_spot_sklearn_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequential Parameter Optimization: Using <code>scipy</code> Optimizers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_spot_gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sequential Parameter Optimization: Gaussian Process Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_spot_ei.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Expected Improvement</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_spot_noisy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hyperparameter Tuning and Noise</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_spot_ocba.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Handling Noise: Optimal Computational Budget Allocation in <code>Spot</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_spot_hpt_sklearn_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">HPT: sklearn SVC on Moons Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_spot_hpt_torch_fashion_mnist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">HPT: PyTorch With fashionMNIST</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_spot_hpt_torch_cifar10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">HPT: PyTorch With cifar10 Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_spot_hpt_river.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">HPT: River</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_spot_ray_hpt_torch_cifar10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">HPT: PyTorch With <code>spotPython</code> and Ray Tune on CIFAR10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_spot_hpt_sklearn_multiclass_classification_randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">HPT: sklearn RandomForestClassifier VBDP Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_spot_hpt_sklearn_multiclass_classification_xgb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">HPT: sklearn XGB Classifier VBDP Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_spot_hpt_sklearn_multiclass_classification_svc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">HPT: sklearn SVC VBDP Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_spot_hpt_sklearn_multiclass_classification_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">HPT: sklearn KNN Classifier VBDP Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_spot_torch_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">HPT PyTorch: Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_spot_torch_vbdp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">HPT: PyTorch With VBDP</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_spot_doc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Documentation of the Sequential Parameter Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-setup-25" id="toc-sec-setup-25" class="nav-link active" data-scroll-target="#sec-setup-25"><span class="header-section-number">20.1</span> Setup</a></li>
  <li><a href="#sec-data-loading-25" id="toc-sec-data-loading-25" class="nav-link" data-scroll-target="#sec-data-loading-25"><span class="header-section-number">20.2</span> Initialization of the <code>fun_control</code> Dictionary</a></li>
  <li><a href="#sec-data-loading-25" id="toc-sec-data-loading-25" class="nav-link" data-scroll-target="#sec-data-loading-25"><span class="header-section-number">21</span> PyTorch Data Loading</a>
  <ul class="collapse">
  <li><a href="#load-vbdp-data" id="toc-load-vbdp-data" class="nav-link" data-scroll-target="#load-vbdp-data"><span class="header-section-number">21.1</span> 1. Load VBDP Data</a>
  <ul class="collapse">
  <li><a href="#check-content-of-the-target-column" id="toc-check-content-of-the-target-column" class="nav-link" data-scroll-target="#check-content-of-the-target-column"><span class="header-section-number">21.1.1</span> Check content of the target column</a></li>
  </ul></li>
  <li><a href="#sec-the-model-to-be-tuned-25" id="toc-sec-the-model-to-be-tuned-25" class="nav-link" data-scroll-target="#sec-the-model-to-be-tuned-25"><span class="header-section-number">21.2</span> The Model (Algorithm) to be Tuned</a></li>
  <li><a href="#sec-specification-of-preprocessing-model-25" id="toc-sec-specification-of-preprocessing-model-25" class="nav-link" data-scroll-target="#sec-specification-of-preprocessing-model-25"><span class="header-section-number">21.3</span> Specification of the Preprocessing Model</a></li>
  <li><a href="#sec-selection-of-the-algorithm-25" id="toc-sec-selection-of-the-algorithm-25" class="nav-link" data-scroll-target="#sec-selection-of-the-algorithm-25"><span class="header-section-number">21.4</span> Select <code>algorithm</code> and <code>core_model_hyper_dict</code></a>
  <ul class="collapse">
  <li><a href="#sec-implementation-with-spotpython-24" id="toc-sec-implementation-with-spotpython-24" class="nav-link" data-scroll-target="#sec-implementation-with-spotpython-24"><span class="header-section-number">21.4.1</span> Implementing a Configurable Neural Network With spotPython</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#add-the-nn-model-to-the-fun_control-dictionary" id="toc-add-the-nn-model-to-the-fun_control-dictionary" class="nav-link" data-scroll-target="#add-the-nn-model-to-the-fun_control-dictionary"><span class="header-section-number">22</span> add the nn model to the fun_control dictionary</a>
  <ul class="collapse">
  <li><a href="#sec-modification-of-hyperparameters-25" id="toc-sec-modification-of-hyperparameters-25" class="nav-link" data-scroll-target="#sec-modification-of-hyperparameters-25"><span class="header-section-number">22.1</span> Modifying the Hyperparameters</a>
  <ul class="collapse">
  <li><a href="#sec-optimizers-25" id="toc-sec-optimizers-25" class="nav-link" data-scroll-target="#sec-optimizers-25"><span class="header-section-number">22.1.1</span> Optimizers</a></li>
  </ul></li>
  <li><a href="#sec-selection-of-target-function-25" id="toc-sec-selection-of-target-function-25" class="nav-link" data-scroll-target="#sec-selection-of-target-function-25"><span class="header-section-number">22.2</span> Evaluation</a>
  <ul class="collapse">
  <li><a href="#sec-loss-functions-and-metrics-25" id="toc-sec-loss-functions-and-metrics-25" class="nav-link" data-scroll-target="#sec-loss-functions-and-metrics-25"><span class="header-section-number">22.2.1</span> Loss Functions and Metrics</a></li>
  <li><a href="#sec-metric-25" id="toc-sec-metric-25" class="nav-link" data-scroll-target="#sec-metric-25"><span class="header-section-number">22.2.2</span> Metric</a></li>
  </ul></li>
  <li><a href="#sec-prepare-spot-call-25" id="toc-sec-prepare-spot-call-25" class="nav-link" data-scroll-target="#sec-prepare-spot-call-25"><span class="header-section-number">22.3</span> Preparing the SPOT Call</a></li>
  <li><a href="#sec-the-objective-function-25" id="toc-sec-the-objective-function-25" class="nav-link" data-scroll-target="#sec-the-objective-function-25"><span class="header-section-number">22.4</span> The Objective Function <code>fun_torch</code></a></li>
  <li><a href="#sec-call-the-hyperparameter-tuner-25" id="toc-sec-call-the-hyperparameter-tuner-25" class="nav-link" data-scroll-target="#sec-call-the-hyperparameter-tuner-25"><span class="header-section-number">22.5</span> Starting the Hyperparameter Tuning</a></li>
  <li><a href="#sec-tensorboard-25" id="toc-sec-tensorboard-25" class="nav-link" data-scroll-target="#sec-tensorboard-25"><span class="header-section-number">22.6</span> Tensorboard</a></li>
  <li><a href="#sec-results-25" id="toc-sec-results-25" class="nav-link" data-scroll-target="#sec-results-25"><span class="header-section-number">22.7</span> Results</a></li>
  <li><a href="#sec-get-spot-results-25" id="toc-sec-get-spot-results-25" class="nav-link" data-scroll-target="#sec-get-spot-results-25"><span class="header-section-number">22.8</span> Get the Tuned Architecture</a></li>
  <li><a href="#evaluation-of-the-tuned-architecture" id="toc-evaluation-of-the-tuned-architecture" class="nav-link" data-scroll-target="#evaluation-of-the-tuned-architecture"><span class="header-section-number">22.9</span> Evaluation of the Tuned Architecture</a></li>
  <li><a href="#cross-validated-evaluations" id="toc-cross-validated-evaluations" class="nav-link" data-scroll-target="#cross-validated-evaluations"><span class="header-section-number">22.10</span> Cross-validated Evaluations</a></li>
  <li><a href="#detailed-hyperparameter-plots" id="toc-detailed-hyperparameter-plots" class="nav-link" data-scroll-target="#detailed-hyperparameter-plots"><span class="header-section-number">22.11</span> Detailed Hyperparameter Plots</a></li>
  <li><a href="#parallel-coordinates-plot" id="toc-parallel-coordinates-plot" class="nav-link" data-scroll-target="#parallel-coordinates-plot"><span class="header-section-number">22.12</span> Parallel Coordinates Plot</a></li>
  <li><a href="#plot-all-combinations-of-hyperparameters" id="toc-plot-all-combinations-of-hyperparameters" class="nav-link" data-scroll-target="#plot-all-combinations-of-hyperparameters"><span class="header-section-number">22.13</span> Plot all Combinations of Hyperparameters</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-vbdp" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">HPT: PyTorch With VBDP</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this tutorial, we will show how <code>spotPython</code> can be integrated into the <code>PyTorch</code> training workflow for a classifiaction task.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ensure that the correspondiing data is available as <code>./data/VBDP/train.csv</code>.</p>
</div>
</div>
<p>This document refers to the following software versions:</p>
<ul>
<li><code>python</code>: 3.10.10</li>
<li><code>torch</code>: 2.0.1</li>
<li><code>torchvision</code>: 0.15.0</li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pip <span class="bu">list</span> <span class="op">|</span> grep  <span class="st">"spot[RiverPython]"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython                 0.2.34
spotRiver                  0.0.93</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: you may need to restart the kernel to use updated packages.</code></pre>
</div>
</div>
<p><code>spotPython</code> can be installed via pip. Alternatively, the source code can be downloaded from gitHub: <a href="https://github.com/sequential-parameter-optimization/spotPython">https://github.com/sequential-parameter-optimization/spotPython</a>.</p>
<pre class="{raw}"><code>!pip install spotPython</code></pre>
<ul>
<li>Uncomment the following lines if you want to for (re-)installation the latest version of <code>spotPython</code> from gitHub.</li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import sys</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># !{sys.executable} -m pip install --upgrade build</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># !{sys.executable} -m pip install --upgrade --force-reinstall spotPython</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-setup-25" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sec-setup-25"><span class="header-section-number">20.1</span> Setup</h2>
<p>Before we consider the detailed experimental setup, we select the parameters that affect run time, initial design size and the device that is used.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>MAX_TIME <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>INIT_SIZE <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>DEVICE <span class="op">=</span> <span class="va">None</span> <span class="co"># "cpu" # "cuda:0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.utils.device <span class="im">import</span> getDevice</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>DEVICE <span class="op">=</span> getDevice(DEVICE)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(DEVICE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mps</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil.tz <span class="im">import</span> tzlocal</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> datetime.now(tzlocal())</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>HOSTNAME <span class="op">=</span> socket.gethostname().split(<span class="st">"."</span>)[<span class="dv">0</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>experiment_name <span class="op">=</span> <span class="st">'25-torch'</span> <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> HOSTNAME <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> <span class="bu">str</span>(MAX_TIME) <span class="op">+</span> <span class="st">"min_"</span> <span class="op">+</span> <span class="bu">str</span>(INIT_SIZE) <span class="op">+</span> <span class="st">"init_"</span> <span class="op">+</span> <span class="bu">str</span>(start_time).split(<span class="st">"."</span>, <span class="dv">1</span>)[<span class="dv">0</span>].replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>experiment_name <span class="op">=</span> experiment_name.replace(<span class="st">':'</span>, <span class="st">'-'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(experiment_name)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="st">'./figures'</span>):</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">'./figures'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25-torch_p040025_60min_10init_2023-06-17_17-19-50</code></pre>
</div>
</div>
</section>
<section id="sec-data-loading-25" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sec-data-loading-25"><span class="header-section-number">20.2</span> Initialization of the <code>fun_control</code> Dictionary</h2>
<p><code>spotPython</code> uses a Python dictionary for storing the information required for the hyperparameter tuning process, which was described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-initialization-fun-control-14"><span>Section&nbsp;14.2</span></a>.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.utils.init <span class="im">import</span> fun_control_init</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> fun_control_init(task<span class="op">=</span><span class="st">"classification"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    tensorboard_path<span class="op">=</span><span class="st">"runs/25_spot_torch_vbdp"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    device<span class="op">=</span>DEVICE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-data-loading-25" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> PyTorch Data Loading</h1>
<section id="load-vbdp-data" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="load-vbdp-data"><span class="header-section-number">21.1</span> 1. Load VBDP Data</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.read_csv(<span class="st">'./data/VBDP/train.csv'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the id column</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> train_df.drop(columns<span class="op">=</span>[<span class="st">'id'</span>])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> train_df.shape[<span class="dv">0</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> train_df.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">"prognosis"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Encoder our prognosis labels as integers for easier decoding later</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>enc <span class="op">=</span> OrdinalEncoder()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>train_df[target_column] <span class="op">=</span> enc.fit_transform(train_df[[target_column]])</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>train_df.head()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># convert all entries to int for faster processing</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> train_df.astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.data.vbdp <span class="im">import</span> combine_features</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> train_df.copy()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># save the target column using "target_column" as the column name</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> train_df[target_column]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the target column</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df_new.drop(columns<span class="op">=</span>[target_column])</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> combine_features(df_new)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add the target column back</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>train_df[target_column] <span class="op">=</span> target</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>train_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sudden_fever</th>
<th data-quarto-table-cell-role="th">headache</th>
<th data-quarto-table-cell-role="th">mouth_bleed</th>
<th data-quarto-table-cell-role="th">nose_bleed</th>
<th data-quarto-table-cell-role="th">muscle_pain</th>
<th data-quarto-table-cell-role="th">joint_pain</th>
<th data-quarto-table-cell-role="th">vomiting</th>
<th data-quarto-table-cell-role="th">rash</th>
<th data-quarto-table-cell-role="th">diarrhea</th>
<th data-quarto-table-cell-role="th">hypotension</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">6039</th>
<th data-quarto-table-cell-role="th">6040</th>
<th data-quarto-table-cell-role="th">6041</th>
<th data-quarto-table-cell-role="th">6042</th>
<th data-quarto-table-cell-role="th">6043</th>
<th data-quarto-table-cell-role="th">6044</th>
<th data-quarto-table-cell-role="th">6045</th>
<th data-quarto-table-cell-role="th">6046</th>
<th data-quarto-table-cell-role="th">6047</th>
<th data-quarto-table-cell-role="th">prognosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
</tr>
</tbody>
</table>

<p>5 rows × 6113 columns</p>
</div>
</div>
</div>
<ul>
<li>feature engineering: 6112 features</li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> train_df.shape[<span class="dv">0</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> train_df.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>train_df.columns <span class="op">=</span> [<span class="ss">f"x</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_features<span class="op">+</span><span class="dv">1</span>)] <span class="op">+</span> [target_column]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>train_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x1</th>
<th data-quarto-table-cell-role="th">x2</th>
<th data-quarto-table-cell-role="th">x3</th>
<th data-quarto-table-cell-role="th">x4</th>
<th data-quarto-table-cell-role="th">x5</th>
<th data-quarto-table-cell-role="th">x6</th>
<th data-quarto-table-cell-role="th">x7</th>
<th data-quarto-table-cell-role="th">x8</th>
<th data-quarto-table-cell-role="th">x9</th>
<th data-quarto-table-cell-role="th">x10</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">x6104</th>
<th data-quarto-table-cell-role="th">x6105</th>
<th data-quarto-table-cell-role="th">x6106</th>
<th data-quarto-table-cell-role="th">x6107</th>
<th data-quarto-table-cell-role="th">x6108</th>
<th data-quarto-table-cell-role="th">x6109</th>
<th data-quarto-table-cell-role="th">x6110</th>
<th data-quarto-table-cell-role="th">x6111</th>
<th data-quarto-table-cell-role="th">x6112</th>
<th data-quarto-table-cell-role="th">prognosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
</tr>
</tbody>
</table>

<p>5 rows × 6113 columns</p>
</div>
</div>
</div>
<section id="check-content-of-the-target-column" class="level3" data-number="21.1.1">
<h3 data-number="21.1.1" class="anchored" data-anchor-id="check-content-of-the-target-column"><span class="header-section-number">21.1.1</span> Check content of the target column</h3>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>train_df[target_column].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>0     3
1     7
2     3
3    10
4     6
Name: prognosis, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(train_df.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>), train_df[target_column],</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                                    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                                    test_size<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                                    stratify<span class="op">=</span>train_df[target_column])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>trainset <span class="op">=</span> pd.DataFrame(np.hstack((X_train, np.array(y_train).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>testset <span class="op">=</span> pd.DataFrame(np.hstack((X_test, np.array(y_test).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>trainset.columns <span class="op">=</span> [<span class="ss">f"x</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_features<span class="op">+</span><span class="dv">1</span>)] <span class="op">+</span> [target_column]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>testset.columns <span class="op">=</span> [<span class="ss">f"x</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_features<span class="op">+</span><span class="dv">1</span>)] <span class="op">+</span> [target_column]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_df.shape)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainset.shape)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(testset.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(707, 6113)
(530, 6113)
(177, 6113)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.dataframedataset <span class="im">import</span> DataFrameDataset</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dtype_x <span class="op">=</span> torch.float32</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dtype_y <span class="op">=</span> torch.<span class="bu">long</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> DataFrameDataset(train_df, target_column<span class="op">=</span>target_column, dtype_x<span class="op">=</span>dtype_x, dtype_y<span class="op">=</span>dtype_y)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> DataFrameDataset(trainset, target_column<span class="op">=</span>target_column, dtype_x<span class="op">=</span>dtype_x, dtype_y<span class="op">=</span>dtype_y)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> DataFrameDataset(testset, target_column<span class="op">=</span>target_column, dtype_x<span class="op">=</span>dtype_x, dtype_y<span class="op">=</span>dtype_y)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="bu">len</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the dataset to the fun_control</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fun_control.update({<span class="st">"data"</span>: train_df, <span class="co"># full dataset,</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"train"</span>: train,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"test"</span>: test,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"n_samples"</span>: n_samples,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"target_column"</span>: target_column})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sec-the-model-to-be-tuned-25" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sec-the-model-to-be-tuned-25"><span class="header-section-number">21.2</span> The Model (Algorithm) to be Tuned</h2>
</section>
<section id="sec-specification-of-preprocessing-model-25" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="sec-specification-of-preprocessing-model-25"><span class="header-section-number">21.3</span> Specification of the Preprocessing Model</h2>
<p>After the training and test data are specified and added to the <code>fun_control</code> dictionary, <code>spotPython</code> allows the specification of a data preprocessing pipeline, e.g., for the scaling of the data or for the one-hot encoding of categorical variables, see <a href="14_spot_ray_hpt_torch_cifar10.html#sec-specification-of-preprocessing-model-14"><span>Section&nbsp;14.4.1</span></a>. This feature is not used here, so we do not change the default value (which is <code>None</code>).</p>
</section>
<section id="sec-selection-of-the-algorithm-25" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="sec-selection-of-the-algorithm-25"><span class="header-section-number">21.4</span> Select <code>algorithm</code> and <code>core_model_hyper_dict</code></h2>
<section id="sec-implementation-with-spotpython-24" class="level3" data-number="21.4.1">
<h3 data-number="21.4.1" class="anchored" data-anchor-id="sec-implementation-with-spotpython-24"><span class="header-section-number">21.4.1</span> Implementing a Configurable Neural Network With spotPython</h3>
<p><code>spotPython</code> includes the <code>Net_vbdp</code> class which is implemented in the file <code>netvbdp.py</code>. The class is imported here.</p>
<p>This class inherits from the class <code>Net_Core</code> which is implemented in the file <code>netcore.py</code>, see <a href="14_spot_ray_hpt_torch_cifar10.html#sec-the-netcore-class-14"><span>Section&nbsp;14.4.3</span></a>.</p>
</section>
</section>
</section>
<section id="add-the-nn-model-to-the-fun_control-dictionary" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> add the nn model to the fun_control dictionary</h1>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.netvbdp <span class="im">import</span> Net_vbdp</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.data.torch_hyper_dict <span class="im">import</span> TorchHyperDict</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> add_core_model_to_fun_control</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> add_core_model_to_fun_control(core_model<span class="op">=</span>Net_vbdp,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                              fun_control<span class="op">=</span>fun_control,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                              hyper_dict<span class="op">=</span>TorchHyperDict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-modification-of-hyperparameters-25" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sec-modification-of-hyperparameters-25"><span class="header-section-number">22.1</span> Modifying the Hyperparameters</h2>
<p><code>spotPython</code> provides functions for modifying the hyperparameters, their bounds and factors as well as for activating and de-activating hyperparameters without re-compilation of the Python source code. These functions were described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-modification-of-hyperparameters-14"><span>Section&nbsp;14.5.3</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Small number of epochs for demonstration purposes
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>epochs</code> is set to 2 and 3 for demonstration purposes. These values are too small for a real application.</li>
</ul>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> modify_hyper_parameter_bounds</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"_L0"</span>, bounds<span class="op">=</span>[n_features, n_features])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"l1"</span>, bounds<span class="op">=</span>[<span class="dv">6</span>, <span class="dv">13</span>])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"epochs"</span>, bounds<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"patience"</span>, bounds<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">6</span>])</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"lr_mult"</span>, bounds<span class="op">=</span>[<span class="fl">1e-3</span>, <span class="fl">1e-3</span>])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control, <span class="st">"sgd_momentum"</span>, bounds<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> modify_hyper_parameter_levels</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_levels(fun_control, <span class="st">"optimizer"</span>,[<span class="st">"Adam"</span>, <span class="st">"AdamW"</span>, <span class="st">"Adamax"</span>, <span class="st">"NAdam"</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_control = modify_hyper_parameter_levels(fun_control, "optimizer", ["Adam"])</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_control = modify_hyper_parameter_levels(fun_control, "leaf_model", ["LinearRegression"])</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_control["core_model_hyper_dict"]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lr_mult"</span>, bounds<span class="op">=</span>[<span class="fl">1e-3</span>, <span class="fl">1e-3</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fun_control <span class="op">=</span> modify_hyper_parameter_bounds(fun_control,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sgd_momentum"</span>, bounds<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-optimizers-25" class="level3" data-number="22.1.1">
<h3 data-number="22.1.1" class="anchored" data-anchor-id="sec-optimizers-25"><span class="header-section-number">22.1.1</span> Optimizers</h3>
<p>Optimizers are described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-optimizers-14"><span>Section&nbsp;14.6</span></a>.</p>
</section>
</section>
<section id="sec-selection-of-target-function-25" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sec-selection-of-target-function-25"><span class="header-section-number">22.2</span> Evaluation</h2>
<p>The evaluation procedure requires the specification of two elements:</p>
<ol type="1">
<li>the way how the data is split into a train and a test set (see <a href="14_spot_ray_hpt_torch_cifar10.html#sec-data-splitting-14"><span>Section&nbsp;14.7</span></a>)</li>
<li>the loss function (and a metric).</li>
</ol>
<section id="sec-loss-functions-and-metrics-25" class="level3" data-number="22.2.1">
<h3 data-number="22.2.1" class="anchored" data-anchor-id="sec-loss-functions-and-metrics-25"><span class="header-section-number">22.2.1</span> Loss Functions and Metrics</h3>
<p>The loss function is specified by the key <code>"loss_function"</code>. We will use CrossEntropy loss for the multiclass-classification task.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.nn <span class="im">import</span> CrossEntropyLoss</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> CrossEntropyLoss()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fun_control.update({<span class="st">"loss_function"</span>: loss_function})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-metric-25" class="level3" data-number="22.2.2">
<h3 data-number="22.2.2" class="anchored" data-anchor-id="sec-metric-25"><span class="header-section-number">22.2.2</span> Metric</h3>
<ul>
<li>We will use the MAP@k metric for the evaluation of the model. Here is an example how this metric is calculated.</li>
</ul>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.mapk <span class="im">import</span> MAPK</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mapk <span class="op">=</span> MAPK(k<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> torch.tensor([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> torch.tensor(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>],  <span class="co"># 0 is in top 2</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>],  <span class="co"># 1 is in top 2</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>],  <span class="co"># 2 is in top 2</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>],  <span class="co"># 2 isn't in top 2</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>)  </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>mapk.update(preds, target)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mapk.compute()) <span class="co"># tensor(0.6250)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor(0.6250)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.mapk <span class="im">import</span> MAPK</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchmetrics</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>metric_torch <span class="op">=</span> MAPK(k<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>fun_control.update({<span class="st">"metric_torch"</span>: metric_torch})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sec-prepare-spot-call-25" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="sec-prepare-spot-call-25"><span class="header-section-number">22.3</span> Preparing the SPOT Call</h2>
<p>The following code passes the information about the parameter ranges and bounds to <code>spot</code>.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the variable types, names, and bounds</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> (get_bound_values,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    get_var_name,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    get_var_type,)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>var_type <span class="op">=</span> get_var_type(fun_control)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>var_name <span class="op">=</span> get_var_name(fun_control)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>fun_control.update({<span class="st">"var_type"</span>: var_type,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"var_name"</span>: var_name})</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>lower <span class="op">=</span> get_bound_values(fun_control, <span class="st">"lower"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>upper <span class="op">=</span> get_bound_values(fun_control, <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, the dictionary <code>fun_control</code> contains all information needed for the hyperparameter tuning. Before the hyperparameter tuning is started, it is recommended to take a look at the experimental design. The method <code>gen_design_table</code> generates a design table as follows:</p>
<div class="cell" data-fig-label="tbl-design-25" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.utils.eda <span class="im">import</span> gen_design_table</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gen_design_table(fun_control))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>| name         | type   | default   |    lower |    upper | transform             |
|--------------|--------|-----------|----------|----------|-----------------------|
| _L0          | int    | 64        | 6112     | 6112     | None                  |
| l1           | int    | 8         |    6     |   13     | transform_power_2_int |
| dropout_prob | float  | 0.01      |    0     |    0.9   | None                  |
| lr_mult      | float  | 1.0       |    0.001 |    0.001 | None                  |
| batch_size   | int    | 4         |    1     |    4     | transform_power_2_int |
| epochs       | int    | 4         |    2     |    2     | transform_power_2_int |
| k_folds      | int    | 1         |    1     |    1     | None                  |
| patience     | int    | 2         |    2     |    6     | transform_power_2_int |
| optimizer    | factor | SGD       |    0     |    3     | None                  |
| sgd_momentum | float  | 0.0       |    0.9   |    0.9   | None                  |</code></pre>
</div>
</div>
<p>This allows to check if all information is available and if the information is correct.</p>
</section>
<section id="sec-the-objective-function-25" class="level2" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="sec-the-objective-function-25"><span class="header-section-number">22.4</span> The Objective Function <code>fun_torch</code></h2>
<p>The objective function <code>fun_torch</code> is selected next. It implements an interface from <code>PyTorch</code>’s training, validation, and testing methods to <code>spotPython</code>.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.fun.hypertorch <span class="im">import</span> HyperTorch</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> HyperTorch().fun_torch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> get_default_hyperparameters_as_array</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>hyper_dict<span class="op">=</span>TorchHyperDict().load()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>X_start <span class="op">=</span> get_default_hyperparameters_as_array(fun_control, hyper_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-call-the-hyperparameter-tuner-25" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="sec-call-the-hyperparameter-tuner-25"><span class="header-section-number">22.5</span> Starting the Hyperparameter Tuning</h2>
<p>The <code>spotPython</code> hyperparameter tuning is started by calling the <code>Spot</code> function as described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-call-the-hyperparameter-tuner-14"><span>Section&nbsp;14.12</span></a>.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.spot <span class="im">import</span> spot</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>spot_tuner <span class="op">=</span> spot.Spot(fun<span class="op">=</span>fun,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                   lower <span class="op">=</span> lower,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                   upper <span class="op">=</span> upper,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                   fun_evals <span class="op">=</span> inf,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                   fun_repeats <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                   max_time <span class="op">=</span> MAX_TIME,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                   noise <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                   tolerance_x <span class="op">=</span> np.sqrt(np.spacing(<span class="dv">1</span>)),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                   var_type <span class="op">=</span> var_type,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                   var_name <span class="op">=</span> var_name,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                   infill_criterion <span class="op">=</span> <span class="st">"y"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                   n_points <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                   seed<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                   log_level <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                   show_models<span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                   show_progress<span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                   fun_control <span class="op">=</span> fun_control,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                   design_control<span class="op">=</span>{<span class="st">"init_size"</span>: INIT_SIZE,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"repeats"</span>: <span class="dv">1</span>},</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                   surrogate_control<span class="op">=</span>{<span class="st">"noise"</span>: <span class="va">True</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"cod_type"</span>: <span class="st">"norm"</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"min_theta"</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"max_theta"</span>: <span class="dv">3</span>,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"n_theta"</span>: <span class="bu">len</span>(var_name),</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"model_fun_evals"</span>: <span class="dv">10_000</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"log_level"</span>: <span class="dv">50</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>                                      })</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>spot_tuner.run(X_start<span class="op">=</span>X_start)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 1024, 'dropout_prob': 0.26515610830779995, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'Adamax', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3980805697264493
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.15740741789340973
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.398154276388663
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.1527777910232544
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.398083730980202
Accuracy on hold-out set: 0.05188679245283019
MAPK value on hold-out data: 0.14351852238178253
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3980880931571678
Accuracy on hold-out set: 0.05188679245283019
MAPK value on hold-out data: 0.14351852238178253
Returned to Spot: Validation loss: 2.3980880931571678
----------------------------------------------

config: {'_L0': 6112, 'l1': 256, 'dropout_prob': 0.6368989501775649, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'Adamax', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3985713922752523
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.16981133818626404
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3985618285413057
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.1800314486026764
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3986199127053314
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.17531448602676392
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39854777534053
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.1808176189661026
Returned to Spot: Validation loss: 2.39854777534053
----------------------------------------------

config: {'_L0': 6112, 'l1': 512, 'dropout_prob': 0.06795318590380832, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 8, 'optimizer': 'Adamax', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3978671217864416
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.18317610025405884
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397839073864919
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17610064148902893
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397796297973057
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.18160377442836761
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397783207443525
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.1871069073677063
Returned to Spot: Validation loss: 2.397783207443525
----------------------------------------------

config: {'_L0': 6112, 'l1': 128, 'dropout_prob': 0.456533346732735, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3989526640694097
Accuracy on hold-out set: 0.07075471698113207
MAPK value on hold-out data: 0.1391509622335434
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.398837669840399
Accuracy on hold-out set: 0.05660377358490566
MAPK value on hold-out data: 0.1320754885673523
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3989325154502437
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.14150945842266083
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3988740894029723
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.15094342827796936
Returned to Spot: Validation loss: 2.3988740894029723
----------------------------------------------

config: {'_L0': 6112, 'l1': 2048, 'dropout_prob': 0.435068640608333, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3984142850946495
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.125
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3983853658040366
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.1180555671453476
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3983127894224943
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.125
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3982978132036
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.12191358208656311
Returned to Spot: Validation loss: 2.3982978132036
----------------------------------------------

config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.3175980093998585, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973114805401496
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.20833329856395721
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396766887520844
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.2146226465702057
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39617502014592
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.21147796511650085
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950315736374765
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.21698111295700073
Returned to Spot: Validation loss: 2.3950315736374765
----------------------------------------------

config: {'_L0': 6112, 'l1': 128, 'dropout_prob': 0.10217787740156026, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 4, 'optimizer': 'Adam', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.399325688680013
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.14351852238178253
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3993267748090954
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.1388888955116272
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3992787996927896
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.1419753134250641
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39928016839204
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.1419752985239029
Returned to Spot: Validation loss: 2.39928016839204
----------------------------------------------

config: {'_L0': 6112, 'l1': 4096, 'dropout_prob': 0.5582660802134882, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 8, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3980693728835494
Accuracy on hold-out set: 0.05188679245283019
MAPK value on hold-out data: 0.1080247014760971
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.398130081318043
Accuracy on hold-out set: 0.06132075471698113
MAPK value on hold-out data: 0.10648149996995926
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397997767836959
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.11419753730297089
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397959682676527
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.11651235073804855
Returned to Spot: Validation loss: 2.397959682676527
----------------------------------------------

config: {'_L0': 6112, 'l1': 4096, 'dropout_prob': 0.8475085430864048, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 4, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397449090795697
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.16273587942123413
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975592289330825
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.16116352379322052
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397425554833322
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.1595912128686905
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975984870262868
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.15723273158073425
Returned to Spot: Validation loss: 2.3975984870262868
----------------------------------------------

config: {'_L0': 6112, 'l1': 64, 'dropout_prob': 0.8086972970888939, 'lr_mult': 0.001, 'batch_size': 16, 'epochs': 4, 'k_folds': 1, 'patience': 64, 'optimizer': 'Adam', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.4004036017826627
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.1517857164144516
Epoch: 2
Loss on hold-out set: 2.400071450642177
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.1607142984867096
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.4000504868371144
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.1517857164144516
Epoch: 4
Loss on hold-out set: 2.3999014922550748
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.1629464328289032
Returned to Spot: Validation loss: 2.3999014922550748
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.7894801479330897, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 4, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973938429130697
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.20440252125263214
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972465587112137
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.21776728332042694
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396949327216958
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.2083333432674408
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396790068104582
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.21226416528224945
Returned to Spot: Validation loss: 2.396790068104582
----------------------------------------------
spotPython tuning: 2.3950315736374765 [----------] 0.35% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.6710735654782591, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 64, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397988904197261
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.15723271667957306
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397735838620168
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.1603773534297943
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971929685124813
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2083333283662796
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397037407137313
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.20518867671489716
Returned to Spot: Validation loss: 2.397037407137313
----------------------------------------------
spotPython tuning: 2.3950315736374765 [----------] 0.67% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.7900113652555035, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397920043380172
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.1705246865749359
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397611459096273
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.19212962687015533
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973968823750815
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.21759259700775146
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971683625821716
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.20061728358268738
Returned to Spot: Validation loss: 2.3971683625821716
----------------------------------------------
spotPython tuning: 2.3950315736374765 [----------] 0.84% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.19277948377079854, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397103451332956
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.23899370431900024
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957948504753834
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.23191824555397034
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.393412916165478
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.23349057137966156
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.389379121222586
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.2830188572406769
Returned to Spot: Validation loss: 2.389379121222586
----------------------------------------------
spotPython tuning: 2.389379121222586 [----------] 1.47% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 512, 'dropout_prob': 0.060808660903882934, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3979099314167813
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.18474839627742767
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3978598567674743
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.1941823661327362
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3977224871797382
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.18946537375450134
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975800613187395
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.19732701778411865
Returned to Spot: Validation loss: 2.3975800613187395
----------------------------------------------
spotPython tuning: 2.389379121222586 [----------] 1.63% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.18213606561155593, 'lr_mult': 0.001, 'batch_size': 8, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975447901973017
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.18672840297222137
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397189661308571
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2013888955116272
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396685662092986
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.21759258210659027
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960089683532715
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.1975308656692505
Returned to Spot: Validation loss: 2.3960089683532715
----------------------------------------------
spotPython tuning: 2.389379121222586 [----------] 1.81% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.13233200256075756, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 4, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397072139775978
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.23427671194076538
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959165406676957
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.24528303742408752
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.393714340227955
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2979559302330017
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.389391946342756
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.3238993287086487
Returned to Spot: Validation loss: 2.389391946342756
----------------------------------------------
spotPython tuning: 2.389379121222586 [----------] 2.44% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 4096, 'dropout_prob': 0.09292259924694028, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975301733556784
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2279873937368393
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396934601495851
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.22720122337341309
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958640638387427
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.24056600034236908
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3942570416432507
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.24606913328170776
Returned to Spot: Validation loss: 2.3942570416432507
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.389379121222586 [----------] 2.76% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.13895086663047265, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396697264797283
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2767294645309448
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951494851202333
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.3026728332042694
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3924217246613413
Accuracy on hold-out set: 0.2169811320754717
MAPK value on hold-out data: 0.33726415038108826
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.387000063680253
Accuracy on hold-out set: 0.23113207547169812
MAPK value on hold-out data: 0.3411949574947357
Returned to Spot: Validation loss: 2.387000063680253
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.387000063680253 [----------] 3.43% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.06439896599751695, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397111616044674
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.17924530804157257
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395652339143573
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.16902513802051544
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3936799044878976
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.1674528270959854
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3912858040827625
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.20204398036003113
Returned to Spot: Validation loss: 2.3912858040827625
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.387000063680253 [----------] 4.11% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.15546640677818002, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397697334019643
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.15251575410366058
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397228958471766
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.16509436070919037
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966626513679072
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.16981133818626404
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395865264928566
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.19575472176074982
Returned to Spot: Validation loss: 2.395865264928566
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.387000063680253 [----------] 4.77% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.14615400105486473, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969592485787734
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.28616344928741455
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395423065941289
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.30031436681747437
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.392437844906213
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.31367915868759155
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3862778510687486
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.3262578248977661
Returned to Spot: Validation loss: 2.3862778510687486
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3862778510687486 [#---------] 5.48% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.12528681110846807, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397440051132778
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.21855342388153076
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396888939839489
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.22562891244888306
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3961525503194556
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.22405655682086945
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951557852187246
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.2067609578371048
Returned to Spot: Validation loss: 2.3951557852187246
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3862778510687486 [#---------] 6.15% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.10807358039768722, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975375215962247
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.20361635088920593
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3970631585930877
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.18867924809455872
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3964440305277988
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1933962106704712
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3954852054703912
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.19968552887439728
Returned to Spot: Validation loss: 2.3954852054703912
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3862778510687486 [#---------] 6.79% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.11815002692942611, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397423615995443
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.18238994479179382
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396933614083056
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.18867924809455872
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963320075340993
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19025160372257233
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395507706786102
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19654090702533722
Returned to Spot: Validation loss: 2.395507706786102
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3862778510687486 [#---------] 7.43% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.13620340138857875, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3977840171670013
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.18632075190544128
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975013539476215
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.21305032074451447
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971912905855
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.2012578845024109
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967186100078077
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.1878930777311325
Returned to Spot: Validation loss: 2.3967186100078077
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3862778510687486 [#---------] 8.05% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.16050204287317724, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 32, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396700586912767
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2987420856952667
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948713361092335
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.3105345368385315
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3916190795178682
Accuracy on hold-out set: 0.20754716981132076
MAPK value on hold-out data: 0.28066033124923706
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3856273349725976
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.26493707299232483
Returned to Spot: Validation loss: 2.3856273349725976
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 8.69% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09110021574244813, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975045636015118
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.21855342388153076
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968885439746783
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.2539307773113251
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3961802091238633
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.27358484268188477
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39500677810525
Accuracy on hold-out set: 0.22169811320754718
MAPK value on hold-out data: 0.2948112487792969
Returned to Spot: Validation loss: 2.39500677810525
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 9.35% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.06890213159939086, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972784415730892
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.19654089212417603
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966817788358004
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.20990565419197083
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958914257445425
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.23034588992595673
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948483287163502
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2421383410692215
Returned to Spot: Validation loss: 2.3948483287163502
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 9.97% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0558348539799957, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975754976272583
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.2012578845024109
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397182586058131
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.19811323285102844
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396720787264266
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.20990565419197083
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960996416379823
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.21698111295700073
Returned to Spot: Validation loss: 2.3960996416379823
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 10.59% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08981734748370006, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39781036017076
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.19889935851097107
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974060517437055
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2342766970396042
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396831879075968
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23034587502479553
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396133634279359
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.23034587502479553
Returned to Spot: Validation loss: 2.396133634279359
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 11.20% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09158000659876485, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397331566180823
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.22012579441070557
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396729480545476
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.29402512311935425
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396060325064749
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.30738985538482666
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951294557103573
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.33569180965423584
Returned to Spot: Validation loss: 2.3951294557103573
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 11.80% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09106644899566055, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397423213382937
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.21305032074451447
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968667691608645
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.2853773236274719
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396169864906455
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.28616344928741455
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950917450886853
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2759433686733246
Returned to Spot: Validation loss: 2.3950917450886853
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 12.42% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09067301764229323, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974063081561394
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.21226412057876587
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39685365164055
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.21933957934379578
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39617608628183
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.22955970466136932
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3952333724723673
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.23191815614700317
Returned to Spot: Validation loss: 2.3952333724723673
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 13.03% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09080312243722831, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975971352379277
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.1808176040649414
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397065315606459
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.1745283007621765
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396321175233373
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.16509436070919037
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395322822174936
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.16823899745941162
Returned to Spot: Validation loss: 2.395322822174936
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 13.65% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.09061979097208507, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973867690788127
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.19575472176074982
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968471018773205
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2138364613056183
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396116738049489
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.24135218560695648
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951165496178395
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2775156497955322
Returned to Spot: Validation loss: 2.3951165496178395
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 14.27% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0900256156089932, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974888527168416
Accuracy on hold-out set: 0.07075471698113207
MAPK value on hold-out data: 0.1855345517396927
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967920136901566
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.2499999850988388
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959404320087074
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.27830183506011963
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948177998920657
Accuracy on hold-out set: 0.23113207547169812
MAPK value on hold-out data: 0.32154083251953125
Returned to Spot: Validation loss: 2.3948177998920657
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#---------] 14.88% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08966950794635833, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397404504272173
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.23191823065280914
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968356285455092
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.24764148890972137
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396087702715172
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2696540653705597
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395176259976513
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2649371027946472
Returned to Spot: Validation loss: 2.395176259976513
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 15.53% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08947136090983329, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397610603638415
Accuracy on hold-out set: 0.06132075471698113
MAPK value on hold-out data: 0.16902516782283783
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397065952139081
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.20204399526119232
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396347702674146
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.22484275698661804
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395444728293509
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24449683725833893
Returned to Spot: Validation loss: 2.395444728293509
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 16.15% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08951425740140692, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397337070051229
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.20990562438964844
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967167701361314
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.23191818594932556
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395952915245632
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.24371063709259033
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394885650220907
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.26650938391685486
Returned to Spot: Validation loss: 2.394885650220907
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 16.83% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08918532795211898, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397609881634982
Accuracy on hold-out set: 0.08018867924528301
MAPK value on hold-out data: 0.15172958374023438
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3970171033211476
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.1871069222688675
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963475227355957
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.21069180965423584
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3953429033171454
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.220911905169487
Returned to Spot: Validation loss: 2.3953429033171454
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 17.48% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08914245414635565, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3979003676828348
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.1470126062631607
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972894425662057
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.16509436070919037
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965474277172447
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.18867923319339752
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955322683982128
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.21226415038108826
Returned to Spot: Validation loss: 2.3955322683982128
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 18.12% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08930719413841784, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397019532491576
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.31682389974594116
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396302250196349
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.3270440399646759
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395412321360606
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.331760972738266
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394127121511495
Accuracy on hold-out set: 0.2169811320754717
MAPK value on hold-out data: 0.3333333134651184
Returned to Spot: Validation loss: 2.394127121511495
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 18.74% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08943314475336468, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397651933274179
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.23270440101623535
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971106713672854
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.30974841117858887
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39641627500642
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.3176099956035614
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3954921983323008
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.3396226465702057
Returned to Spot: Validation loss: 2.3954921983323008
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 19.38% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08952288757366074, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397435449204355
Accuracy on hold-out set: 0.07075471698113207
MAPK value on hold-out data: 0.16430819034576416
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396874209619918
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.1878930926322937
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960121307732924
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19261004030704498
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394875449954339
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.22012579441070557
Returned to Spot: Validation loss: 2.394875449954339
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 20.02% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08902987242915406, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397615945564126
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.16823898255825043
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397011601699973
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.21698111295700073
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396247539880141
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.26100626587867737
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39516078526119
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.29481130838394165
Returned to Spot: Validation loss: 2.39516078526119
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 20.66% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08919205339692007, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974263668060303
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.209119513630867
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969092661479734
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.23034590482711792
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3962003554937974
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2499999850988388
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951582458783998
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.24764153361320496
Returned to Spot: Validation loss: 2.3951582458783998
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 21.29% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08906708253084379, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3978287656352206
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.15251575410366058
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397273643961493
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.17688675224781036
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965619487582512
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.22012577950954437
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395521105460401
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.21698112785816193
Returned to Spot: Validation loss: 2.395521105460401
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 21.93% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08894338233306005, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397323473444525
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.2830188274383545
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396685735234674
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.2767295241355896
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395880031135847
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2539307475090027
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394791398408278
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2602200508117676
Returned to Spot: Validation loss: 2.394791398408278
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 22.57% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0889417906352505, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397804710100282
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.1391509622335434
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397265852622266
Accuracy on hold-out set: 0.07075471698113207
MAPK value on hold-out data: 0.14150944352149963
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966349543265575
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.15566039085388184
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395777018565052
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.16509434580802917
Returned to Spot: Validation loss: 2.395777018565052
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 23.21% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0893562336937487, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975971352379277
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.15880505740642548
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971161549946047
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1611635386943817
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396414594830207
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1816037893295288
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395422982719709
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.20361630618572235
Returned to Spot: Validation loss: 2.395422982719709
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 23.85% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0891041557766644, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397318232734248
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.23899370431900024
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967746473708242
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.21305032074451447
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396063509977089
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.1949685513973236
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950331885859653
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2004716992378235
Returned to Spot: Validation loss: 2.3950331885859653
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##--------] 24.58% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08901562940576731, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974039037272616
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.2893081307411194
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396766664846888
Accuracy on hold-out set: 0.2169811320754717
MAPK value on hold-out data: 0.3034590482711792
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395917253674201
Accuracy on hold-out set: 0.2169811320754717
MAPK value on hold-out data: 0.32232701778411865
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394782799594807
Accuracy on hold-out set: 0.2358490566037736
MAPK value on hold-out data: 0.30660372972488403
Returned to Spot: Validation loss: 2.394782799594807
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 25.29% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08871914437891885, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974993768728003
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2004716694355011
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968968818772516
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.23191826045513153
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396146942984383
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.23270440101623535
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950949592410393
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.250786155462265
Returned to Spot: Validation loss: 2.3950949592410393
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 25.92% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08882856874816587, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971499969374457
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2704402208328247
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3964717005783656
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.29952821135520935
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3956415383320935
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.29402509331703186
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394447328909388
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.2979559302330017
Returned to Spot: Validation loss: 2.394447328909388
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 26.55% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0886041722170289, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975442355533816
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17059749364852905
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971265689382015
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17767293751239777
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965011925067543
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.16823899745941162
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957312399486326
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.16194969415664673
Returned to Spot: Validation loss: 2.3957312399486326
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 27.18% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0889899335647692, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973029784436495
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2075471580028534
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396698256708541
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2075471580028534
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395893591754841
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.21855343878269196
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39480863202293
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2358490228652954
Returned to Spot: Validation loss: 2.39480863202293
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 27.83% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08880775574169078, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974315737778285
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2083333432674408
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968047173518054
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.26650938391685486
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395832565595519
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.2720125615596771
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394766371205168
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2696540355682373
Returned to Spot: Validation loss: 2.394766371205168
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 28.46% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08859848489585893, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397242991429455
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.2295597344636917
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396629607902383
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.21776728332042694
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395867446683488
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.21226415038108826
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3947508312621206
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.22562894225120544
Returned to Spot: Validation loss: 2.3947508312621206
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 29.12% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08810362894344526, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39743314374168
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19811318814754486
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396861006628792
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.22012577950954437
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396034706313655
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.23191821575164795
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948447231976493
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.2287735641002655
Returned to Spot: Validation loss: 2.3948447231976493
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 29.75% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08783621163952181, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973595961084904
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.19025154411792755
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966763986731476
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.22405657172203064
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957654597624294
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2908804416656494
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394543026978115
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.3238993287086487
Returned to Spot: Validation loss: 2.394543026978115
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 30.39% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08768512497986942, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39740762620602
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2216981202363968
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969696152885005
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2342766970396042
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963293804312653
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.23270437121391296
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395515059525112
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.23899365961551666
Returned to Spot: Validation loss: 2.395515059525112
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 31.02% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08774460334025179, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972662687301636
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24056601524353027
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396669884897628
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.29245278239250183
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959843999934645
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.3223269581794739
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950051811506166
Accuracy on hold-out set: 0.21226415094339623
MAPK value on hold-out data: 0.32311317324638367
Returned to Spot: Validation loss: 2.3950051811506166
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 31.66% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08757158189647335, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397391775868974
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2138364315032959
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968084533259555
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2633647620677948
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396045390165077
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.26650938391685486
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394986885898518
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2625785768032074
Returned to Spot: Validation loss: 2.394986885898518
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 32.36% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 4096, 'dropout_prob': 0.14469425596769764, 'lr_mult': 0.001, 'batch_size': 4, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'NAdam', 'sgd_momentum': 0.9}
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397575077020897
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2555031180381775
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972968470375493
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.24606911838054657
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396989102633494
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.25864776968955994
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965118516166255
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.27201253175735474
Returned to Spot: Validation loss: 2.3965118516166255
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 32.62% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08738011261671509, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974588547112807
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.19732703268527985
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969167448439688
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2279873937368393
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396156038878099
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2499999850988388
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950668168517777
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.26022011041641235
Returned to Spot: Validation loss: 2.3950668168517777
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 33.35% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08724987453827782, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397341528028812
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2413521707057953
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39674363946015
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2680816948413849
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395970063389472
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2696540653705597
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948776564508116
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2751571834087372
Returned to Spot: Validation loss: 2.3948776564508116
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 34.10% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08740137645393235, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397308459821737
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.22877353429794312
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396661007179404
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2413521707057953
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395857768238715
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2492138296365738
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3947137481761427
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2633647322654724
Returned to Spot: Validation loss: 2.3947137481761427
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [###-------] 34.86% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08705157856564086, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397358480489479
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2617924213409424
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396820273039476
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.25943395495414734
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396119479863149
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.23270441591739655
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395125314874469
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2358490377664566
Returned to Spot: Validation loss: 2.395125314874469
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 35.64% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08655254781576151, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397447426364107
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17059749364852905
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396839384762746
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19025154411792755
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960533569443903
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.20204398036003113
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394933893995465
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.19889934360980988
Returned to Spot: Validation loss: 2.394933893995465
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 36.44% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08629329627362926, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397417183192271
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.19811320304870605
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39684902946904
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.2130502611398697
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960598752183735
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.2279874086380005
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950974154022506
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.23742134869098663
Returned to Spot: Validation loss: 2.3950974154022506
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 37.22% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.086616292406231, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972231801950707
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.2499999850988388
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396780682059954
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.23899370431900024
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396157494131124
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.24606919288635254
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395236127781418
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2806603014469147
Returned to Spot: Validation loss: 2.395236127781418
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 37.96% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08629622012497637, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975964379760453
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.19339624047279358
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397119108236061
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19339624047279358
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396525610168025
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2012578696012497
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395726014982979
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19732703268527985
Returned to Spot: Validation loss: 2.395726014982979
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 38.90% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08755482938392858, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3976448077075885
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19339622557163239
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971637262488312
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.20518866181373596
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965664607173993
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.21698111295700073
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39570292886698
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.21540877223014832
Returned to Spot: Validation loss: 2.39570292886698
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 39.88% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08760988179144982, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972128674669086
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.18317611515522003
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967550205734542
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.20204399526119232
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3961834030331306
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.21698111295700073
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3953154919282444
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.21855342388153076
Returned to Spot: Validation loss: 2.3953154919282444
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 40.92% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08807388522222931, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397221122147902
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.23742136359214783
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966071155836
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.25943395495414734
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957608780770934
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.2822326719760895
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3944713866935587
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.32389935851097107
Returned to Spot: Validation loss: 2.3944713866935587
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 41.84% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08749917604481748, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39747173831148
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.22091194987297058
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396832715790227
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2672955393791199
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960577114573063
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2822326123714447
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394935135571462
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.30503135919570923
Returned to Spot: Validation loss: 2.394935135571462
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 42.68% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08733018156482725, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397481432500875
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1745283156633377
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968537303636657
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.21619494259357452
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3961375974259287
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.23034587502479553
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951101460546815
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.23427674174308777
Returned to Spot: Validation loss: 2.3951101460546815
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 43.55% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08766157550448957, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973046406260075
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.20361635088920593
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967517187010565
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2578616142272949
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395987533173471
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.2720125615596771
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3949501536927134
Accuracy on hold-out set: 0.20754716981132076
MAPK value on hold-out data: 0.28852197527885437
Returned to Spot: Validation loss: 2.3949501536927134
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [####------] 44.40% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08711861053375036, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397205834118825
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.22641508281230927
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965125218877255
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.27122634649276733
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957258777798347
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2908804416656494
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394466026773993
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2995282709598541
Returned to Spot: Validation loss: 2.394466026773993
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 45.25% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08713801670926113, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973569015287004
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2845911383628845
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3968567488328465
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.3238993287086487
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960934967364906
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.316823810338974
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950595270912602
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.31603771448135376
Returned to Spot: Validation loss: 2.3950595270912602
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 46.23% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08703910795297276, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974783263116515
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.19732706248760223
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396938278989972
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.20361635088920593
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3961974337415874
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2004716992378235
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395132361717944
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2004716992378235
Returned to Spot: Validation loss: 2.395132361717944
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 47.08% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08661773534835199, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397219219297733
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.2429244965314865
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966517043563553
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.25786155462265015
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958735016157044
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2806603014469147
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394813447628381
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.3223269581794739
Returned to Spot: Validation loss: 2.394813447628381
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 47.87% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08625100551470281, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975740198819144
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.18238990008831024
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396988621297872
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.19968551397323608
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963698171219736
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.21383649110794067
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395548975692605
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.22405660152435303
Returned to Spot: Validation loss: 2.395548975692605
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 48.68% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08682011391855202, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972422221921525
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.21226413547992706
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966372800323197
Accuracy on hold-out set: 0.09433962264150944
MAPK value on hold-out data: 0.20283019542694092
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958438095056787
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19811320304870605
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394684762324927
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.20597484707832336
Returned to Spot: Validation loss: 2.394684762324927
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 49.46% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08687531808521552, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397346606794393
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.1540880799293518
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967172469732896
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.1949685662984848
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958296078555987
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.19889935851097107
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394533933333631
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2154088169336319
Returned to Spot: Validation loss: 2.394533933333631
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 50.21% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0865237065661076, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397424333500412
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.22327041625976562
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969103705208257
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2476414442062378
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396162021834895
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.23270440101623535
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395147499048485
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.22484271228313446
Returned to Spot: Validation loss: 2.395147499048485
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 50.99% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08651475151527585, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972096195760764
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.2342766970396042
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966176779765003
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2641508877277374
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958487510681152
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2743709981441498
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3947930380983173
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.277515709400177
Returned to Spot: Validation loss: 2.3947930380983173
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 51.76% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0862377209763059, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397357331131989
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.2688679099082947
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396740690717157
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.278301864862442
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959791795262753
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.28694963455200195
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3949394810874507
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.31603771448135376
Returned to Spot: Validation loss: 2.3949394810874507
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 52.55% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08605461331440888, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973494633188785
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.24606911838054657
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967568042143337
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2838049829006195
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959540556061945
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2877357602119446
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3949013656040408
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2916666567325592
Returned to Spot: Validation loss: 2.3949013656040408
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 53.32% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08583883300946811, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971007972393394
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2484275847673416
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396569402712696
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.24685527384281158
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957810424408823
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.24056600034236908
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394623925101082
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2350628674030304
Returned to Spot: Validation loss: 2.394623925101082
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 54.12% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08540890318136236, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3976264922124035
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.15566042065620422
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397104004643998
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.23113206028938293
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963763826298266
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.2547169625759125
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395343524105144
Accuracy on hold-out set: 0.1650943396226415
MAPK value on hold-out data: 0.27908799052238464
Returned to Spot: Validation loss: 2.395343524105144
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#####-----] 54.88% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08570521283636486, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39737657555994
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.25314459204673767
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396861380001284
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.22641503810882568
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396214912522514
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.22955970466136932
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3952668252980933
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.2272011935710907
Returned to Spot: Validation loss: 2.3952668252980933
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 55.69% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08562238521110427, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973241999464214
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.2900943160057068
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967320491682806
Accuracy on hold-out set: 0.25
MAPK value on hold-out data: 0.32940244674682617
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395845851808224
Accuracy on hold-out set: 0.25943396226415094
MAPK value on hold-out data: 0.34984275698661804
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394704485839268
Accuracy on hold-out set: 0.25
MAPK value on hold-out data: 0.3459119200706482
Returned to Spot: Validation loss: 2.394704485839268
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 56.53% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08527451461298183, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973566743562804
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23349054157733917
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967878278696313
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2633647620677948
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959673778066097
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.27279868721961975
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394903389912731
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.2759433388710022
Returned to Spot: Validation loss: 2.394903389912731
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 57.40% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0852827902214395, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973495240481393
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.19654086232185364
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396852194138293
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.22327041625976562
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963172863114557
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2421383559703827
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955051943940937
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2759433686733246
Returned to Spot: Validation loss: 2.3955051943940937
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 58.25% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08577506224657731, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971692638577156
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.2696540355682373
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396521745987658
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.2499999850988388
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955104620951526
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.24842767417430878
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39415838133614
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.2358490377664566
Returned to Spot: Validation loss: 2.39415838133614
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 59.17% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08518889897278849, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397489711923419
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.18396228551864624
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969660637513646
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.19025155901908875
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396170868063873
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.18474844098091125
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950608878765465
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.18317611515522003
Returned to Spot: Validation loss: 2.3950608878765465
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 59.98% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08493582342137915, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973090581174166
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.2633647620677948
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966640166516573
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.31446540355682373
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395869925337018
Accuracy on hold-out set: 0.24056603773584906
MAPK value on hold-out data: 0.37264150381088257
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948119271476314
Accuracy on hold-out set: 0.2783018867924528
MAPK value on hold-out data: 0.3891509771347046
Returned to Spot: Validation loss: 2.3948119271476314
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 60.80% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08466731097810193, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397526608323151
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2350628674030304
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397066021865269
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.24606914818286896
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963744370442517
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.24764147400856018
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395404480538278
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.25786158442497253
Returned to Spot: Validation loss: 2.395404480538278
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 61.76% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0852750546665499, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972988331092977
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2012578696012497
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396726765722599
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.25235846638679504
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959612778897554
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.25314459204673767
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394933279955162
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.25314459204673767
Returned to Spot: Validation loss: 2.394933279955162
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 62.78% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08512333011673164, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397283286418555
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.20597484707832336
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966746127830363
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.22641505300998688
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958295426278746
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.23742131888866425
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39467606004679
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.24528297781944275
Returned to Spot: Validation loss: 2.39467606004679
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 63.78% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08458705900978986, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972373076204985
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1878930777311325
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966521092180937
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2075471132993698
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395895334909547
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19654084742069244
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394835724020904
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.2059747874736786
Returned to Spot: Validation loss: 2.394835724020904
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [######----] 64.79% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08449725255467057, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397298959066283
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23427671194076538
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966129928264976
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2680816948413849
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958344347072096
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.25157228112220764
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3946502186217398
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24449683725833893
Returned to Spot: Validation loss: 2.3946502186217398
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 65.82% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08407190071512578, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974624264915034
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.24528297781944275
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396987127807905
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.2704402208328247
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3962974863232307
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2838049829006195
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3951991931447445
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2830187976360321
Returned to Spot: Validation loss: 2.3951991931447445
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 66.89% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08425065306524619, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397372884570428
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.179245263338089
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396895278174922
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.21147790551185608
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396099677625692
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.22641503810882568
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950968800850636
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.23742134869098663
Returned to Spot: Validation loss: 2.3950968800850636
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 67.93% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08417670644923704, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973298747584506
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.22562892735004425
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967530120093867
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.28066036105155945
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396086524117668
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.30817607045173645
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395052765900234
Accuracy on hold-out set: 0.23113207547169812
MAPK value on hold-out data: 0.330974817276001
Returned to Spot: Validation loss: 2.395052765900234
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 69.16% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08417918420369369, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975374158823266
Accuracy on hold-out set: 0.0660377358490566
MAPK value on hold-out data: 0.2004716992378235
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3970119480816825
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2680817246437073
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963106533266463
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2916666567325592
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3953741271540805
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.29323896765708923
Returned to Spot: Validation loss: 2.3953741271540805
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 70.28% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0845377349943858, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397714432680382
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.19103772938251495
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971896756370112
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.22720122337341309
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965370250198075
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.262578547000885
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955917605813943
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.27122634649276733
Returned to Spot: Validation loss: 2.3955917605813943
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 71.38% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08509014754816153, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3974157459331007
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.19496853649616241
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396835927693349
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.24056604504585266
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395985571843273
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.24449683725833893
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948009216560506
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.25157231092453003
Returned to Spot: Validation loss: 2.3948009216560506
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 72.47% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0848849250296861, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397466832736753
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19732701778411865
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969073992855146
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2279873937368393
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3964097072493353
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.2578616142272949
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955487057847797
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.2916666865348816
Returned to Spot: Validation loss: 2.3955487057847797
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 73.46% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08532059973010218, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972725868225098
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2688678801059723
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967276181814805
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.25864776968955994
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960414877477683
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2712263762950897
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3949981860394747
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2751571834087372
Returned to Spot: Validation loss: 2.3949981860394747
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#######---] 74.46% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08526144770955008, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973321667257346
Accuracy on hold-out set: 0.1792452830188679
MAPK value on hold-out data: 0.2555031180381775
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396693580555466
Accuracy on hold-out set: 0.25
MAPK value on hold-out data: 0.32783010601997375
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39585742635547
Accuracy on hold-out set: 0.25471698113207547
MAPK value on hold-out data: 0.3404087424278259
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3947381703358777
Accuracy on hold-out set: 0.22641509433962265
MAPK value on hold-out data: 0.31603774428367615
Returned to Spot: Validation loss: 2.3947381703358777
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 75.49% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08516828670802574, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397509496167021
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.19103772938251495
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39689438972833
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2161949872970581
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960316855952426
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23349052667617798
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394927789580147
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2617924213409424
Returned to Spot: Validation loss: 2.394927789580147
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 76.53% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0850560161659006, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972964579204343
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2429244965314865
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396578941705092
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.28066033124923706
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395776741909531
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.30188673734664917
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394536999036681
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.31525149941444397
Returned to Spot: Validation loss: 2.394536999036681
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 77.56% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08458414256880957, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3969418372748033
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.23742134869098663
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963029429597675
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.24449679255485535
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3954126632438517
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2633647322654724
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3942096098414005
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.2751571834087372
Returned to Spot: Validation loss: 2.3942096098414005
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 78.67% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08405875829096576, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39732207892076
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2555031180381775
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967793167762035
Accuracy on hold-out set: 0.20754716981132076
MAPK value on hold-out data: 0.2971697449684143
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396090473768846
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.2814464867115021
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395099347492434
Accuracy on hold-out set: 0.18867924528301888
MAPK value on hold-out data: 0.29481127858161926
Returned to Spot: Validation loss: 2.395099347492434
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 79.87% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08411043508753036, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3978432371931255
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.1878930926322937
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973400412865407
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.22562891244888306
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396651067823734
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.25393080711364746
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395717092280118
Accuracy on hold-out set: 0.18396226415094338
MAPK value on hold-out data: 0.2633647620677948
Returned to Spot: Validation loss: 2.395717092280118
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 80.88% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08470316280473927, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397134043135733
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2492138147354126
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3964645277779058
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24764150381088257
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39551521247288
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2555030882358551
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3943110861868226
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.26650938391685486
Returned to Spot: Validation loss: 2.3943110861868226
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 81.88% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08418536718662416, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397230658891066
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.20833328366279602
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965917173421607
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.2130502611398697
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958050125050097
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.23427671194076538
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394626651170119
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2499999701976776
Returned to Spot: Validation loss: 2.394626651170119
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 82.90% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08382693056341214, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397262022180377
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.247641459107399
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965783344124847
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.25864776968955994
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3957088083591103
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.27201253175735474
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3945731082052553
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.2963835895061493
Returned to Spot: Validation loss: 2.3945731082052553
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 83.93% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.0833910780755122, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397332013777967
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.23349051177501678
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396812724617292
Accuracy on hold-out set: 0.10377358490566038
MAPK value on hold-out data: 0.23270435631275177
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960362290436366
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.22248424589633942
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3950805933970325
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23113204538822174
Returned to Spot: Validation loss: 2.3950805933970325
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [########--] 84.93% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08345058777432388, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39756281870716
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1745283007621765
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397103620025347
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17688679695129395
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3964695773034728
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.1603773534297943
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395535372338205
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.16194969415664673
Returned to Spot: Validation loss: 2.395535372338205
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 85.98% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08400857134540214, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3970993554817057
Accuracy on hold-out set: 0.1320754716981132
MAPK value on hold-out data: 0.22720122337341309
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963920710221776
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.23742137849330902
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395505372083412
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.2499999850988388
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3941670611219585
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.24764148890972137
Returned to Spot: Validation loss: 2.3941670611219585
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 87.02% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08330551441853172, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3975390465754383
Accuracy on hold-out set: 0.16981132075471697
MAPK value on hold-out data: 0.24528297781944275
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396999127459976
Accuracy on hold-out set: 0.2028301886792453
MAPK value on hold-out data: 0.2696540653705597
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396265097384183
Accuracy on hold-out set: 0.15566037735849056
MAPK value on hold-out data: 0.2547169327735901
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395242652803097
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24449685215950012
Returned to Spot: Validation loss: 2.395242652803097
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 88.02% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08354119867015605, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3976548280356065
Accuracy on hold-out set: 0.09905660377358491
MAPK value on hold-out data: 0.17138361930847168
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972388056089295
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.16116352379322052
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396736644349008
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17452828586101532
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3960609526004433
Accuracy on hold-out set: 0.08490566037735849
MAPK value on hold-out data: 0.17452827095985413
Returned to Spot: Validation loss: 2.3960609526004433
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 89.03% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08468095126331227, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3972297591983147
Accuracy on hold-out set: 0.08962264150943396
MAPK value on hold-out data: 0.2083333283662796
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965890452546894
Accuracy on hold-out set: 0.12735849056603774
MAPK value on hold-out data: 0.23742134869098663
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39575131884161
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.2830188572406769
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.394662713104824
Accuracy on hold-out set: 0.19811320754716982
MAPK value on hold-out data: 0.3333333432674408
Returned to Spot: Validation loss: 2.394662713104824
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 90.04% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08444136006437535, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397586869743635
Accuracy on hold-out set: 0.10849056603773585
MAPK value on hold-out data: 0.19732703268527985
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971934048634655
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24449680745601654
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3966010179159776
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.247641459107399
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395775999663011
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.2507861256599426
Returned to Spot: Validation loss: 2.395775999663011
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 91.18% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08523901409519642, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3971951120304613
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24528293311595917
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965999900170094
Accuracy on hold-out set: 0.13679245283018868
MAPK value on hold-out data: 0.24371066689491272
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39570540752051
Accuracy on hold-out set: 0.1509433962264151
MAPK value on hold-out data: 0.27358487248420715
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39459857175935
Accuracy on hold-out set: 0.17452830188679244
MAPK value on hold-out data: 0.30188676714897156
Returned to Spot: Validation loss: 2.39459857175935
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [#########-] 93.87% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08500096595715557, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3973239412847556
Accuracy on hold-out set: 0.07547169811320754
MAPK value on hold-out data: 0.2216980755329132
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396727055873511
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.24764147400856018
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959022827868193
Accuracy on hold-out set: 0.19339622641509435
MAPK value on hold-out data: 0.3050313889980316
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3948826092594073
Accuracy on hold-out set: 0.25
MAPK value on hold-out data: 0.348270446062088
Returned to Spot: Validation loss: 2.3948826092594073
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##########] 96.44% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.08488807676378791, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397420399593857
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.21462257206439972
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967786195143215
Accuracy on hold-out set: 0.14150943396226415
MAPK value on hold-out data: 0.24135218560695648
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959772654299467
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.2649371027946472
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3947303340120136
Accuracy on hold-out set: 0.16037735849056603
MAPK value on hold-out data: 0.27437102794647217
Returned to Spot: Validation loss: 2.3947303340120136
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##########] 98.67% </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
config: {'_L0': 6112, 'l1': 8192, 'dropout_prob': 0.084511910072702, 'lr_mult': 0.001, 'batch_size': 2, 'epochs': 4, 'k_folds': 1, 'patience': 16, 'optimizer': 'AdamW', 'sgd_momentum': 0.9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.397269105011562
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.20676100254058838
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3967335494059436
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.2138364315032959
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3959907788150714
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.20283016562461853
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3949102253284096
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.20283019542694092
Returned to Spot: Validation loss: 2.3949102253284096
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spotPython tuning: 2.3856273349725976 [##########] 100.00% Done...
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>&lt;spotPython.spot.spot.Spot at 0x2d7787220&gt;</code></pre>
</div>
</div>
</section>
<section id="sec-tensorboard-25" class="level2" data-number="22.6">
<h2 data-number="22.6" class="anchored" data-anchor-id="sec-tensorboard-25"><span class="header-section-number">22.6</span> Tensorboard</h2>
<p>The textual output shown in the console (or code cell) can be visualized with Tensorboard as described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-tensorboard-14"><span>Section&nbsp;14.13</span></a>.</p>
</section>
<section id="sec-results-25" class="level2" data-number="22.7">
<h2 data-number="22.7" class="anchored" data-anchor-id="sec-results-25"><span class="header-section-number">22.7</span> Results</h2>
<p>After the hyperparameter tuning run is finished, the results can be analyzed as described in <a href="14_spot_ray_hpt_torch_cifar10.html#sec-results-14"><span>Section&nbsp;14.14</span></a>.</p>
<div class="cell" data-fig-label="fig-progress-25" data-execution_count="26">
<div class="sourceCode cell-code" id="cb924"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb924-1"><a href="#cb924-1" aria-hidden="true" tabindex="-1"></a>spot_tuner.plot_progress(log_y<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb924-2"><a href="#cb924-2" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"./figures/"</span> <span class="op">+</span> experiment_name<span class="op">+</span><span class="st">"_progress.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-27-output-1.png" width="745" height="243" class="figure-img"></p>
<figcaption class="figure-caption">Progress plot. <em>Black</em> dots denote results from the initial design. <em>Red</em> dots illustrate the improvement found by the surrogate model based optimization.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-fig-label="tbl-results-25" data-execution_count="27">
<div class="sourceCode cell-code" id="cb925"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb925-1"><a href="#cb925-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.utils.eda <span class="im">import</span> gen_design_table</span>
<span id="cb925-2"><a href="#cb925-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gen_design_table(fun_control<span class="op">=</span>fun_control, spot<span class="op">=</span>spot_tuner))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>| name         | type   | default   |   lower |   upper |               tuned | transform             |   importance | stars   |
|--------------|--------|-----------|---------|---------|---------------------|-----------------------|--------------|---------|
| _L0          | int    | 64        |  6112.0 |  6112.0 |              6112.0 | None                  |         0.00 |         |
| l1           | int    | 8         |     6.0 |    13.0 |                13.0 | transform_power_2_int |        42.46 | *       |
| dropout_prob | float  | 0.01      |     0.0 |     0.9 | 0.16050204287317724 | None                  |        76.62 | **      |
| lr_mult      | float  | 1.0       |   0.001 |   0.001 |               0.001 | None                  |         0.00 |         |
| batch_size   | int    | 4         |     1.0 |     4.0 |                 1.0 | transform_power_2_int |       100.00 | ***     |
| epochs       | int    | 4         |     2.0 |     2.0 |                 2.0 | transform_power_2_int |         0.00 |         |
| k_folds      | int    | 1         |     1.0 |     1.0 |                 1.0 | None                  |         0.00 |         |
| patience     | int    | 2         |     2.0 |     6.0 |                 5.0 | transform_power_2_int |         0.38 | .       |
| optimizer    | factor | SGD       |     0.0 |     3.0 |                 3.0 | None                  |         0.58 | .       |
| sgd_momentum | float  | 0.0       |     0.9 |     0.9 |                 0.9 | None                  |         0.00 |         |</code></pre>
</div>
</div>
<div class="cell" data-fig-label="fig-importance-25" data-execution_count="28">
<div class="sourceCode cell-code" id="cb927"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb927-1"><a href="#cb927-1" aria-hidden="true" tabindex="-1"></a>spot_tuner.plot_importance(threshold<span class="op">=</span><span class="fl">0.025</span>,</span>
<span id="cb927-2"><a href="#cb927-2" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"./figures/"</span> <span class="op">+</span> experiment_name<span class="op">+</span><span class="st">"_importance.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-29-output-1.png" width="575" height="411" class="figure-img"></p>
<figcaption class="figure-caption">Variable importance plot, threshold 0.025.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-get-spot-results-25" class="level2" data-number="22.8">
<h2 data-number="22.8" class="anchored" data-anchor-id="sec-get-spot-results-25"><span class="header-section-number">22.8</span> Get the Tuned Architecture</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb928"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb928-1"><a href="#cb928-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.hyperparameters.values <span class="im">import</span> get_one_core_model_from_X</span>
<span id="cb928-2"><a href="#cb928-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> spot_tuner.to_all_dim(spot_tuner.min_X.reshape(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb928-3"><a href="#cb928-3" aria-hidden="true" tabindex="-1"></a>model_spot <span class="op">=</span> get_one_core_model_from_X(X, fun_control)</span>
<span id="cb928-4"><a href="#cb928-4" aria-hidden="true" tabindex="-1"></a>model_spot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>Net_vbdp(
  (fc1): Linear(in_features=6112, out_features=8192, bias=True)
  (fc2): Linear(in_features=8192, out_features=4096, bias=True)
  (fc3): Linear(in_features=4096, out_features=2048, bias=True)
  (fc4): Linear(in_features=2048, out_features=1024, bias=True)
  (fc5): Linear(in_features=1024, out_features=11, bias=True)
  (relu): ReLU()
  (softmax): Softmax(dim=1)
  (dropout1): Dropout(p=0.16050204287317724, inplace=False)
  (dropout2): Dropout(p=0.08025102143658862, inplace=False)
)</code></pre>
</div>
</div>
</section>
<section id="evaluation-of-the-tuned-architecture" class="level2" data-number="22.9">
<h2 data-number="22.9" class="anchored" data-anchor-id="evaluation-of-the-tuned-architecture"><span class="header-section-number">22.9</span> Evaluation of the Tuned Architecture</h2>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb930"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb930-1"><a href="#cb930-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.traintest <span class="im">import</span> (</span>
<span id="cb930-2"><a href="#cb930-2" aria-hidden="true" tabindex="-1"></a>    train_tuned,</span>
<span id="cb930-3"><a href="#cb930-3" aria-hidden="true" tabindex="-1"></a>    test_tuned,</span>
<span id="cb930-4"><a href="#cb930-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb930-5"><a href="#cb930-5" aria-hidden="true" tabindex="-1"></a>train_tuned(net<span class="op">=</span>model_spot, train_dataset<span class="op">=</span>train,</span>
<span id="cb930-6"><a href="#cb930-6" aria-hidden="true" tabindex="-1"></a>        loss_function<span class="op">=</span>fun_control[<span class="st">"loss_function"</span>],</span>
<span id="cb930-7"><a href="#cb930-7" aria-hidden="true" tabindex="-1"></a>        metric<span class="op">=</span>fun_control[<span class="st">"metric_torch"</span>],</span>
<span id="cb930-8"><a href="#cb930-8" aria-hidden="true" tabindex="-1"></a>        shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb930-9"><a href="#cb930-9" aria-hidden="true" tabindex="-1"></a>        device <span class="op">=</span> fun_control[<span class="st">"device"</span>],</span>
<span id="cb930-10"><a href="#cb930-10" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb930-11"><a href="#cb930-11" aria-hidden="true" tabindex="-1"></a>        task<span class="op">=</span>fun_control[<span class="st">"task"</span>],)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396878476412791
Accuracy on hold-out set: 0.14622641509433962
MAPK value on hold-out data: 0.3152514398097992
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955852153166286
Accuracy on hold-out set: 0.11320754716981132
MAPK value on hold-out data: 0.30738988518714905
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.393184853049944
Accuracy on hold-out set: 0.1179245283018868
MAPK value on hold-out data: 0.30031442642211914
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3897103768474652
Accuracy on hold-out set: 0.12264150943396226
MAPK value on hold-out data: 0.29481127858161926
Returned to Spot: Validation loss: 2.3897103768474652
----------------------------------------------</code></pre>
</div>
</div>
<p>If <code>path</code> is set to a filename, e.g., <code>path = "model_spot_trained.pt"</code>, the weights of the trained model will be loaded from this file.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb936"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb936-1"><a href="#cb936-1" aria-hidden="true" tabindex="-1"></a>test_tuned(net<span class="op">=</span>model_spot, test_dataset<span class="op">=</span>test,</span>
<span id="cb936-2"><a href="#cb936-2" aria-hidden="true" tabindex="-1"></a>            shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb936-3"><a href="#cb936-3" aria-hidden="true" tabindex="-1"></a>            loss_function<span class="op">=</span>fun_control[<span class="st">"loss_function"</span>],</span>
<span id="cb936-4"><a href="#cb936-4" aria-hidden="true" tabindex="-1"></a>            metric<span class="op">=</span>fun_control[<span class="st">"metric_torch"</span>],</span>
<span id="cb936-5"><a href="#cb936-5" aria-hidden="true" tabindex="-1"></a>            device <span class="op">=</span> fun_control[<span class="st">"device"</span>],</span>
<span id="cb936-6"><a href="#cb936-6" aria-hidden="true" tabindex="-1"></a>            task<span class="op">=</span>fun_control[<span class="st">"task"</span>],)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3832428535718595
Accuracy on hold-out set: 0.1694915254237288
MAPK value on hold-out data: 0.33707863092422485
Final evaluation: Validation loss: 2.3832428535718595
Final evaluation: Validation metric: 0.33707863092422485
----------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>(2.3832428535718595, nan, tensor(0.3371))</code></pre>
</div>
</div>
</section>
<section id="cross-validated-evaluations" class="level2" data-number="22.10">
<h2 data-number="22.10" class="anchored" data-anchor-id="cross-validated-evaluations"><span class="header-section-number">22.10</span> Cross-validated Evaluations</h2>
<ul>
<li>This is the evaluation that will be used in the comparison (evaluatecv has to be updated before, to get metric vlaues!):</li>
</ul>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb939"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb939-1"><a href="#cb939-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotPython.torch.traintest <span class="im">import</span> evaluate_cv</span>
<span id="cb939-2"><a href="#cb939-2" aria-hidden="true" tabindex="-1"></a><span class="co"># modify k-kolds:</span></span>
<span id="cb939-3"><a href="#cb939-3" aria-hidden="true" tabindex="-1"></a><span class="bu">setattr</span>(model_spot, <span class="st">"k_folds"</span>,  <span class="dv">10</span>)</span>
<span id="cb939-4"><a href="#cb939-4" aria-hidden="true" tabindex="-1"></a>df_eval, df_preds, df_metrics <span class="op">=</span> evaluate_cv(net<span class="op">=</span>model_spot,</span>
<span id="cb939-5"><a href="#cb939-5" aria-hidden="true" tabindex="-1"></a>    dataset<span class="op">=</span>fun_control[<span class="st">"data"</span>],</span>
<span id="cb939-6"><a href="#cb939-6" aria-hidden="true" tabindex="-1"></a>    loss_function<span class="op">=</span>fun_control[<span class="st">"loss_function"</span>],</span>
<span id="cb939-7"><a href="#cb939-7" aria-hidden="true" tabindex="-1"></a>    metric<span class="op">=</span>fun_control[<span class="st">"metric_torch"</span>],</span>
<span id="cb939-8"><a href="#cb939-8" aria-hidden="true" tabindex="-1"></a>    task<span class="op">=</span>fun_control[<span class="st">"task"</span>],</span>
<span id="cb939-9"><a href="#cb939-9" aria-hidden="true" tabindex="-1"></a>    writer<span class="op">=</span>fun_control[<span class="st">"writer"</span>],</span>
<span id="cb939-10"><a href="#cb939-10" aria-hidden="true" tabindex="-1"></a>    writerId<span class="op">=</span><span class="st">"model_spot_cv"</span>,</span>
<span id="cb939-11"><a href="#cb939-11" aria-hidden="true" tabindex="-1"></a>    device <span class="op">=</span> fun_control[<span class="st">"device"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fold: 1
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955075873268976
Accuracy on hold-out set: 0.11267605633802817
MAPK value on hold-out data: 0.1874999701976776
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3873102598720126
Accuracy on hold-out set: 0.15492957746478872
MAPK value on hold-out data: 0.2685185372829437
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.362060825030009
Accuracy on hold-out set: 0.28169014084507044
MAPK value on hold-out data: 0.3680555522441864
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.303971552186542
Accuracy on hold-out set: 0.29577464788732394
MAPK value on hold-out data: 0.409722238779068
Fold: 2
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395475685596466
Accuracy on hold-out set: 0.15492957746478872
MAPK value on hold-out data: 0.27314814925193787
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.39027167028851
Accuracy on hold-out set: 0.11267605633802817
MAPK value on hold-out data: 0.23842589557170868
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3813089198536344
Accuracy on hold-out set: 0.19718309859154928
MAPK value on hold-out data: 0.30324074625968933
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3633686039182873
Accuracy on hold-out set: 0.2112676056338028
MAPK value on hold-out data: 0.3379629850387573
Fold: 3
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3942687975035772
Accuracy on hold-out set: 0.16901408450704225
MAPK value on hold-out data: 0.33796295523643494
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3863540358013577
Accuracy on hold-out set: 0.16901408450704225
MAPK value on hold-out data: 0.34259259700775146
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3707502815458508
Accuracy on hold-out set: 0.2535211267605634
MAPK value on hold-out data: 0.39814817905426025
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3529324332873025
Accuracy on hold-out set: 0.2535211267605634
MAPK value on hold-out data: 0.3865741193294525
Fold: 4
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3955457078086004
Accuracy on hold-out set: 0.1267605633802817
MAPK value on hold-out data: 0.2523147761821747
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3909303545951843
Accuracy on hold-out set: 0.1267605633802817
MAPK value on hold-out data: 0.2222222089767456
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.382236295276218
Accuracy on hold-out set: 0.15492957746478872
MAPK value on hold-out data: 0.24074071645736694
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3735356993145413
Accuracy on hold-out set: 0.18309859154929578
MAPK value on hold-out data: 0.28935185074806213
Fold: 5
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3965154687563577
Accuracy on hold-out set: 0.14084507042253522
MAPK value on hold-out data: 0.21064813435077667
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3940890232721963
Accuracy on hold-out set: 0.1267605633802817
MAPK value on hold-out data: 0.17592591047286987
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.386454588837094
Accuracy on hold-out set: 0.19718309859154928
MAPK value on hold-out data: 0.2638888657093048
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3852467272016735
Accuracy on hold-out set: 0.1267605633802817
MAPK value on hold-out data: 0.2361111044883728
Fold: 6
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.396067632569207
Accuracy on hold-out set: 0.09859154929577464
MAPK value on hold-out data: 0.2083333134651184
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.391849464840359
Accuracy on hold-out set: 0.09859154929577464
MAPK value on hold-out data: 0.23148144781589508
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3869924081696405
Accuracy on hold-out set: 0.1267605633802817
MAPK value on hold-out data: 0.2847222089767456
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.371515002515581
Accuracy on hold-out set: 0.19718309859154928
MAPK value on hold-out data: 0.3333333134651184
Fold: 7
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395629253652361
Accuracy on hold-out set: 0.11267605633802817
MAPK value on hold-out data: 0.24537035822868347
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3895583748817444
Accuracy on hold-out set: 0.15492957746478872
MAPK value on hold-out data: 0.2430555522441864
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3755536013179355
Accuracy on hold-out set: 0.23943661971830985
MAPK value on hold-out data: 0.31712964177131653
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.358691652615865
Accuracy on hold-out set: 0.23943661971830985
MAPK value on hold-out data: 0.3240740895271301
Fold: 8
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3963683673313687
Accuracy on hold-out set: 0.07142857142857142
MAPK value on hold-out data: 0.18095238506793976
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3931380135672433
Accuracy on hold-out set: 0.07142857142857142
MAPK value on hold-out data: 0.18333332240581512
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.386047567640032
Accuracy on hold-out set: 0.1
MAPK value on hold-out data: 0.22857141494750977
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3698794841766357
Accuracy on hold-out set: 0.2571428571428571
MAPK value on hold-out data: 0.3619047999382019
Fold: 9
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.395477546964373
Accuracy on hold-out set: 0.12857142857142856
MAPK value on hold-out data: 0.20476190745830536
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3903437682560513
Accuracy on hold-out set: 0.12857142857142856
MAPK value on hold-out data: 0.20952381193637848
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3808996064322336
Accuracy on hold-out set: 0.18571428571428572
MAPK value on hold-out data: 0.2571428716182709
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3610705511910575
Accuracy on hold-out set: 0.22857142857142856
MAPK value on hold-out data: 0.33571428060531616
Fold: 10
Epoch: 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3958696024758477
Accuracy on hold-out set: 0.15714285714285714
MAPK value on hold-out data: 0.23571428656578064
Epoch: 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.390469121932983
Accuracy on hold-out set: 0.2
MAPK value on hold-out data: 0.2904762327671051
Epoch: 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3773350511278424
Accuracy on hold-out set: 0.21428571428571427
MAPK value on hold-out data: 0.32380950450897217
Epoch: 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss on hold-out set: 2.3638267857687816
Accuracy on hold-out set: 0.2
MAPK value on hold-out data: 0.3333333432674408</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb981"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb981-1"><a href="#cb981-1" aria-hidden="true" tabindex="-1"></a>metric_name <span class="op">=</span> <span class="bu">type</span>(fun_control[<span class="st">"metric_torch"</span>]).<span class="va">__name__</span></span>
<span id="cb981-2"><a href="#cb981-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"loss: </span><span class="sc">{</span>df_eval<span class="sc">}</span><span class="ss">, Cross-validated </span><span class="sc">{</span>metric_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>df_metrics<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>loss: 2.3604038492176267, Cross-validated MAPK: 0.33480820059776306</code></pre>
</div>
</div>
</section>
<section id="detailed-hyperparameter-plots" class="level2" data-number="22.11">
<h2 data-number="22.11" class="anchored" data-anchor-id="detailed-hyperparameter-plots"><span class="header-section-number">22.11</span> Detailed Hyperparameter Plots</h2>
<div class="cell" data-fig-label="fig-contour-25" data-execution_count="34">
<div class="sourceCode cell-code" id="cb983"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb983-1"><a href="#cb983-1" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"./figures/"</span> <span class="op">+</span> experiment_name</span>
<span id="cb983-2"><a href="#cb983-2" aria-hidden="true" tabindex="-1"></a>spot_tuner.plot_important_hyperparameter_contour(filename<span class="op">=</span>filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>l1:  42.45954046546032
dropout_prob:  76.62173243063258
batch_size:  99.99999999999999
patience:  0.3813373827124728
optimizer:  0.5848307013773063</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-2.png" width="725" height="281" class="figure-img"></p>
<figcaption class="figure-caption">Contour plots.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-3.png" width="725" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-4.png" width="712" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-5.png" width="725" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-6.png" width="725" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-7.png" width="712" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-8.png" width="725" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-9.png" width="716" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-10.png" width="725" height="281"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="25_spot_torch_vbdp_files/figure-html/cell-35-output-11.png" width="712" height="281"></p>
</div>
</div>
</section>
<section id="parallel-coordinates-plot" class="level2" data-number="22.12">
<h2 data-number="22.12" class="anchored" data-anchor-id="parallel-coordinates-plot"><span class="header-section-number">22.12</span> Parallel Coordinates Plot</h2>
<div class="cell" data-fig-label="fig-parallel-25" data-execution_count="35">
<div class="sourceCode cell-code" id="cb985"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb985-1"><a href="#cb985-1" aria-hidden="true" tabindex="-1"></a>spot_tuner.parallel_plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="cced6f8a-d6f0-4883-a60d-ad2a9c2dc261" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cced6f8a-d6f0-4883-a60d-ad2a9c2dc261")) {                    Plotly.newPlot(                        "cced6f8a-d6f0-4883-a60d-ad2a9c2dc261",                        [{"dimensions":[{"label":"l1","range":[6.0,13.0],"values":[10.0,8.0,9.0,7.0,11.0,13.0,7.0,12.0,12.0,6.0,13.0,13.0,13.0,13.0,9.0,13.0,13.0,12.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,12.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0]},{"label":"dropout_prob","range":[0.0558348539799957,0.8475085430864048],"values":[0.26515610830779995,0.6368989501775649,0.06795318590380832,0.456533346732735,0.435068640608333,0.3175980093998585,0.10217787740156026,0.5582660802134882,0.8475085430864048,0.8086972970888939,0.7894801479330897,0.6710735654782591,0.7900113652555035,0.19277948377079854,0.060808660903882934,0.18213606561155593,0.13233200256075756,0.09292259924694028,0.13895086663047265,0.06439896599751695,0.15546640677818002,0.14615400105486473,0.12528681110846807,0.10807358039768722,0.11815002692942611,0.13620340138857875,0.16050204287317724,0.09110021574244813,0.06890213159939086,0.0558348539799957,0.08981734748370006,0.09158000659876485,0.09106644899566055,0.09067301764229323,0.09080312243722831,0.09061979097208507,0.0900256156089932,0.08966950794635833,0.08947136090983329,0.08951425740140692,0.08918532795211898,0.08914245414635565,0.08930719413841784,0.08943314475336468,0.08952288757366074,0.08902987242915406,0.08919205339692007,0.08906708253084379,0.08894338233306005,0.0889417906352505,0.0893562336937487,0.0891041557766644,0.08901562940576731,0.08871914437891885,0.08882856874816587,0.0886041722170289,0.0889899335647692,0.08880775574169078,0.08859848489585893,0.08810362894344526,0.08783621163952181,0.08768512497986942,0.08774460334025179,0.08757158189647335,0.14469425596769764,0.08738011261671509,0.08724987453827782,0.08740137645393235,0.08705157856564086,0.08655254781576151,0.08629329627362926,0.086616292406231,0.08629622012497637,0.08755482938392858,0.08760988179144982,0.08807388522222931,0.08749917604481748,0.08733018156482725,0.08766157550448957,0.08711861053375036,0.08713801670926113,0.08703910795297276,0.08661773534835199,0.08625100551470281,0.08682011391855202,0.08687531808521552,0.0865237065661076,0.08651475151527585,0.0862377209763059,0.08605461331440888,0.08583883300946811,0.08540890318136236,0.08570521283636486,0.08562238521110427,0.08527451461298183,0.0852827902214395,0.08577506224657731,0.08518889897278849,0.08493582342137915,0.08466731097810193,0.0852750546665499,0.08512333011673164,0.08458705900978986,0.08449725255467057,0.08407190071512578,0.08425065306524619,0.08417670644923704,0.08417918420369369,0.0845377349943858,0.08509014754816153,0.0848849250296861,0.08532059973010218,0.08526144770955008,0.08516828670802574,0.0850560161659006,0.08458414256880957,0.08405875829096576,0.08411043508753036,0.08470316280473927,0.08418536718662416,0.08382693056341214,0.0833910780755122,0.08345058777432388,0.08400857134540214,0.08330551441853172,0.08354119867015605,0.08468095126331227,0.08444136006437535,0.08523901409519642,0.08500096595715557,0.08488807676378791,0.084511910072702]},{"label":"batch_size","range":[1.0,4.0],"values":[3.0,2.0,2.0,2.0,3.0,2.0,3.0,3.0,1.0,4.0,2.0,2.0,3.0,1.0,1.0,3.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]},{"label":"patience","range":[2.0,6.0],"values":[5.0,5.0,3.0,4.0,5.0,4.0,2.0,3.0,2.0,6.0,2.0,6.0,4.0,4.0,5.0,4.0,2.0,5.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,5.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0]},{"label":"optimizer","range":[0.0,3.0],"values":[2.0,2.0,2.0,1.0,1.0,3.0,0.0,3.0,1.0,0.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,1.0,3.0,1.0,1.0,1.0,1.0,3.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]}],"line":{"cmax":2.3999014922550748,"cmin":2.3856273349725976,"color":[2.3980880931571678,2.39854777534053,2.397783207443525,2.3988740894029723,2.3982978132036,2.3950315736374765,2.39928016839204,2.397959682676527,2.3975984870262868,2.3999014922550748,2.396790068104582,2.397037407137313,2.3971683625821716,2.389379121222586,2.3975800613187395,2.3960089683532715,2.389391946342756,2.3942570416432507,2.387000063680253,2.3912858040827625,2.395865264928566,2.3862778510687486,2.3951557852187246,2.3954852054703912,2.395507706786102,2.3967186100078077,2.3856273349725976,2.39500677810525,2.3948483287163502,2.3960996416379823,2.396133634279359,2.3951294557103573,2.3950917450886853,2.3952333724723673,2.395322822174936,2.3951165496178395,2.3948177998920657,2.395176259976513,2.395444728293509,2.394885650220907,2.3953429033171454,2.3955322683982128,2.394127121511495,2.3954921983323008,2.394875449954339,2.39516078526119,2.3951582458783998,2.395521105460401,2.394791398408278,2.395777018565052,2.395422982719709,2.3950331885859653,2.394782799594807,2.3950949592410393,2.394447328909388,2.3957312399486326,2.39480863202293,2.394766371205168,2.3947508312621206,2.3948447231976493,2.394543026978115,2.395515059525112,2.3950051811506166,2.394986885898518,2.3965118516166255,2.3950668168517777,2.3948776564508116,2.3947137481761427,2.395125314874469,2.394933893995465,2.3950974154022506,2.395236127781418,2.395726014982979,2.39570292886698,2.3953154919282444,2.3944713866935587,2.394935135571462,2.3951101460546815,2.3949501536927134,2.394466026773993,2.3950595270912602,2.395132361717944,2.394813447628381,2.395548975692605,2.394684762324927,2.394533933333631,2.395147499048485,2.3947930380983173,2.3949394810874507,2.3949013656040408,2.394623925101082,2.395343524105144,2.3952668252980933,2.394704485839268,2.394903389912731,2.3955051943940937,2.39415838133614,2.3950608878765465,2.3948119271476314,2.395404480538278,2.394933279955162,2.39467606004679,2.394835724020904,2.3946502186217398,2.3951991931447445,2.3950968800850636,2.395052765900234,2.3953741271540805,2.3955917605813943,2.3948009216560506,2.3955487057847797,2.3949981860394747,2.3947381703358777,2.394927789580147,2.394536999036681,2.3942096098414005,2.395099347492434,2.395717092280118,2.3943110861868226,2.394626651170119,2.3945731082052553,2.3950805933970325,2.395535372338205,2.3941670611219585,2.395242652803097,2.3960609526004433,2.394662713104824,2.395775999663011,2.39459857175935,2.3948826092594073,2.3947303340120136,2.3949102253284096],"colorscale":[[0.0,"rgb(0,0,131)"],[0.2,"rgb(0,60,170)"],[0.4,"rgb(5,255,255)"],[0.6,"rgb(255,255,0)"],[0.8,"rgb(250,0,0)"],[1.0,"rgb(128,0,0)"]],"showscale":true},"type":"parcoords"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cced6f8a-d6f0-4883-a60d-ad2a9c2dc261');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Parallel coordinates plots</p>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb986"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb986-1"><a href="#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="co"># close tensorbaoard writer</span></span>
<span id="cb986-2"><a href="#cb986-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> fun_control[<span class="st">"writer"</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb986-3"><a href="#cb986-3" aria-hidden="true" tabindex="-1"></a>    fun_control[<span class="st">"writer"</span>].close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-all-combinations-of-hyperparameters" class="level2" data-number="22.13">
<h2 data-number="22.13" class="anchored" data-anchor-id="plot-all-combinations-of-hyperparameters"><span class="header-section-number">22.13</span> Plot all Combinations of Hyperparameters</h2>
<ul>
<li>Warning: this may take a while.</li>
</ul>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb987"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb987-1"><a href="#cb987-1" aria-hidden="true" tabindex="-1"></a>PLOT_ALL <span class="op">=</span> <span class="va">False</span></span>
<span id="cb987-2"><a href="#cb987-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> PLOT_ALL:</span>
<span id="cb987-3"><a href="#cb987-3" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> spot_tuner.k</span>
<span id="cb987-4"><a href="#cb987-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb987-5"><a href="#cb987-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb987-6"><a href="#cb987-6" aria-hidden="true" tabindex="-1"></a>            spot_tuner.plot_contour(i<span class="op">=</span>i, j<span class="op">=</span>j, min_z<span class="op">=</span>min_z, max_z <span class="op">=</span> max_z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./24_spot_torch_regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">HPT PyTorch: Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./99_spot_doc.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Documentation of the Sequential Parameter Optimization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>